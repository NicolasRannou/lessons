/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function h(a){throw a;}var n=void 0,p=!0,r=null,s=!1;function aa(){return function(){}}function ba(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var v,ca=this;function fa(){}
function ga(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ha(a){return a!==n}function x(a){return a!=r}function ka(a){return"array"==ga(a)}function la(a){var b=ga(a);return"array"==b||"object"==b&&"number"==typeof a.length}function y(a){return"string"==typeof a}function z(a){return"number"==typeof a}function ma(a){return"function"==ga(a)}function na(a){a=ga(a);return"object"==a||"array"==a||"function"==a}function pa(a){return a[qa]||(a[qa]=++ta)}
var qa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),ta=0;function ua(a,b,c){return a.call.apply(a.bind,arguments)}function va(a,b,c){a||h(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function wa(a,b,c){wa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ua:va;return wa.apply(r,arguments)}function Aa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var Ba=Date.now||function(){return+new Date};
function A(a,b){var c=a.split("."),d=ca;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ha(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function F(a,b){function c(){}c.prototype=b.prototype;a.g=b.prototype;a.prototype=new c};window["X.Counter"]=function(){var a=0;return{Xc:function(){a+=1},Mi:function(){a+=-1},value:function(){return a}}}();
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&h(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});A("Function.prototype.bind",Function.prototype.bind);function Ca(a){if(!Da.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ea,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Fa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ga,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ha,"&quot;"));return a}var Ea=/&/g,Fa=/</g,Ga=/>/g,Ha=/\"/g,Da=/[&<>\"]/;var Ia,Ja,Ka,La,Ma,Na,Oa;function Pa(){return ca.navigator?ca.navigator.userAgent:r}function Qa(){return ca.navigator}Ma=La=Ka=Ja=Ia=s;var Ra;if(Ra=Pa()){var Sa=Qa();Ia=0==Ra.indexOf("Opera");Ja=!Ia&&-1!=Ra.indexOf("MSIE");La=(Ka=!Ia&&-1!=Ra.indexOf("WebKit"))&&-1!=Ra.indexOf("Mobile");Ma=!Ia&&!Ka&&"Gecko"==Sa.product}var Ta=Ia,G=Ja,Ua=Ma,J=Ka,Ya=La,Za,$a=Qa();Za=$a&&$a.platform||"";Na=-1!=Za.indexOf("Mac");Oa=-1!=Za.indexOf("Win");var ab=!!Qa()&&-1!=(Qa().appVersion||"").indexOf("X11"),bb;
a:{var cb="",db;if(Ta&&ca.opera)var eb=ca.opera.version,cb="function"==typeof eb?eb():eb;else if(Ua?db=/rv\:([^\);]+)(\)|;)/:G?db=/MSIE\s+([^\);]+)(\)|;)/:J&&(db=/WebKit\/(\S+)/),db)var fb=db.exec(Pa()),cb=fb?fb[1]:"";if(G){var gb,hb=ca.document;gb=hb?hb.documentMode:n;if(gb>parseFloat(cb)){bb=""+gb;break a}}bb=cb}var ib={};
function jb(a){var b;if(!(b=ib[a])){b=0;for(var c=(""+bb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",i=d[f]||"",k=RegExp("(\\d*)(\\D*)","g"),o=RegExp("(\\d*)(\\D*)","g");do{var j=k.exec(g)||["","",""],m=o.exec(i)||["","",""];if(0==j[0].length&&0==m[0].length)break;b=((0==j[1].length?0:parseInt(j[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==j[1].length?0:parseInt(j[1],
10))>(0==m[1].length?0:parseInt(m[1],10))?1:0)||((0==j[2].length)<(0==m[2].length)?-1:(0==j[2].length)>(0==m[2].length)?1:0)||(j[2]<m[2]?-1:j[2]>m[2]?1:0)}while(0==b)}b=ib[a]=0<=b}return b}var mb={};function nb(a){return mb[a]||(mb[a]=G&&document.documentMode&&document.documentMode>=a)};function ob(a,b){for(var c in a)b.call(n,a[c],c,a)}function pb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function qb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var rb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function sb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<rb.length;f++)c=rb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var tb=Array.prototype,ub=tb.indexOf?function(a,b,c){return tb.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(y(a))return!y(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},vb=tb.forEach?function(a,b,c){tb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=y(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},wb=tb.map?function(a,b,c){return tb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=y(a)?
a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},xb=tb.some?function(a,b,c){return tb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=y(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return p;return s},yb=tb.every?function(a,b,c){return tb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=y(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return s;return p};function Bb(a,b){var c=ub(a,b);0<=c&&tb.splice.call(a,c,1)}
function Cb(a){return tb.concat.apply(tb,arguments)}function Db(a){if(ka(a))return Cb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Eb(a,b,c){return 2>=arguments.length?tb.slice.call(a,b):tb.slice.call(a,b,c)};function Fb(a){if("function"==typeof a.Z)a=a.Z();else if(la(a)||y(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Gb(a){if("function"==typeof a.pb)return a.pb();if(y(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return pb(a)}
function Hb(a,b){if("function"==typeof a.every)return a.every(b,n);if(la(a)||y(a))return yb(a,b,n);var c;if("function"==typeof a.cc)c=a.cc();else if("function"!=typeof a.pb)if(la(a)||y(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=qb(a);else c=n;for(var d=Gb(a),e=d.length,f=0;f<e;f++)if(!b.call(n,d[f],c&&c[f],a))return s;return p};var Ib="StopIteration"in ca?ca.StopIteration:Error("StopIteration");function Jb(){}Jb.prototype.next=function(){h(Ib)};Jb.prototype.Sb=function(){return this};function Kb(a){if(a instanceof Jb)return a;if("function"==typeof a.Sb)return a.Sb(s);if(la(a)){var b=0,c=new Jb;c.next=function(){for(;;){b>=a.length&&h(Ib);if(b in a)return a[b++];b++}};return c}h(Error("Not implemented"))}
function Lb(a,b){if(la(a))try{vb(a,b,n)}catch(c){c!==Ib&&h(c)}else{a=Kb(a);try{for(;;)b.call(n,a.next(),n,a)}catch(d){d!==Ib&&h(d)}}};function Mb(a,b){this.r={};this.p=[];var c=arguments.length;if(1<c){c%2&&h(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.yd(a)}v=Mb.prototype;v.w=0;v.wc=0;v.Z=t("w");v.pb=function(){Nb(this);for(var a=[],b=0;b<this.p.length;b++)a.push(this.r[this.p[b]]);return a};v.cc=function(){Nb(this);return this.p.concat()};v.Cd=function(a){for(var b=0;b<this.p.length;b++){var c=this.p[b];if(Ob(this.r,c)&&this.r[c]==a)return p}return s};
v.Zb=function(a,b){if(this===a)return p;if(this.w!=a.Z())return s;var c=b||Pb;Nb(this);for(var d,e=0;d=this.p[e];e++)if(!c(this.get(d),a.get(d)))return s;return p};function Pb(a,b){return a===b}v.clear=function(){this.r={};this.wc=this.w=this.p.length=0};v.remove=function(a){return Ob(this.r,a)?(delete this.r[a],this.w--,this.wc++,this.p.length>2*this.w&&Nb(this),p):s};
function Nb(a){if(a.w!=a.p.length){for(var b=0,c=0;b<a.p.length;){var d=a.p[b];Ob(a.r,d)&&(a.p[c++]=d);b++}a.p.length=c}if(a.w!=a.p.length){for(var e={},c=b=0;b<a.p.length;)d=a.p[b],Ob(e,d)||(a.p[c++]=d,e[d]=1),b++;a.p.length=c}}v.get=function(a,b){return Ob(this.r,a)?this.r[a]:b};v.set=function(a,b){Ob(this.r,a)||(this.w++,this.p.push(a),this.wc++);this.r[a]=b};v.yd=function(a){var b;a instanceof Mb?(b=a.cc(),a=a.pb()):(b=qb(a),a=pb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};v.d=function(){return new Mb(this)};
v.Sb=function(a){Nb(this);var b=0,c=this.p,d=this.r,e=this.wc,f=this,g=new Jb;g.next=function(){for(;;){e!=f.wc&&h(Error("The map has changed since the iterator was created"));b>=c.length&&h(Ib);var g=c[b++];return a?g:d[g]}};return g};function Ob(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Rb(a){this.r=new Mb;a&&this.yd(a)}function Sb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+pa(a):b.substr(0,1)+a}v=Rb.prototype;v.Z=function(){return this.r.Z()};v.add=function(a){this.r.set(Sb(a),a)};v.yd=function(a){for(var a=Gb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};v.hd=function(a){for(var a=Gb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};v.remove=function(a){return this.r.remove(Sb(a))};v.clear=function(){this.r.clear()};
v.contains=function(a){a=Sb(a);return Ob(this.r.r,a)};v.Ve=function(a){for(var b=new Rb,a=Gb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};v.pb=function(){return this.r.pb()};v.d=function(){return new Rb(this)};v.Zb=function(a){return this.Z()==Fb(a)&&Tb(this,a)};
function Tb(a,b){var c=Fb(b);if(a.Z()>c)return s;!(b instanceof Rb)&&5<c&&(b=new Rb(b));return Hb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Cd)a=b.Cd(a);else if(la(b)||y(b))a=0<=ub(b,a);else a:{for(var c in b)if(b[c]==a){a=p;break a}a=s}return a})}v.Sb=function(){return this.r.Sb(s)};function Ub(){}Ub.prototype.Ge=s;Ub.prototype.ma=function(){this.Ge||(this.Ge=p,this.z())};Ub.prototype.z=function(){this.fg&&Vb.apply(r,this.fg)};function Wb(a){a&&"function"==typeof a.ma&&a.ma()}function Vb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];la(d)?Vb.apply(r,d):Wb(d)}};function Xb(a,b){this.$e=b;this.bc=[];a>this.$e&&h(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.bc.push(this.Lc())}F(Xb,Ub);v=Xb.prototype;v.De=r;v.Fe=r;function Yb(a,b){a.bc.length<a.$e?a.bc.push(b):a.Fd(b)}v.Lc=function(){return this.De?this.De():{}};v.Fd=function(a){if(this.Fe)this.Fe(a);else if(na(a))if(ma(a.ma))a.ma();else for(var b in a)delete a[b]};v.z=function(){Xb.g.z.call(this);for(var a=this.bc;a.length;)this.Fd(a.pop());delete this.bc};function Zb(){this.$b=[];this.be=new Mb;this.Kf=this.Lf=this.Mf=this.Hf=0;this.uc=new Mb;this.Ae=this.Jf=0;this.Ud=1;this.Gd=new Xb(0,4E3);this.Gd.Lc=function(){return new $b};this.If=new Xb(0,50);this.If.Lc=function(){return new ac};var a=this;this.Ld=new Xb(0,2E3);this.Ld.Lc=function(){return""+a.Ud++};this.Ld.Fd=aa()}function ac(){this.qe=this.time=this.count=0}
ac.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.qe&&a.push(" [VarAlloc = ",this.qe,"]");return a.join("")};function $b(){}function bc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(cc(a.Ie-c));e.push(" ",dc(a.Ie-b));0==a.Hd?e.push(" Start        "):1==a.Hd?(e.push(" Done "),e.push(cc(a.Qi-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Wh&&e.push("[VarAlloc ",a.Wh,"] ");return e.join("")}
$b.prototype.toString=function(){return this.type==r?this.eg:"["+this.type+"] "+this.eg};Zb.prototype.reset=function(){for(var a=0;a<this.$b.length;a++){var b=this.Gd.id;b&&Yb(this.Ld,b);Yb(this.Gd,this.$b[a])}this.$b.length=0;this.be.clear();this.Hf=Ba();this.Ae=this.Jf=this.Kf=this.Lf=this.Mf=0;b=this.uc.cc();for(a=0;a<b.length;a++){var c=this.uc.get(b[a]);c.count=0;c.time=0;c.qe=0;Yb(this.If,c)}this.uc.clear()};
Zb.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.$b.length;d++){var e=this.$b[d];1==e.Hd&&c.pop();a.push(" ",bc(e,this.Hf,b,c.join("")));b=e.Ie;a.push("\n");0==e.Hd&&c.push("|  ")}if(0!=this.be.Z()){var f=Ba();a.push(" Unstopped timers:\n");Lb(this.be,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",dc(b.startTime),")\n")})}b=this.uc.cc();for(d=0;d<b.length;d++)c=this.uc.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Jf,"\n","Total comments created ",
this.Ae,"\n","Overhead start: ",this.Mf," ms\n","Overhead end: ",this.Lf," ms\n","Overhead comment: ",this.Kf," ms\n");return a.join("")};function cc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function dc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new Zb;function ec(){}var fc=0;v=ec.prototype;v.key=0;v.Nb=s;v.Ad=s;v.R=function(a,b,c,d,e,f){ma(a)?this.We=p:a&&a.handleEvent&&ma(a.handleEvent)?this.We=s:h(Error("Invalid listener argument"));this.ec=a;this.yf=b;this.src=c;this.type=d;this.capture=!!e;this.Jd=f;this.Ad=s;this.key=++fc;this.Nb=s};v.handleEvent=function(a){return this.We?this.ec.call(this.Jd||this.src,a):this.ec.handleEvent.call(this.ec,a)};!G||nb(9);var gc=!G||nb(9),hc=G&&!jb("8");!J||jb("528");Ua&&jb("1.9b")||G&&jb("8")||Ta&&jb("9.5")||J&&jb("528");!Ua||jb("8");function ic(a,b){this.type=a;this.currentTarget=this.target=b}F(ic,Ub);v=ic.prototype;v.z=function(){delete this.type;delete this.target;delete this.currentTarget};v.vb=s;v.pc=p;v.stopPropagation=function(){this.vb=p};v.preventDefault=function(){this.pc=s};function jc(a){jc[" "](a);return a}jc[" "]=fa;function kc(a,b){a&&this.R(a,b)}F(kc,ic);v=kc.prototype;v.target=r;v.relatedTarget=r;v.offsetX=0;v.offsetY=0;v.clientX=0;v.clientY=0;v.screenX=0;v.screenY=0;v.button=0;v.keyCode=0;v.charCode=0;v.ctrlKey=s;v.altKey=s;v.shiftKey=s;v.metaKey=s;v.ua=r;
v.R=function(a,b){var c=this.type=a.type;ic.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ua){var e;a:{try{jc(d.nodeName);e=p;break a}catch(f){}e=s}e||(d=r)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=J||a.offsetX!==n?a.offsetX:a.layerX;this.offsetY=J||a.offsetY!==n?a.offsetY:a.layerY;this.clientX=a.clientX!==n?a.clientX:a.pageX;this.clientY=a.clientY!==n?a.clientY:a.pageY;this.screenX=a.screenX||
0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.ua=a;delete this.pc;delete this.vb};v.stopPropagation=function(){kc.g.stopPropagation.call(this);this.ua.stopPropagation?this.ua.stopPropagation():this.ua.cancelBubble=p};
v.preventDefault=function(){kc.g.preventDefault.call(this);var a=this.ua;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,hc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};v.pg=t("ua");v.z=function(){kc.g.z.call(this);this.relatedTarget=this.currentTarget=this.target=this.ua=r};var lc={},mc={},nc={},oc={};
function K(a,b,c,d,e){if(b){if(ka(b)){for(var f=0;f<b.length;f++)K(a,b[f],c,d,e);return r}var d=!!d,g=mc;b in g||(g[b]={w:0,ga:0});g=g[b];d in g||(g[d]={w:0,ga:0},g.w++);var g=g[d],i=pa(a),k;g.ga++;if(g[i]){k=g[i];for(f=0;f<k.length;f++)if(g=k[f],g.ec==c&&g.Jd==e){if(g.Nb)break;return k[f].key}}else k=g[i]=[],g.w++;f=pc();f.src=a;g=new ec;g.R(c,f,a,b,d,e);c=g.key;f.key=c;k.push(g);lc[c]=g;nc[i]||(nc[i]=[]);nc[i].push(g);a.addEventListener?(a==ca||!a.Ee)&&a.addEventListener(b,f,d):a.attachEvent(b in
oc?oc[b]:oc[b]="on"+b,f);return c}h(Error("Invalid event type"))}function pc(){var a=qc,b=gc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function sc(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)sc(a,b[f],c,d,e);else a=K(a,b,c,d,e),lc[a].Ad=p}
function tc(a,b,c,d,e){if(ka(b))for(var f=0;f<b.length;f++)tc(a,b[f],c,d,e);else{d=!!d;a:{f=mc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=pa(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].ec==c&&a[f].capture==d&&a[f].Jd==e){uc(a[f].key);break}}}
function uc(a){if(!lc[a])return s;var b=lc[a];if(b.Nb)return s;var c=b.src,d=b.type,e=b.yf,f=b.capture;c.removeEventListener?(c==ca||!c.Ee)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in oc?oc[d]:oc[d]="on"+d,e);c=pa(c);e=mc[d][f][c];if(nc[c]){var g=nc[c];Bb(g,b);0==g.length&&delete nc[c]}b.Nb=p;e.jf=p;vc(d,f,c,e);delete lc[a];return p}
function vc(a,b,c,d){if(!d.ad&&d.jf){for(var e=0,f=0;e<d.length;e++)d[e].Nb?d[e].yf.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.jf=s;0==f&&(delete mc[a][b][c],mc[a][b].w--,0==mc[a][b].w&&(delete mc[a][b],mc[a].w--),0==mc[a].w&&delete mc[a])}}function wc(a){var b,c=0,d=b==r;b=!!b;if(a==r)ob(nc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)uc(f.key),c++}});else if(a=pa(a),nc[a])for(var a=nc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)uc(f.key),c++}}
function xc(a){var b=yc,a=pa(a),c=nc[a];if(c){var d=ha(b),e=ha(n);return d&&e?(c=mc[b],!!c&&!!c[n]&&a in c[n]):!d&&!e?p:xb(c,function(a){return d&&a.type==b||e&&a.capture==n})}return s}function zc(a,b,c,d,e){var f=1,b=pa(b);if(a[b]){a.ga--;a=a[b];a.ad?a.ad++:a.ad=1;try{for(var g=a.length,i=0;i<g;i++){var k=a[i];k&&!k.Nb&&(f&=Ac(k,e)!==s)}}finally{a.ad--,vc(c,d,b,a)}}return Boolean(f)}function Ac(a,b){var c=a.handleEvent(b);a.Ad&&uc(a.key);return c}
function qc(a,b){if(!lc[a])return p;var c=lc[a],d=c.type,e=mc;if(!(d in e))return p;var e=e[d],f,g;if(!gc){var i;if(!(i=b))a:{i=["window","event"];for(var k=ca;f=i.shift();)if(x(k[f]))k=k[f];else{i=r;break a}i=k}f=i;i=p in e;k=s in e;if(i){if(0>f.keyCode||f.returnValue!=n)return p;a:{var o=s;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(j){o=p}if(o||f.returnValue==n)f.returnValue=p}}o=new kc;o.R(f,this);f=p;try{if(i){for(var m=[],l=o.currentTarget;l;l=l.parentNode)m.push(l);g=e[p];g.ga=g.w;for(var q=
m.length-1;!o.vb&&0<=q&&g.ga;q--)o.currentTarget=m[q],f&=zc(g,m[q],d,p,o);if(k){g=e[s];g.ga=g.w;for(q=0;!o.vb&&q<m.length&&g.ga;q++)o.currentTarget=m[q],f&=zc(g,m[q],d,s,o)}}else f=Ac(c,o)}finally{m&&(m.length=0),o.ma()}return f}d=new kc(b,this);try{f=Ac(c,d)}finally{d.ma()}return f}var Bc=0;function Cc(a){return a+"_"+Bc++};function L(a,b,c){this.ea=this.da=this.ca=0;3==arguments.length?(this.ca=Number(a),this.da=Number(b),this.ea=Number(c)):"x"in a&&"y"in a&&"z"in a?(this.ca=Number(a.x()),this.da=Number(a.y()),this.ea=Number(a.b())):(this.ca=Number(a[0]),this.da=Number(a[1]),this.ea=Number(a[2]))}
L.prototype={d:function(){return new L(this.ca,this.da,this.ea)},cd:function(){return new L(-this.ca,-this.da,-this.ea)},ub:function(a){return new L(this.ca+a.x(),this.da+a.y(),this.ea+a.b())},Jb:function(a){return new L(this.ca-a.x(),this.da-a.y(),this.ea-a.b())},Na:function(a){return new L(this.ca*a,this.da*a,this.ea*a)},He:function(a){return new L(this.ca/a,this.da/a,this.ea/a)},nb:function(a){return this.ca*a.x()+this.da*a.y()+this.ea*a.b()},Qd:function(a,b){return this.ub(a.Jb(this).Na(b))},
length:function(){return Math.sqrt(this.nb(this))},Qb:function(){return this.He(this.length())},Mc:function(a){return new L(this.da*a.b()-this.ea*a.y(),this.ea*a.x()-this.ca*a.b(),this.ca*a.y()-this.da*a.x())},x:t("ca"),y:t("da"),b:t("ea")};A("csgVector",L);A("csgVector.prototype.clone",L.prototype.d);A("csgVector.prototype.plus",L.prototype.ub);A("csgVector.prototype.minus",L.prototype.Jb);A("csgVector.prototype.dividedBy",L.prototype.He);A("csgVector.prototype.times",L.prototype.Na);
A("csgVector.prototype.dot",L.prototype.nb);A("csgVector.prototype.lerp",L.prototype.Qd);A("csgVector.prototype.length",L.prototype.length);A("csgVector.prototype.unit",L.prototype.Qb);A("csgVector.prototype.cross",L.prototype.Mc);A("csgVector.prototype.negated",L.prototype.cd);A("csgVector.prototype.x",L.prototype.x);A("csgVector.prototype.y",L.prototype.y);A("csgVector.prototype.z",L.prototype.b);function Dc(){this.jd=n}
function Ec(a,b,c){switch(typeof b){case "string":Fc(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==r){c.push("null");break}if(ka(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],Ec(a,a.jd?a.jd.call(b,""+f,e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),Fc(f,c),c.push(":"),
Ec(a,a.jd?a.jd.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:h(Error("Unknown type: "+typeof b))}}var Gc={'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Hc=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function Fc(a,b){b.push('"',a.replace(Hc,function(a){if(a in Gc)return Gc[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Gc[a]=e+b.toString(16)}),'"')};function Ic(){}F(Ic,Ub);v=Ic.prototype;v.Ee=p;v.dd=r;v.ge=ba("dd");v.addEventListener=function(a,b,c,d){K(this,a,b,c,d)};v.removeEventListener=function(a,b,c,d){tc(this,a,b,c,d)};
v.dispatchEvent=function(a){var b=a.type||a,c=mc;if(b in c){if(y(a))a=new ic(a,this);else if(a instanceof ic)a.target=a.target||this;else{var d=a,a=new ic(b,this);sb(a,d)}var d=1,e,c=c[b],b=p in c,f;if(b){e=[];for(f=this;f;f=f.dd)e.push(f);f=c[p];f.ga=f.w;for(var g=e.length-1;!a.vb&&0<=g&&f.ga;g--)a.currentTarget=e[g],d&=zc(f,e[g],a.type,p,a)&&a.pc!=s}if(s in c)if(f=c[s],f.ga=f.w,b)for(g=0;!a.vb&&g<e.length&&f.ga;g++)a.currentTarget=e[g],d&=zc(f,e[g],a.type,s,a)&&a.pc!=s;else for(e=this;!a.vb&&e&&
f.ga;e=e.dd)a.currentTarget=e,d&=zc(f,e,a.type,s,a)&&a.pc!=s;a=Boolean(d)}else a=p;return a};v.z=function(){Ic.g.z.call(this);wc(this);this.dd=r};function M(){this.className="base";this.c=s}F(M,Ic);M.prototype.className=t("className");M.prototype.print=function(){var a=Object.keys(this),b="",c="<unknown>",d=0;for(d in a){var e="this."+a[d],f=eval(e);"this.className"==e?c=f:b+=e+": "+f+"\n"}return"== X."+c+" ==\n"+b};M.prototype.ig=t("c");function Jc(a){a.c=s}A("X.base",M);A("X.base.prototype.className",M.prototype.className);A("X.base.prototype.print",M.prototype.print);A("X.base.prototype.dirty",M.prototype.ig);function Kc(){M.call(this);this.className="indexer";this.xd=[];this.T={}}F(Kc,M);Kc.prototype.add=function(a){x(a)||h(Error("Invalid object."));var b;b=[];Ec(new Dc,a,b);b=b.join("");b in this.T||(this.T[b]=this.xd.length,this.xd.push(a));return this.T[b]};Kc.prototype.unique=t("xd");function Lc(a,b){this.Y=new L(a);this.D=new L(b)}Lc.prototype={d:function(){return new Lc(this.Y.d(),this.D.d())},Ka:function(){this.D=this.D.cd()},Ue:function(a,b){return new Lc(this.Y.Qd(a.Y,b),this.D.Qd(a.D,b))},mh:t("Y"),Vd:t("D")};A("csgVertex",Lc);A("csgVertex.prototype.clone",Lc.prototype.d);A("csgVertex.prototype.flip",Lc.prototype.Ka);A("csgVertex.prototype.interpolate",Lc.prototype.Ue);A("csgVertex.prototype.pos",Lc.prototype.mh);A("csgVertex.prototype.normal",Lc.prototype.Vd);function Mc(a){M.call(this);this.className="file";this.te=a;this.c=p}F(Mc,M);Mc.prototype.path=t("te");function Nc(){M.call(this);this.className="colorTable";this.T=new Mb;var a=window["X.Counter"];a.Xc();this._id=a.value();this.k=r}F(Nc,M);Nc.prototype.add=function(a,b,c,d,e,f){(!z(a)||!z(c)||!z(d)||!z(e)||!z(f))&&h(Error("Invalid color table entry."));this.T.set(a,[b,c,d,e,f]);this.c=p};Nc.prototype.id=t("_id");Nc.prototype.file=t("k");Nc.prototype.qc=function(a){x(a)?(y(a)&&(a=new Mc(a)),this.k=a):this.k=r};function Oc(a,b){this.D=a;this.Rb=b}Oc.prototype={d:function(){return new Oc(this.D.d(),this.Rb)},Ka:function(){this.D=this.D.cd();this.Rb=-this.Rb},ci:t("Rb"),Vd:t("D")};A("csgPlane.prototype.w",Oc.prototype.ci);A("csgPlane.prototype.normal",Oc.prototype.Vd);function Pc(a,b){this.Aa=a;this.sc=b;var c=a[0].Y,d=a[2].Y,d=a[1].Y.Jb(c).Mc(d.Jb(c)).Qb();this.ba=new Oc(d,d.nb(c))}
Pc.prototype={d:function(){var a=this.Aa.map(function(a){return a.d()});return new Pc(a,this.sc)},Ka:function(){this.Aa.reverse().map(function(a){a.Ka()});this.ba.Ka()},ai:t("Aa"),Lh:t("sc"),Gf:function(a,b,c,d,e){for(var f=0,g=[],i=0;i<this.Aa.length;i++){var k=a.D.nb(this.Aa[i].Y)-a.Rb,k=-1.0E-5>k?2:1.0E-5<k?1:0,f=f|k;g.push(k)}switch(f){case 0:(0<a.D.nb(this.ba.D)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(i=0;i<this.Aa.length;i++){var o=(i+1)%
this.Aa.length,k=g[i],j=g[o],f=this.Aa[i],o=this.Aa[o];2!=k&&b.push(f);1!=k&&c.push(2!=k?f.d():f);3==(k|j)&&(k=(a.Rb-a.D.nb(f.Y))/a.D.nb(o.Y.Jb(f.Y)),k=f.Ue(o,k),b.push(k),c.push(k.d()))}3<=b.length&&d.push(new Pc(b,this.sc));3<=c.length&&e.push(new Pc(c,this.sc))}}};A("csgPolygon",Pc);A("csgPolygon.prototype.clone",Pc.prototype.d);A("csgPolygon.prototype.flip",Pc.prototype.Ka);A("csgPolygon.prototype.vertices",Pc.prototype.ai);A("csgPolygon.prototype.shared",Pc.prototype.Lh);function Qc(a){this.N=this.O=this.ba=r;this.n=[];a&&this.Db(a)}
Qc.prototype={d:function(){var a=new Qc;a.Fh(this.ba&&this.ba.d());a.Dh(this.O&&this.O.d());a.wh(this.N&&this.N.d());a.rc(this.n.map(function(a){return a.d()}));return a},J:function(){for(var a=0;a<this.n.length;a++)this.n[a].Ka();this.ba.Ka();this.O&&this.O.J();this.N&&this.N.J();a=this.O;this.O=this.N;this.N=a},Bd:function(a){if(!this.ba)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Gf(this.ba,b,c,b,c);this.O&&(b=this.O.Bd(b));c=this.N?this.N.Bd(c):[];return b.concat(c)},la:function(a){this.n=
a.Bd(this.n);this.O&&this.O.la(a);this.N&&this.N.la(a)},Va:function(){var a=this.n.slice();this.O&&(a=a.concat(this.O.Va()));this.N&&(a=a.concat(this.N.Va()));return a},Db:function(a){if(a.length){this.ba||(this.ba=a[0].ba.d());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Gf(this.ba,this.n,this.n,b,c);b.length&&(this.O||(this.O=new Qc),this.O.Db(b));c.length&&(this.N||(this.N=new Qc),this.N.Db(c))}},Fh:ba("ba"),Dh:ba("O"),wh:ba("N"),xf:t("n"),rc:ba("n")};function O(){this.n=[]}function Rc(a){var b=new O;b.rc(a);return b}
O.prototype={d:function(){var a=new O;a.rc(this.n.map(function(a){return a.d()}));return a},Vh:t("n"),rd:function(a){var b=new Qc(this.d().n),a=new Qc(a.d().n);b.la(a);a.la(b);a.J();a.la(b);a.J();b.Db(a.Va());return Rc(b.Va())},za:function(a){var b=new Qc(this.d().n),a=new Qc(a.d().n);b.J();b.la(a);a.la(b);a.J();a.la(b);a.J();b.Db(a.Va());b.J();return Rc(b.Va())},Yc:function(a){var b=new Qc(this.d().n),a=new Qc(a.d().n);b.J();a.la(b);a.J();b.la(a);a.la(b);b.Db(a.Va());b.J();return Rc(b.Va())},inverse:function(){var a=
this.d();a.n.map(function(a){a.Ka()});return a},xf:t("n"),rc:ba("n")};A("CSG",O);A("CSG.fromPolygons",Rc);A("CSG.prototype.toPolygons",O.prototype.Vh);A("CSG.prototype.union",O.prototype.rd);A("CSG.prototype.subtract",O.prototype.za);A("CSG.prototype.intersect",O.prototype.Yc);A("CSG.prototype.inverse",O.prototype.inverse);A("CSG.prototype.polygons",O.prototype.xf);A("CSG.prototype.setPolygons",O.prototype.rc);function Sc(a,b,c){this.x=ha(a)?a:0;this.y=ha(b)?b:0;this.b=ha(c)?c:0}Sc.prototype.d=function(){return new Sc(this.x,this.y,this.b)};Sc.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.b+")"};Sc.prototype.oe=function(){return[this.x,this.y,this.b]};function P(a){M.call(this);this.className="triplets";this.Ea=Infinity;this.Ba=-Infinity;this.Fa=Infinity;this.Ca=-Infinity;this.Ga=Infinity;this.Da=-Infinity;this.yb=[0,0,0];this.V=[];x(a)&&(this.V=a.V.slice(),this.Ea=a.Ea,this.Ba=a.Ba,this.Fa=a.Fa,this.Ca=a.Ca,this.Ga=a.Ga,this.Da=a.Da,this.yb=a.yb.slice())}F(P,M);v=P.prototype;v.add=function(a,b,c){(!z(a)||!z(b)||!z(c))&&h(Error("Invalid triplet."));Tc(this,a,b,c);this.c=p;return this.V.push(a,b,c)/3};
function Tc(a,b,c,d){a.Ea=Math.min(a.Ea,b);a.Ba=Math.max(a.Ba,b);a.Fa=Math.min(a.Fa,c);a.Ca=Math.max(a.Ca,c);a.Ga=Math.min(a.Ga,d);a.Da=Math.max(a.Da,d);a.yb=[(a.Ea+a.Ba)/2,(a.Fa+a.Ca)/2,(a.Ga+a.Da)/2]}v.get=function(a){(!z(a)||0>a||3*a>this.V.length||a==this.count())&&h(Error("Invalid id."));a*=3;return[this.V[a],this.V[a+1],this.V[a+2]]};v.remove=function(a){(!z(a)||0>a||3*a>this.V.length||a==this.count())&&h(Error("Invalid id."));this.V.splice(a,3);this.c=p};v.all=t("V");
v.uh=function(a,b,c,d,e,f,g,i){this.V=a;if(!x(b)||!x(c)||!x(d)||!x(e)||!x(f)||!x(g)||!x(i))this.Ea=b,this.Ba=c,this.Fa=d,this.Ca=e,this.Ga=f,this.Da=g,this.yb=i;else for(a=a=0;a<this.count();a++)b=this.get(a),Tc(this,b[0],b[1],b[2]);this.c=p};v.clear=function(){this.V=[];this.c=p};v.count=function(){return this.V.length/3};v.length=function(){return this.V.length};v.Kg=t("Ea");v.Eg=t("Ba");v.Lg=t("Fa");v.Fg=t("Ca");v.Mg=t("Ga");v.Gg=t("Da");v.ag=t("yb");A("X.triplets",P);
A("X.triplets.prototype.add",P.prototype.add);A("X.triplets.prototype.get",P.prototype.get);A("X.triplets.prototype.remove",P.prototype.remove);A("X.triplets.prototype.all",P.prototype.all);A("X.triplets.prototype.setAll",P.prototype.uh);A("X.triplets.prototype.clear",P.prototype.clear);A("X.triplets.prototype.count",P.prototype.count);A("X.triplets.prototype.length",P.prototype.length);A("X.triplets.prototype.minA",P.prototype.Kg);A("X.triplets.prototype.maxA",P.prototype.Eg);
A("X.triplets.prototype.minB",P.prototype.Lg);A("X.triplets.prototype.maxB",P.prototype.Fg);A("X.triplets.prototype.minC",P.prototype.Mg);A("X.triplets.prototype.maxC",P.prototype.Gg);A("X.triplets.prototype.centroid",P.prototype.ag);function Q(a,b,c){this.x=a;this.y=b;this.b=c}F(Q,Sc);v=Q.prototype;v.d=function(){return new Q(this.x,this.y,this.b)};v.sb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};v.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};v.J=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};v.normalize=function(){return this.scale(1/this.sb())};v.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
v.za=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};v.Zb=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Uc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Xc(a,b){return new Q(a.x+b.x,a.y+b.y,a.b+b.b)}function Yc(a,b){return new Q(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Zc(a,b){this.x=ha(a)?a:0;this.y=ha(b)?b:0}Zc.prototype.d=function(){return new Zc(this.x,this.y)};Zc.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function $c(a,b){return new Zc(a.x-b.x,a.y-b.y)};function ad(a,b){this.x=a;this.y=b}F(ad,Zc);v=ad.prototype;v.d=function(){return new ad(this.x,this.y)};v.sb=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};v.scale=function(a){this.x*=a;this.y*=a;return this};v.J=function(){this.x=-this.x;this.y=-this.y;return this};v.normalize=function(){return this.scale(1/this.sb())};v.add=function(a){this.x+=a.x;this.y+=a.y;return this};v.za=function(a){this.x-=a.x;this.y-=a.y;return this};
v.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};v.Zb=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function bd(a,b){this.width=a;this.height=b}function cd(a,b){return a==b?p:!a||!b?s:a.width==b.width&&a.height==b.height}v=bd.prototype;v.d=function(){return new bd(this.width,this.height)};v.toString=function(){return"("+this.width+" x "+this.height+")"};v.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};v.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
v.scale=function(a){this.width*=a;this.height*=a;return this};function dd(a,b){if(a instanceof dd)this.v=a.oe();else{var c;if(c=la(a))a:{for(var d=c=0;d<a.length;d++){if(!la(a[d])||0<c&&a[d].length!=c){c=s;break a}for(var e=0;e<a[d].length;e++)if(!z(a[d][e])){c=s;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.v=Db(a):a instanceof bd?this.v=ed(a.height,a.width):z(a)&&z(b)&&0<a&&0<b?this.v=ed(a,b):h(Error("Invalid argument(s) for Matrix contructor"))}this.t=new bd(this.v[0].length,this.v.length)}
function fd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new dd(b)}function gd(a,b,c){for(var d=0;d<a.$().height;d++)for(var e=0;e<a.$().width;e++)b.call(c,a.v[d][e],d,e,a)}function hd(a,b){var c=new dd(a.$());gd(a,function(d,e,f){c.v[e][f]=b.call(n,d,e,f,a)});return c}function ed(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}v=dd.prototype;
v.add=function(a){cd(this.t,a.$())||h(Error("Matrix summation is only supported on arrays of equal size"));return hd(this,function(b,c,d){return b+a.v[c][d]})};v.Zb=function(a,b){if(this.t.width!=a.t.width||this.t.height!=a.t.height)return s;for(var c=b||0,d=0;d<this.t.height;d++)for(var e=0;e<this.t.width;e++)if(!(Math.abs(this.v[d][e]-a.v[d][e])<=(c||1.0E-6)))return s;return p};v.$=t("t");v.C=function(a,b){return!(0<=a&&a<this.t.height&&0<=b&&b<this.t.width)?r:this.v[a][b]};
function S(a,b,c,d){0<=b&&b<a.t.height&&0<=c&&c<a.t.width||h(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.t.height+","+a.t.width+")"));a.v[b][c]=d}v.multiply=function(a){if(a instanceof dd)return this.t.width!=a.$().height&&h(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),id(this,a);if(z(a))return jd(this,a);h(Error("A matrix can only be multiplied by a number or another matrix."))};
v.za=function(a){cd(this.t,a.$())||h(Error("Matrix subtraction is only supported on arrays of equal size."));return hd(this,function(b,c,d){return b-a.v[c][d]})};v.oe=t("v");v.toString=function(){var a=0;gd(this,function(b){b=(""+b).length;b>a&&(a=b)});var b=[];vb(this.v,function(c){b.push("[ ");vb(c,function(c){c=""+c;b.push(Array(a-c.length+1).join(" ")+c+" ")});b.push("]\n")});return b.join("")};
function id(a,b){var c=new dd(a.t.height,b.$().width);gd(c,function(a,e,f){for(var g=a=0;g<this.t.width;g++)a+=this.C(e,g)*b.C(g,f);S(c,e,f,a)},a);return c}function jd(a,b){return hd(a,function(a){return a*b})};function T(a,b){dd.call(this,a,b);this.className="matrix"}F(T,dd);function kd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new T(b)}v=T.prototype;v.I=function(){var a=[],b=this.$();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.C(c,d));return a};
v.translate=function(a){this.t.width!=this.t.height&&h(Error("Can not translate non-square matrix."));var b=this.$(),c=fd(b.height);a instanceof ad&&3==b.height?(S(c,0,2,a.x),S(c,1,2,a.y)):a instanceof Q&&4==b.height?(S(c,0,3,a.x),S(c,1,3,a.y),S(c,2,3,a.b)):h(Error("Translation failed."));return new T(this.multiply(c))};
v.rotate=function(a,b){(4!=this.$().height||this.t.width!=this.t.height)&&h(Error("Only 4x4 matrices can be rotated."));(!x(b)||!(b instanceof Q))&&h(Error("Invalid axis vector."));z(a)||h(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=fd(4);S(f,0,0,d+c.x*c.x*(1-d));S(f,0,1,c.x*c.y*(1-d)-c.b*e);S(f,0,2,c.x*c.b*(1-d)+c.y*e);S(f,1,0,c.y*c.x*(1-d)+c.b*e);S(f,1,1,d+c.y*c.y*(1-d));S(f,1,2,c.y*c.b*(1-d)-c.x*e);S(f,2,0,c.b*c.x*(1-d)-c.y*e);S(f,2,1,c.b*c.y*(1-d)+c.x*e);S(f,2,2,
d+c.b*c.b*(1-d));return new T(this.multiply(f))};v.oa=function(a){var b=this.$(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof Q&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):h(Error("Multiplication by vector failed."));a=this.multiply(new dd(c));return new Q(parseFloat(a.C(0,0)),parseFloat(a.C(1,0)),parseFloat(a.C(2,0)))};v.Th=function(a,b){var c=this.v[a];this.v[a]=this.v[b];this.v[b]=c};
v.Sh=function(a,b){for(var c=this.$(),d=0,d=0;d<c.height;d++){var e=this.C(d,a);e||(e=0);var f=this.C(d,b);f||(f=0);S(this,d,a,f);S(this,d,b,e)}};A("X.matrix",T);A("X.matrix.createIdentityMatrix",kd);A("X.matrix.prototype.flatten",T.prototype.I);A("X.matrix.prototype.translate",T.prototype.translate);A("X.matrix.prototype.rotate",T.prototype.rotate);A("X.matrix.prototype.toArray",T.prototype.oe);A("X.matrix.prototype.getValueAt",T.prototype.C);A("X.matrix.prototype.multiplyByVector",T.prototype.oa);
A("X.matrix.prototype.swapRows",T.prototype.Th);A("X.matrix.prototype.swapCols",T.prototype.Sh);function ld(){M.call(this);this.className="transform";this.i=kd(4);this.ra=new Float32Array(this.i.I())}F(ld,M);v=ld.prototype;v.ph=function(a){(!z(a)||-360>a||360<a)&&h(Error("Invalid angle."));this.i=this.i.rotate(a*Math.PI/180,new Q(0,1,0));this.ra=new Float32Array(this.i.I());this.c=p};v.qh=function(a){(!z(a)||-360>a||360<a)&&h(Error("Invalid angle."));this.i=this.i.rotate(a*Math.PI/180,new Q(1,0,0));this.ra=new Float32Array(this.i.I());this.c=p};
v.rh=function(a){(!z(a)||-360>a||360<a)&&h(Error("Invalid angle."));this.i=this.i.rotate(a*Math.PI/180,new Q(0,0,1));this.ra=new Float32Array(this.i.I());this.c=p};v.Xh=function(a){z(a)||h(Error("Invalid distance."));this.i=this.i.translate(new Q(a,0,0));this.ra=new Float32Array(this.i.I());this.c=p};v.Yh=function(a){z(a)||h(Error("Invalid distance."));this.i=this.i.translate(new Q(0,a,0));this.ra=new Float32Array(this.i.I());this.c=p};
v.Zh=function(a){z(a)||h(Error("Invalid distance."));this.i=this.i.translate(new Q(0,0,a));this.ra=new Float32Array(this.i.I());this.c=p};v.Dg=t("i");v.Bf=function(a){var b=kd(4);x(a)&&a instanceof T&&(b=a);this.i=b;this.ra=new Float32Array(this.i.I());this.c=p};v.qg=t("ra");function md(a,b,c){var d=a.i.C(b,c);d||(d=0);S(a.i,b,c,-1*d);a.ra=new Float32Array(a.i.I());a.c=p}v.mg=function(){md(this,0,0)};v.ng=function(){md(this,1,1)};v.og=function(){md(this,2,2)};A("X.transform",ld);
A("X.transform.prototype.rotateX",ld.prototype.ph);A("X.transform.prototype.rotateY",ld.prototype.qh);A("X.transform.prototype.rotateZ",ld.prototype.rh);A("X.transform.prototype.translateX",ld.prototype.Xh);A("X.transform.prototype.translateY",ld.prototype.Yh);A("X.transform.prototype.translateZ",ld.prototype.Zh);A("X.transform.prototype.matrix",ld.prototype.Dg);A("X.transform.prototype.glMatrix",ld.prototype.qg);A("X.transform.prototype.setMatrix",ld.prototype.Bf);
A("X.transform.prototype.flipX",ld.prototype.mg);A("X.transform.prototype.flipY",ld.prototype.ng);A("X.transform.prototype.flipZ",ld.prototype.og);function nd(){M.call(this);this.className="scalars";var a=window["X.Counter"];a.Xc();this._id=a.value();this.Bc=this.u=this.k=r;this.Dc=Infinity;this.Cc=-Infinity;this._minColor=[0,1,0];this._maxColor=[1,0,0];this._minThreshold=-Infinity;this._maxThreshold=Infinity;this.we=p}F(nd,M);v=nd.prototype;v.id=t("_id");v.file=t("k");v.qc=function(a){x(a)?(y(a)&&(a=new Mc(a)),this.k=a):this.k=r};v.vh=function(a){this.Bc=this.u=a;this.c=p};v.min=t("Dc");v.max=t("Cc");
v.Ah=function(a,b){(!x(a)||!(a instanceof Array)||3!=a.length)&&h(Error("Invalid min. color."));(!x(b)||!(b instanceof Array)||3!=b.length)&&h(Error("Invalid max. color."));this._minColor=a;this._maxColor=b};v.bg=function(){return[this._minColor,this._maxColor]};A("X.scalars",nd);A("X.scalars.prototype.min",nd.prototype.min);A("X.scalars.prototype.max",nd.prototype.max);A("X.scalars.prototype.colorRange",nd.prototype.bg);A("X.scalars.prototype.setColorRange",nd.prototype.Ah);
A("X.scalars.prototype.setArray",nd.prototype.vh);function od(){M.call(this);this.className="texture";var a=window["X.Counter"];a.Xc();this._id=a.value();this.Bb=this.td=this.k=r;this.Ec=this.Fc=0;this.c=p}F(od,M);od.prototype.id=t("_id");od.prototype.file=t("k");od.prototype.qc=function(a){x(a)?(y(a)&&(a=new Mc(a)),this.k=a):this.k=r};od.prototype.Te=t("td");function U(a){M.call(this);this.className="object";var b=window["X.Counter"];b.Xc();this._id=b.value();this._type=pd;this.Cb=new ld;this._color=[1,1,1];this.f=new P;this.h=new P;this.ja=new P;this.k=this.jb=this.M=r;this._opacity=1;this.zb=r;this.L=s;this._visible=p;this._lineWidth=this._pointSize=1;this._caption=r;this._magicMode=s;x(a)&&this.mb(a);this.o=this.q=r;this.ue=[];this.G=0;this.c=p}F(U,M);var pd="TRIANGLES";v=U.prototype;
v.mb=function(a){this._type=a._type;this.Cb.Bf(new T(a.Cb.i.v));this._color=a._color.slice();this.f=new P(a.f);this.h=new P(a.h);this.ja=new P(a.ja);this.M=a.M;this.jb=a.jb;a.k&&(this.k=new Mc((new String(a.k.te)).toString()));this._opacity=a._opacity;this.children().length=0;var b=a.zb;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this._newChild=this._child=b[d],eval("this['_newChild'] = new X."+this._child.className+"(this['_child']);"),this.children().push(this._newChild);this._visible=a._visible;this._pointSize=
a._pointSize;this._lineWidth=a._lineWidth;a._caption&&(this._caption=(new String(a._caption)).toString());this._magicMode=a._magicMode;this.c=p};v.id=t("_id");function qd(a){for(var b=a.f.count(),c=[],d=0,d=0;d<b;d+=3){var e=a.f.get(d),f=a.f.get(d+1),g=a.f.get(d+2),i=a.h.get(d),k=a.h.get(d+1),o=a.h.get(d+2),j=a._color;0<a.ja.length()&&(j=a.ja.get(d));var m=[];m.push(new Lc(e,i));m.push(new Lc(f,k));m.push(new Lc(g,o));c.push(new Pc(m,j))}return Rc(c)}
function rd(a,b){(!x(b)||!(b instanceof O))&&h(Error("Invalid CSG object."));a.f.clear();a.h.clear();a.ja.clear();var c=new Kc,d=[];wb(b.n,function(a){for(var b=[],g=a.sc,b=wb(a.Aa,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Sf=wb(c.unique(),function(a){return[a.Y.x(),a.Y.y(),a.Y.b()]});a.Rf=wb(c.unique(),function(a){return[a.D.x(),a.D.y(),a.D.b()]});a.Qf=wb(c.unique(),function(a){return!a.color?r:[a.color[0],a.color[1],a.color[2]]});wb(d,function(a){var b=
a[0],c=a[1],a=a[2],d=this.Sf,k=this.Rf,o=this.Qf;this.f.add(d[b][0],d[b][1],d[b][2]);this.f.add(d[c][0],d[c][1],d[c][2]);this.f.add(d[a][0],d[a][1],d[a][2]);this.h.add(k[b][0],k[b][1],k[b][2]);this.h.add(k[c][0],k[c][1],k[c][2]);this.h.add(k[a][0],k[a][1],k[a][2]);o[b]&&this.ja.add(o[b][0],o[b][1],o[b][2]);o[c]&&this.ja.add(o[c][0],o[c][1],o[c][2]);o[a]&&this.ja.add(o[a][0],o[a][1],o[a][2])}.bind(a));a.Ya(pd)}v.type=t("_type");v.Ya=ba("_type");v.transform=t("Cb");v.kh=t("f");v.Pg=t("h");v.dg=t("ja");
v.color=t("_color");v.Uh=t("M");v.nd=function(a){if(x(a)){if(y(a)){var b=a,a=new od;a.qc(b)}a instanceof od||h(Error("Invalid texture."));this.M=a}else this.M=r};v.cg=t("q");v.Bh=function(a){if(x(a)){if(y(a)){var b=a,a=new Nc;a.qc(b)}a instanceof Nc||h(Error("Invalid colorTable."));this.q=a}else this.q=r};
v.ee=function(a,b,c){(!z(a)&&0>a&&1<a||!z(b)&&0>b&&1<b||!z(c)&&0>c&&1<c)&&h(Error("Invalid color."));if(this.Wc())for(var d=this.children(),e=d.length,f=0,f=0;f<e;f++)d[f].ee(a,b,c);this._color[0]=a;this._color[1]=b;this._color[2]=c;this.c=p};v.rd=function(a){(!x(a)||!(a instanceof O)&&!(a instanceof U))&&h(Error("Invalid object."));var b=a;a instanceof U&&(b=qd(b));a=new U;rd(a,qd(this).rd(b));return a};
v.za=function(a){(!x(a)||!(a instanceof O)&&!(a instanceof U))&&h(Error("Invalid object."));var b=a;a instanceof U&&(b=qd(b));a=new U;rd(a,qd(this).za(b));return a};v.Yc=function(a){(!x(a)||!(a instanceof O)&&!(a instanceof U))&&h(Error("Invalid object."));var b=a;a instanceof U&&(b=qd(b));a=new U;rd(a,qd(this).Yc(b));return a};v.inverse=function(a){(!x(a)||!(a instanceof O)&&!(a instanceof U))&&h(Error("Invalid object."));var b=a;a instanceof U&&(b=qd(b));a=new U;rd(a,qd(this).inverse(b));return a};
v.opacity=t("_opacity");v.caption=t("_caption");v.yh=function(a){this._caption=a;this.c=p};v.s=function(a){if(this.Wc())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].s(a);this._visible=a;this.c=p};v.bi=t("_visible");v.Cf=function(a){(!z(a)||1<a||0>a)&&h(Error("Invalid opacity."));if(this.Wc())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].Cf(a);this._opacity=a;this.c=p};v.load=function(a){this.k=x(a)?new Mc(a):r};v.file=t("k");v.va=function(){var a=new sd;a.U=this;this.dispatchEvent(a)};
v.children=function(){this.zb||(this.zb=[]);return this.zb};v.Wc=function(){return!this.zb||this.L?s:0<this.zb.length};v.Af=function(a){z(a)||h(Error("Invalid line width."));this._lineWidth=a;this.c=p};v.lineWidth=t("_lineWidth");v.Gh=function(a){z(a)||h(Error("Invalid point size."));this._pointSize=a;this.c=p};v.jh=t("_pointSize");v.Cg=t("_magicMode");v.Eh=function(a){"boolean"!=typeof a&&h(Error("Invalid magicMode setting."));this._magicMode=a};v.th=t("o");
v.Hh=function(a){if(x(a)){if(y(a)){var b=a,a=new nd;a.qc(b)}a instanceof nd||h(Error("Invalid scalars."));this.o=a}else this.o=r};function td(a,b){(!x(a)||!x(b)||!(a instanceof U)||!(b instanceof U))&&h(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a._opacity?-1:1==b._opacity?1:x(a.G)&&x(b.G)&&a.G>b.G?-1:1}A("X.object",U);A("X.object.prototype.id",U.prototype.id);A("X.object.prototype.type",U.prototype.type);A("X.object.prototype.setType",U.prototype.Ya);
A("X.object.prototype.transform",U.prototype.transform);A("X.object.prototype.points",U.prototype.kh);A("X.object.prototype.normals",U.prototype.Pg);A("X.object.prototype.texture",U.prototype.Uh);A("X.object.prototype.setTexture",U.prototype.nd);A("X.object.prototype.colorTable",U.prototype.cg);A("X.object.prototype.setColorTable",U.prototype.Bh);A("X.object.prototype.scalars",U.prototype.th);A("X.object.prototype.setScalars",U.prototype.Hh);A("X.object.prototype.colors",U.prototype.dg);
A("X.object.prototype.color",U.prototype.color);A("X.object.prototype.setColor",U.prototype.ee);A("X.object.prototype.opacity",U.prototype.opacity);A("X.object.prototype.setOpacity",U.prototype.Cf);A("X.object.prototype.lineWidth",U.prototype.lineWidth);A("X.object.prototype.setLineWidth",U.prototype.Af);A("X.object.prototype.pointSize",U.prototype.jh);A("X.object.prototype.setPointSize",U.prototype.Gh);A("X.object.prototype.load",U.prototype.load);A("X.object.prototype.file",U.prototype.file);
A("X.object.prototype.caption",U.prototype.caption);A("X.object.prototype.visible",U.prototype.bi);A("X.object.prototype.setCaption",U.prototype.yh);A("X.object.prototype.setVisible",U.prototype.s);A("X.object.prototype.magicMode",U.prototype.Cg);A("X.object.prototype.setMagicMode",U.prototype.Eh);A("X.object.prototype.intersect",U.prototype.Yc);A("X.object.prototype.inverse",U.prototype.inverse);A("X.object.prototype.subtract",U.prototype.za);A("X.object.prototype.union",U.prototype.rd);
A("X.object.prototype.children",U.prototype.children);A("X.object.prototype.modified",U.prototype.va);function W(a){ic.call(this,a);this.className="event"}F(W,ic);var ud=Cc("pan"),vd=Cc("rotate"),wd=Cc("zoom"),xd=Cc("scroll"),yd=Cc("render"),zd=Cc("resetview"),yc=Cc("modified"),Ad=Cc("progress"),Bd=Cc("hover"),Cd=Cc("hover_end");function Dd(){W.call(this,ud);this.G=new ad(0,0)}F(Dd,W);function Ed(){W.call(this,vd);this.G=new ad(0,0)}F(Ed,W);function Fd(){W.call(this,wd);this.Oa=this.fb=s}F(Fd,W);function Hd(){W.call(this,xd);this.W=s}F(Hd,W);function Id(){W.call(this,yd)}F(Id,W);
function Jd(){W.call(this,Bd);this.Jc=this.Ic=0}F(Jd,W);function Kd(){W.call(this,Cd)}F(Kd,W);function Ld(){W.call(this,zd)}F(Ld,W);function sd(){W.call(this,yc);this.U=new U}F(sd,W);function Md(){W.call(this,Ad);this.xe=0}F(Md,W);function Nd(a){this.j=a;this.Ze=K(this.j,Ua?"DOMMouseScroll":"mousewheel",this)}F(Nd,Ic);
Nd.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.ua;if("mousewheel"==a.type){c=1;if(G||J&&(Oa||jb("532.0")))c=40;d=J&&Na&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ha(a.wheelDeltaX)?(b=J&&Na&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=J&&Na&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ha(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;z(this.af)&&Math.min(Math.max(b,-this.af),this.af);z(this.bf)&&(c=Math.min(Math.max(c,-this.bf),
this.bf));b=new Od(d,a,0,c);try{this.dispatchEvent(b)}finally{b.ma()}};Nd.prototype.z=function(){Nd.g.z.call(this);uc(this.Ze);delete this.Ze};function Od(a,b,c,d){b&&this.R(b,n);this.type="mousewheel";this.detail=a;this.Gb=d}F(Od,kc);G||J&&jb("525");var Pd;function Qd(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Eb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=ub(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var Rd=!G||nb(9);!Ua&&!G||G&&nb(9)||Ua&&jb("1.9.1");G&&jb("9");function Sd(a){return a?new Td(Ud(a)):Pd||(Pd=new Td)}function Vd(a){return y(a)?document.getElementById(a):a}function Wd(a,b){ob(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Xd?a.setAttribute(Xd[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var Xd={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function Yd(a,b,c){return Zd(document,arguments)}
function Zd(a,b){var c=b[0],d=b[1];if(!Rd&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Ca(d.name),'"');if(d.type){c.push(' type="',Ca(d.type),'"');var e={};sb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(y(d)?c.className=d:ka(d)?Qd.apply(r,[c].concat(d)):Wd(c,d));2<b.length&&$d(a,c,b);return c}
function $d(a,b,c){function d(c){c&&b.appendChild(y(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];la(f)&&!(na(f)&&0<f.nodeType)?vb(ae(f)?Db(f):f,d):d(f)}}function be(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function ce(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function de(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Ud(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function ae(a){if(a&&"number"==typeof a.length){if(na(a))return"function"==typeof a.item||"string"==typeof a.item;if(ma(a))return"function"==typeof a.item}return s}function Td(a){this.A=a||ca.document||document}v=Td.prototype;
v.Qc=Sd;v.e=function(a){return y(a)?this.A.getElementById(a):a};v.Fb=function(a,b,c){return Zd(this.A,arguments)};v.createElement=function(a){return this.A.createElement(a)};v.createTextNode=function(a){return this.A.createTextNode(a)};function ee(a){return"CSS1Compat"==a.A.compatMode}function fe(a){var b=a.A,a=!J&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Zc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}v.appendChild=function(a,b){a.appendChild(b)};
v.contains=de;function ge(a){(!x(a)||!(a instanceof Element))&&h(Error("Could not add interactor to the given element."));M.call(this);this.className="interactor";this.element=a;this.Td=this.ff=this.ef=this.gf=this.df=this.hf=r;this.Sd=p;this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=s;this.Od=new ad(0,0);this.config={MOUSEWHEEL_ENABLED:p,MOUSECLICKS_ENABLED:p,KEYBOARD_ENABLED:p,HOVERING_ENABLED:p,CONTEXTMENU_ENABLED:s}}F(ge,M);v=ge.prototype;
v.R=function(){this.config.MOUSEWHEEL_ENABLED?(this.Td=new Nd(this.element),this.hf=K(this.Td,"mousewheel",this.mc.bind(this))):(uc(this.hf),this.Td=r);this.config.MOUSECLICKS_ENABLED?(this.df=K(this.element,"mousedown",this.Ug.bind(this)),this.gf=K(this.element,"mouseup",this.Zg.bind(this))):(uc(this.df),uc(this.gf));this.element.oncontextmenu=this.config.CONTEXTMENU_ENABLED?r:function(){return s};window.onkeydown=this.config.KEYBOARD_ENABLED?this.mf.bind(this):r;uc(this.ef);uc(this.ff);this.ef=
K(this.element,"mousemove",this.Wg.bind(this));this.ff=K(this.element,"mouseout",this.Xg.bind(this))};v.Ug=function(a){0==a.button?this.leftButtonDown=p:1==a.button?this.middleButtonDown=p:2==a.button&&(this.rightButtonDown=p);eval("this.onMouseDown(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");he(this);a.preventDefault()};v.Tg=aa();
v.Zg=function(a){0==a.button?this.leftButtonDown=s:1==a.button?this.middleButtonDown=s:2==a.button&&(this.rightButtonDown=s);eval("this.onMouseUp(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");he(this);a.preventDefault()};v.Yg=aa();v.Xg=function(a){this.Sd=s;this.config.KEYBOARD_ENABLED&&(window.onkeydown=r);this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=s;he(this);this.Od=new ad(0,0);a.preventDefault()};v.Vg=aa();
v.Wg=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Sd=p;this.config.KEYBOARD_ENABLED&&window.onkeydown==r&&(window.onkeydown=this.mf.bind(this));a.preventDefault();var b=a.shiftKey,c=new ad(a.offsetX,a.offsetY),a=this.Od.za(c);this.Od=c.d();this.config.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.middleButtonDown||this.leftButtonDown||this.rightButtonDown)&&he(this),this.Kd=setTimeout(function(){he(this);var a=new Jd;a.Ic=c.x;a.Jc=c.y;this.dispatchEvent(a);
this.Kd=r}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.sb()&&(this.leftButtonDown&&!b?(b=new Ed,b.G=a,b.Li=0,this.dispatchEvent(b)):this.middleButtonDown||this.leftButtonDown&&b?(b=new Dd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.G=a,this.dispatchEvent(b)):this.rightButtonDown&&(b=new Fd,b.fb=0<a.y,b.Oa=s,this.dispatchEvent(b)))};function he(a){a.Kd&&clearTimeout(a.Kd);a.dispatchEvent(new Kd)}v.$g=aa();
v.mc=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");he(this);a.preventDefault()};v.Rg=aa();
v.mf=function(a){if(this.Sd){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");he(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Ld,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Dd:b?a=new Fd:(a=new Ed,this instanceof ie&&(a=new Hd)),a&&(c=new ad(0,0),37==f?(c.x=5,a.W=s,b&&(a.W=p,a.fb=p,a.Oa=s)):39==f?(c.x=-5,a.W=p,b&&(a.fb=s,a.Oa=s)):38==f?(c.y=5,a.W=p,b&&(a.fb=p,a.Oa=p)):40==f&&(c.y=-5,a.W=s,b&&(a.fb=s,
a.Oa=p)),a.G=c,this.dispatchEvent(a)))}};A("X.interactor",ge);A("X.interactor.prototype.init",ge.prototype.R);A("X.interactor.prototype.onMouseDown",ge.prototype.Tg);A("X.interactor.prototype.onMouseUp",ge.prototype.Yg);A("X.interactor.prototype.onMouseMove",ge.prototype.Vg);A("X.interactor.prototype.onMouseWheel",ge.prototype.$g);A("X.interactor.prototype.onKey",ge.prototype.Rg);function ie(a){ge.call(this,a);this.className="interactor2D"}F(ie,ge);ie.prototype.mc=function(a){ie.g.mc.call(this,a);var b=new Hd;x(a.Gb)||(a.Gb=0);b.W=0>a.Gb;this.dispatchEvent(b)};function je(a){U.call(this);this.className="slice";this.m=[0,0,0];this.Ab=[0,0,1];this.W=[0,1,0];this.eb=this.kb=10;this.jb=[0,1,0,0,1,1,1,1,1,0,0,0];this.B=this.Ja=r;this.qa=p;this.xb=[1,1,1];this.L=p;x(a)&&this.mb(a)}F(je,U);je.prototype.mb=function(a){this.m=a.m.slice();this.Ab=a.Ab.slice();this.W=a.W.slice();this.kb=a.kb;this.eb=a.eb;this.Ja=a.Ja;this.B=a.B;this.qa=a.qa;this.xb=a.xb;this.L=a.L;je.g.mb.call(this,a)};
je.prototype.Df=function(a,b,c,d,e,f,g){(!x(a)||!(a instanceof Array)||3!=a.length)&&h(Error("Invalid center."));(!x(b)||!(b instanceof Array)||3!=b.length)&&h(Error("Invalid front direction."));(!x(c)||!(c instanceof Array)||3!=c.length)&&h(Error("Invalid up direction."));z(d)||h(Error("Invalid width."));z(e)||h(Error("Invalid height."));var i=s;x(f)&&(i=f);f=[1,1,1];x(g)&&(f=g);this.m=a;this.Ab=b;this.W=c;this.kb=d;this.eb=e;this.qa=i;this.xb=f;this.sa()};
je.prototype.sa=function(){this.f.clear();var a=new Q(this.Ab[0],this.Ab[1],this.Ab[2]),b=new Q(this.W[0],this.W[1],this.W[2]),c=Yc(b,a),d=new Q(this.m[0],this.m[1],this.m[2]),e=new Q(1,1,1);1==a.x?(e=new Q(this.m[0],this.eb/2,this.kb/2),this.jb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new Q(this.kb/2,this.m[1],this.eb/2),this.jb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new Q(this.kb/2,this.eb/2,this.m[2]));var f=Xc(c.d().J(),b.d().J()),f=new Q(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Xc(c.d().J(),b),g=new Q(g.x*
e.x,g.y*e.y,g.b*e.b);g.add(d);var i=Xc(c,b.d().J()),i=new Q(i.x*e.x,i.y*e.y,i.b*e.b);i.add(d);var k=i,b=Xc(c,b),b=new Q(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.f.add(f.x,f.y,f.b);this.f.add(g.x,g.y,g.b);this.f.add(i.x,i.y,i.b);this.f.add(k.x,k.y,k.b);this.f.add(b.x,b.y,b.b);this.f.add(d.x,d.y,d.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.h.add(a.x,a.y,a.b);this.qa&&(a=new U,a.f.add(f.x,f.y,f.b),a.f.add(g.x,g.y,
g.b),a.f.add(g.x,g.y,g.b),a.f.add(b.x,b.y,b.b),a.f.add(b.x,b.y,b.b),a.f.add(i.x,i.y,i.b),a.f.add(i.x,i.y,i.b),a.f.add(f.x,f.y,f.b),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.h.add(0,0,0),a.ee(this.xb[0],this.xb[1],this.xb[2]),a.Ya("LINES"),a.Af(2),this.children().push(a))};je.prototype.Ye=t("B");A("X.slice",je);A("X.slice.prototype.setup",je.prototype.Df);function Y(a){U.call(this);this.className="volume";this.m=[0,0,0];this.S=[10,10,10];this.H=[1,1,1];this.Vb=this._indexZ=this.Ub=this._indexY=this.Tb=this._indexX=0;this.gb=new U;this.hb=new U;this.ib=new U;this._lowerThreshold=0;this._upperThreshold=1E3;this.Ha=[0,1E3];this.Hc=this._volumeRendering=s;this.Ua=0;this.B=r;this.qa=p;x(a)&&this.mb(a)}F(Y,U);v=Y.prototype;
v.mb=function(a){this.m=a.m.slice();this.S=a.S.slice();this.H=a.H.slice();this._indexX=a._indexX;this.Tb=a.Tb;this._indexY=a._indexY;this.Ub=a.Ub;this._indexZ=a._indexZ;this.Vb=a.Vb;this.gb=new U(a.gb);this.hb=new U(a.hb);this.ib=new U(a.ib);this._lowerThreshold=a._lowerThreshold;this._upperThreshold=a._upperThreshold;this.Ha=a.Ha.slice();this._volumeRendering=a._volumeRendering;this.Hc=a.Hc;this.Ua=a.Ua;this.B=a.B;this.qa=a.qa;Y.g.mb.call(this,a)};
v.sa=function(){this.children().length=0;this.children().push(this.gb);this.children().push(this.hb);this.children().push(this.ib);for(var a=0,a=0;3>a;a++){for(var b=(this.S[a]-1)/2,c=b,d=0,d=0;d<this.S[a];d++){var e=-b*this.H[a]+d*this.H[a],e=[[this.m[0]+e,this.m[1],this.m[2]],[this.m[0],this.m[1]+e,this.m[2]],[this.m[0],this.m[1],this.m[2]+e]],f=this.children()[a].children(),g=0,i=0,k=[1,1,1],o=this.qa;0==a?(g=this.S[2]*this.H[2]-this.H[2],i=this.S[1]*this.H[1]-this.H[1],k=[1,1,0]):1==a?(g=this.S[0]*
this.H[0]-this.H[0],i=this.S[2]*this.H[2]-this.H[2],k=[1,0,0]):2==a&&(g=this.S[0]*this.H[0]-this.H[0],i=this.S[1]*this.H[1]-this.H[1],k=[0,1,0]);x(this.Ja)&&(o=s);var j=new je;j.Df(e[a],[[1,0,0],[0,1,0],[0,0,1]][a],[[0,1,0],[0,0,-1],[0,1,0]][a],g,i,o,k);j.Ja=this;j.L=s;j.s(d==Math.floor(c));j.L=p;f.push(j)}0==a?this.Tb=this._indexX=c:1==a?this.Ub=this._indexY=c:2==a&&(this.Vb=this._indexZ=c)}this.c=p};
v.va=function(){if(0<this.children().length)if(this._volumeRendering!=this.Hc&&(this.c=p,this.Hc=this._volumeRendering),this._volumeRendering){var a=this.children()[0].children()[parseInt(this._indexX,10)];a.L=s;a.s(s);a.L=p;a=this.children()[1].children()[parseInt(this._indexY,10)];a.L=s;a.s(s);a.L=p;a=this.children()[2].children()[parseInt(this._indexZ,10)];a.L=s;a.s(s);a.L=p;ke(this,this.Ua)}else{this.children()[this.Ua].s(s);for(a=a=0;3>a;a++){var b=this.children()[a],c=0,d=0;0==a?(c=this._indexX,
d=this.Tb,this.Tb=this._indexX):1==a?(c=this._indexY,d=this.Ub,this.Ub=this._indexY):2==a&&(c=this._indexZ,d=this.Vb,this.Vb=this._indexZ);d=b.children()[parseInt(d,10)];d.L=s;d.s(s);d.L=p;b=b.children()[parseInt(c,10)];b.L=s;b.s(p);b.L=p}}Y.g.va.call(this)};v.hg=t("S");v.sh=t("Ha");v.ne=function(a,b){(!x(a)||!z(a)||!x(b)||!z(b)||a>b||a<this.Ha[0]||b>this.Ha[1])&&h(Error("Invalid threshold range."));this._lowerThreshold=a;this._upperThreshold=b};v.Kh=ba("_volumeRendering");v.s=ba("_visible");
v.zh=function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&h(Error("Invalid center."));this.m=a};function ke(a,b){if(!(!a.c&&!a._volumeRendering||!a.c&&b==a.Ua)){var c=a.children()[a.Ua];c.s(s);c=a.children()[b];c.s(p);a.Ua=b}}v.Ye=function(){this.B||(this.B=new le(this));return this.B};v.$f=t("qa");v.xh=ba("qa");A("X.volume",Y);A("X.volume.prototype.dimensions",Y.prototype.hg);A("X.volume.prototype.scalarRange",Y.prototype.sh);A("X.volume.prototype.setVisible",Y.prototype.s);
A("X.volume.prototype.setCenter",Y.prototype.zh);A("X.volume.prototype.setVolumeRendering",Y.prototype.Kh);A("X.volume.prototype.threshold",Y.prototype.ne);A("X.volume.prototype.modified",Y.prototype.va);A("X.volume.prototype.labelMap",Y.prototype.Ye);A("X.volume.prototype.borders",Y.prototype.$f);A("X.volume.prototype.setBorders",Y.prototype.xh);function me(){M.call(this);this.className="parser"}F(me,M);v=me.prototype;v.parse=function(){h(Error("The function parse() should be overloaded."))};v.nc=function(a,b){var c=this.l(a,b+2),d=this.l(a,b+3),e=(d<<1&255|c>>7)-127,c=(c&127)<<16|this.l(a,b+1)<<8|this.l(a,b);return 0==c&&-127==e?0:(1-2*(d>>7))*(1+c*Math.pow(2,-23))*Math.pow(2,e)};
function ne(a,b,c){var d=a.l(b,c),e=a.l(b,c+1),f=(d<<1&255|e>>7)-127,a=(e&127)<<16|a.l(b,c+2)<<8|a.l(b,c+3);return 0==a&&-127==f?0:(1-2*(d>>7))*(1+a*Math.pow(2,-23))*Math.pow(2,f)}function oe(a,b,c,d){var e=[],f=0,g=Infinity,i;for(i=0;i<d;i++){var k=a.nc(b,c+4*i);e[i]=k;f=Math.max(f,k);g=Math.min(g,k)}return[e,f,g]}v.ce=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var i=ne(this,a,b+4*g);d[g]=i;e=Math.max(e,i);f=Math.min(f,i)}return[d,e,f]};
function pe(a,b,c){return(a.l(b,c+3)<<24)+(a.l(b,c+2)<<16)+(a.l(b,c+1)<<8)+a.l(b,c)}function qe(a,b,c){return(a.l(b,c)<<24)+(a.l(b,c+1)<<16)+(a.l(b,c+2)<<8)+a.l(b,c+3)}v.uf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var i=qe(this,a,b+4*g);d[g]=i;e=Math.max(e,i);f=Math.min(f,i)}return[d,e,f]};v.gd=function(a,b){return(this.l(a,b+1)<<8)+this.l(a,b)};
v.tf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var i=(this.l(a,b+2*g)<<8)+this.l(a,b+2*g+1);d[g]=i;e=Math.max(e,i);f=Math.min(f,i)}return[d,e,f]};v.gh=function(a,b){var c=this.l(a,b);return 127<c?c-256:c};v.l=function(a,b){return a.charCodeAt(b)&255};v.sf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var i=this.l(a,b+g);d[g]=i;e=Math.max(e,i);f=Math.min(f,i)}return[d,e,f]};
function re(a,b,c,d){for(var e=c[2],f=c[1],c=c[0],g=a.B!=r,i=f*c,k=Array(e),o=0;o<e;o++){k[o]=Array(f);for(var j=0;j<f;j++)k[o][j]=Array(c)}for(var m=0,o=o=0;o<e;o++){for(var l=b.slice(o*i,(o+1)*i),j=new Uint8Array(4*i),q=0,u=0,w=0,q=0;q<f;q++)for(u=0;u<c;u++){var m=l[w],B=0,D=0,I=0,C=0;a.q?((C=a.q.T.get(Math.floor(m)))||(C=a.q.T.get(a.q.T.Z()-1)),B=255*C[1],D=255*C[2],I=255*C[3],C=255*C[4]):(B=D=I=255*(m/d),C=255);var E=4*w;j[E]=B;j[++E]=D;j[++E]=I;j[++E]=C;k[o][q][u]=m;w++}q=m=new od;q.Bb=j;q.c=
p;j=m;j.Fc=c;j.c=p;j=m;j.Ec=f;j.c=p;l=a.ib.children()[o];l.nd(m);g&&(l.B=a.B.ib.children()[o].M)}for(q=0;q<f;q++){j=new Uint8Array(4*e*c);for(o=w=0;o<e;o++)for(u=0;u<c;u++)m=k[o][q][u],a.q?((C=a.q.T.get(Math.floor(m)))||(C=a.q.T.get(a.q.T.Z()-1)),B=255*C[1],D=255*C[2],I=255*C[3],C=255*C[4]):(B=D=I=255*(m/d),C=255),E=4*w,j[E]=B,j[++E]=D,j[++E]=I,j[++E]=C,w++;b=m=new od;b.Bb=j;b.c=p;b=m;b.Fc=c;b.c=p;b=m;b.Ec=e;b.c=p;l=a.hb.children()[q];l.nd(m);g&&(l.B=a.B.hb.children()[q].M)}for(u=0;u<c;u++){j=new Uint8Array(4*
e*f);for(o=w=0;o<e;o++)for(q=0;q<f;q++)m=k[o][q][u],a.q?((C=a.q.T.get(Math.floor(m)))||(C=a.q.T.get(a.q.T.Z()-1)),B=255*C[1],D=255*C[2],I=255*C[3],C=255*C[4]):(B=D=I=255*(m/d),C=255),E=4*w,j[E]=B,j[++E]=D,j[++E]=I,j[++E]=C,w++;b=m=new od;b.Bb=j;b.c=p;b=m;b.Fc=f;b.c=p;b=m;b.Ec=e;b.c=p;l=a.gb.children()[u];l.nd(m);g&&(l.B=a.B.gb.children()[u].M)}};function se(){me.call(this);this.className="parserSTL"}F(se,me);se.prototype.parse=function(a,b){for(var c=b.split("\n"),d=c.length,e=a.f,f=a.h,g=0,i=d%8;i--;)this.F(e,f,c[g]),g++;for(i=0.125*d^0;i--;)this.F(e,f,c[g]),g++,this.F(e,f,c[g]),g++,this.F(e,f,c[g]),g++,this.F(e,f,c[g]),g++,this.F(e,f,c[g]),g++,this.F(e,f,c[g]),g++,this.F(e,f,c[g]),g++,this.F(e,f,c[g]),g++;c=new sd;c.U=a;this.dispatchEvent(c)};
se.prototype.F=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),d=c.split(" ");if("vertex"==d[0]){var c=parseFloat(d[1]),e=parseFloat(d[2]),d=parseFloat(d[3]);a.add(c,e,d)}else"facet"==d[0]&&(c=parseFloat(d[2]),e=parseFloat(d[3]),d=parseFloat(d[4]),b.add(c,e,d),b.add(c,e,d),b.add(c,e,d))};A("X.parserSTL",se);A("X.parserSTL.prototype.parse",se.prototype.parse);function te(){me.call(this);this.className="parserVTK"}F(te,me);
te.prototype.parse=function(a,b){var c=a.f,d=a.h,e=b.split("\n"),f=e.length,g=new P,i=new P;this.P=[];this.ka=pd;this.ud=this.Sa=this.Pa=this.Ta=s;for(var k=0,o=f%8;o--;)this.F(g,i,e[k]),k++;for(o=0.125*f^0;o--;)this.F(g,i,e[k]),k++,this.F(g,i,e[k]),k++,this.F(g,i,e[k]),k++,this.F(g,i,e[k]),k++,this.F(g,i,e[k]),k++,this.F(g,i,e[k]),k++,this.F(g,i,e[k]),k++,this.F(g,i,e[k]),k++;if(this.ka==pd){e=i.length();k=f=this.P.length;do{var o=this.P[f-k],j=o.length,m;for(m=0;m<j;m++){var l=parseInt(o[m],10),
q=g.get(l);c.add(q[0],q[1],q[2]);l<e?(l=i.get(l),d.add(l[0],l[1],l[2])):(l=new Q(q[0],q[1],q[2]),l.normalize(),d.add(l.x,l.y,l.b))}k--}while(0<k)}else if("TRIANGLE_STRIPS"==this.ka){e=i.length();k=f=this.P.length;do{o=this.P[f-k];j=o.length;for(m=0;m<j;m++)l=parseInt(o[m],10),q=g.get(l),c.add(q[0],q[1],q[2]),(0==m||m==j-1)&&c.add(q[0],q[1],q[2]),l<e?(l=i.get(l),d.add(l[0],l[1],l[2]),(0==m||m==j-1)&&d.add(l[0],l[1],l[2])):(l=new Q(q[0],q[1],q[2]),l.normalize(),d.add(l.x,l.y,l.b),(0==m||m==j-1)&&d.add(l.x,
l.y,l.b));k--}while(0<k)}else if("LINES"==this.ka){e=i.length();k=f=this.P.length;do{o=this.P[f-k];j=o.length;for(m=0;m<j-1;m++){var u=parseInt(o[m],10),l=parseInt(o[m+1],10),w=g.get(u),q=g.get(l);c.add(w[0],w[1],w[2]);c.add(q[0],q[1],q[2]);u<e-1?(q=i.get(u),l=i.get(l),d.add(q[0],q[1],q[2]),d.add(l[0],l[1],l[2])):(l=new Q(w[0],w[1],w[2]),l.normalize(),d.add(l.x,l.y,l.b),l=new Q(q[0],q[1],q[2]),l.normalize(),d.add(l.x,l.y,l.b))}k--}while(0<k)}else if("POINTS"==this.ka){e=i.length();k=f=this.P.length;
do{o=this.P[f-k];j=o.length;for(m=0;m<j;m++)l=parseInt(o[m],10),q=g.get(l),c.add(q[0],q[1],q[2]),l<e?(l=i.get(l),d.add(l[0],l[1],l[2])):(l=new Q(q[0],q[1],q[2]),l.normalize(),d.add(l.x,l.y,l.b));k--}while(0<k)}else if("POLYGONS"==this.ka){e=i.length();k=f=this.P.length;do{o=this.P[f-k];j=o.length;for(m=0;m<j;m++)l=parseInt(o[m],10),q=g.get(l),c.add(q[0],q[1],q[2]),l<e?(l=i.get(l),d.add(l[0],l[1],l[2])):(l=new Q(q[0],q[1],q[2]),l.normalize(),d.add(l.x,l.y,l.b));k--}while(0<k)}a.Ya(this.ka);c=new sd;
c.U=a;this.dispatchEvent(c)};
te.prototype.F=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),c=c.split(" "),d=c.length,e=c[0];if("POINTS"==e)this.Ta=p,this.Sa=this.Pa=s;else if("VERTICES"==e)this.Pa=p,this.Sa=this.Ta=s,a=parseInt(c[1],10),3<=a?this.ka=pd:1==a?this.ka="POINTS":h(Error("VTK file not supported!")),this.P=[];else if("TRIANGLE_STRIPS"==e)this.Pa=p,this.Sa=this.Ta=s,this.ka="TRIANGLE_STRIPS",this.P=[];else if("LINES"==e)this.Pa=p,this.Sa=this.Ta=s,this.ka="LINES",this.P=[];else if("POLYGONS"==e)this.Pa=p,this.Sa=this.Ta=
s,this.ka="POLYGONS",this.P=[];else if("POINT_DATA"==e)this.Sa=p,this.Pa=this.Ta=s;else if(this.Ta)if(1==d||isNaN(parseFloat(e)))this.Ta=s;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.add(d,e,c))}else this.Pa?1==d||isNaN(parseFloat(e))?this.Pa=s:this.P.push(c.slice(1)):this.Sa&&("NORMALS"==e?this.ud=p:1==d||isNaN(parseFloat(e))?
this.ud=this.Sa=s:this.ud&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),b.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),b.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),b.add(d,e,c))))};A("X.parserVTK",te);A("X.parserVTK.prototype.parse",te.prototype.parse);function ue(){me.call(this);this.className="parserFSM"}F(ue,me);
ue.prototype.parse=function(a,b){var c=a.f,d=a.h,e=a.ue,f=new P,g;g=3;var i=0,k;do k=this.l(b,g++),i++;while(200>i&&10!=k);g++;var o=qe(this,b,g);g+=4;i=qe(this,b,g);g+=4;k=[];for(var j=0,j=0;j<o;j++){var m=ne(this,b,g);g+=4;var l=ne(this,b,g);g+=4;var q=ne(this,b,g);g+=4;k[j]=0;f.add(m,l,q)}o=[];j=[];for(m=0;m<i;m++){var u=qe(this,b,g);g+=4;q=qe(this,b,g);g+=4;l=qe(this,b,g);g+=4;k[u]+=1;k[q]+=1;k[l]+=1;o.push([u,q,l]);j.push(new Q(0,0,0))}for(m=0;m<i;m++){var u=o[m][0],q=o[m][1],l=o[m][2],w=f.get(u);
g=f.get(q);var B=f.get(l),w=new Q(w[0],w[1],w[2]),B=new Q(B[0],B[1],B[2]);g=(new Q(g[0],g[1],g[2])).d().za(w);w=B.d().za(w);g=Yc(g,w).normalize();j[u]=j[u].add(g);j[q]=j[q].add(g);j[l]=j[l].add(g)}for(m=0;m<i;m++)u=o[m][0],q=o[m][1],l=o[m][2],w=f.get(u),g=f.get(q),B=f.get(l),e.push(u),e.push(q),e.push(l),c.add(w[0],w[1],w[2]),c.add(g[0],g[1],g[2]),c.add(B[0],B[1],B[2]),u=j[u].scale(1/k[u]).normalize(),q=j[q].scale(1/k[q]).normalize(),l=j[l].scale(1/k[l]).normalize(),d.add(u.x,u.y,u.b),d.add(q.x,q.y,
q.b),d.add(l.x,l.y,l.b);a.Ya(pd);c=new sd;c.U=a;this.dispatchEvent(c)};A("X.parserFSM",ue);A("X.parserFSM.prototype.parse",ue.prototype.parse);function ve(a){function b(){zb+=8;return rc<R.length?R.charCodeAt(rc++)&255:-1}function c(){var a;zb++;a=ya&1;ya>>=1;0==ya&&(ya=b(),a=ya&1,ya=ya>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=Z[b]>>8-a);return b}function e(a){za++;I[C++]=a;q.push(String.fromCharCode(a));32768==C&&(C=0)}function f(){this.Xa=this.Wa=0;this.Zc=r;this.Xe=-1}function g(){for(;;){if(N[H]>=Va)return-1;if(ia[N[H]]==H)return N[H]++;N[H]++}}function i(){var a=kb[lb],b;u&&document.write("<br>len:"+H+" treepos:"+
lb);if(17==H)return-1;lb++;H++;b=g();u&&document.write("<br>IsPat "+b);if(0<=b)a.Wa=b,u&&document.write("<br>b0 "+a.Wa);else if(a.Wa=32768,u&&document.write("<br>b0 "+a.Wa),i())return-1;b=g();if(0<=b)a.Xa=b,u&&document.write("<br>b1 "+a.Xa),a.Zc=r;else if(a.Xa=32768,u&&document.write("<br>b1 "+a.Xa),a.Zc=kb[lb],a.Xe=lb,i())return-1;H--;return 0}function k(a,b,c){u&&document.write("currentTree "+a+" numval "+b+" lengths "+c+" show 0");kb=a;lb=0;ia=c;Va=b;for(a=0;17>a;a++)N[a]=0;H=0;if(i())return u&&
window.console.log("invalid huffman tree\n"),-1;if(u){document.write("<br>Tree: "+kb.length);for(a=0;32>a;a++)document.write("Places["+a+"].b0="+kb[a].Wa+"<br>"),document.write("Places["+a+"].b1="+kb[a].Xa+"<br>")}return 0}function o(a){for(var b,d,e=0,f=a[e];;)if(b=c(),u&&document.write("b="+b),b){if(!(f.Xa&32768))return u&&document.write("ret1"),f.Xa;f=f.Zc;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Wa&32768))return u&&document.write("ret2"),f.Wa;e++;f=a[e]}}function j(){var a,
g,i,l;do{a=c();g=d(2);switch(g){case 0:u&&window.console.log("Stored\n");break;case 1:u&&window.console.log("Fixed Huffman codes\n");break;case 2:u&&window.console.log("Dynamic Huffman codes\n");break;case 3:u&&window.console.log("Reserved block type!!\n");break;default:u&&window.console.log("Unexpected value %d!\n",g)}if(0==g){var m;ya=1;m=b();m|=b()<<8;g=b();g|=b()<<8;for((m^~g)&65535&&document.write("BlockLen checksum mismatch\n");m--;)g=b(),e(g)}else if(1==g)for(var j;;)if(j=Z[d(7)]>>1,23<j?(j=
j<<1|c(),199<j?(j-=128,j=j<<1|c()):(j-=48,143<j&&(j+=136))):j+=256,256>j)e(j);else if(256==j)break;else{j-=257;l=d(da[j])+ea[j];j=Z[d(5)]>>3;8<V[j]?(m=d(8),m|=d(V[j]-8)<<8):m=d(V[j]);m+=ja[j];for(j=0;j<l;j++)g=I[C-m&32767],e(g)}else if(2==g){var q=Array(320);g=257+d(5);m=1+d(5);i=4+d(4);for(j=0;19>j;j++)q[j]=0;for(j=0;j<i;j++)q[oa[j]]=d(3);l=sa.length;for(i=0;i<l;i++)sa[i]=new f;if(k(sa,19,q)){C=0;return}if(u){document.write("<br>distanceTree");for(j=0;j<sa.length;j++)document.write("<br>"+sa[j].Wa+
" "+sa[j].Xa+" "+sa[j].Zc+" "+sa[j].Xe)}l=g+m;i=0;var w=-1;for(u&&document.write("<br>n="+l+" bits: "+zb+"<br>");i<l;)if(w++,j=o(sa),u&&document.write("<br>"+w+" i:"+i+" decode: "+j+"    bits "+zb+"<br>"),16>j)q[i++]=j;else if(16==j){var B;j=3+d(2);if(i+j>l){C=0;return}for(B=i?q[i-1]:0;j--;)q[i++]=B}else{j=17==j?3+d(3):11+d(7);if(i+j>l){C=0;return}for(;j--;)q[i++]=0}l=Ab.length;for(i=0;i<l;i++)Ab[i]=new f;if(k(Ab,g,q)){C=0;return}l=Ab.length;for(i=0;i<l;i++)sa[i]=new f;j=[];l=q.length;for(i=g;i<l;i++)j[i-
g]=q[i];if(k(sa,m,j)){C=0;return}for(u&&document.write("<br>literalTree");;)if(j=o(Ab),256<=j){j-=256;if(0==j)break;j--;l=d(da[j])+ea[j];j=o(sa);8<V[j]?(m=d(8),m|=d(V[j]-8)<<8):m=d(V[j]);for(m+=ja[j];l--;)g=I[C-m&32767],e(g)}else e(j)}}while(!a);C=0;ya=1}function m(){u&&window.console.log("NEXTFILE");q=[];var a=[];E=s;a[0]=b();a[1]=b();u&&window.console.log("type: "+a[0]+" "+a[1]);120==a[0]&&218==a[1]&&(u&&window.console.log("GEONExT-GZIP"),j(),u&&window.console.log(q.join("")),D[B]=Array(2),D[B][0]=
q.join(""),D[B][1]="geonext.gxt",B++);31==a[0]&&139==a[1]&&(u&&window.console.log("GZIP"),l(),u&&window.console.log(q.join("")),D[B]=Array(2),D[B][0]=q.join(""),D[B][1]="file",B++);if(80==a[0]&&75==a[1]&&(E=p,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u&&window.console.log("ZIP-Version: "+a[1]+" "+a[0]/10+"."+a[0]%10);w=b();w|=b()<<8;u&&window.console.log("gpflags: "+w);a=b();a|=b()<<8;u&&window.console.log("method: "+a);b();b();b();b();var c=b(),c=c|b()<<8,c=c|b()<<16,c=c|b()<<24,d=b(),
d=d|b()<<8,d=d|b()<<16,d=d|b()<<24,e=b(),e=e|b()<<8,e=e|b()<<16,e=e|b()<<24;u&&window.console.log("local CRC: "+c+"\nlocal Size: "+e+"\nlocal CompSize: "+d);c=b();c|=b()<<8;d=b();d|=b()<<8;u&&window.console.log("filelen "+c);e=0;for(Xa=[];c--;){var f=b();"/"==f|":"==f?e=0:e<Vc-1&&(Xa[e++]=String.fromCharCode(f))}u&&window.console.log("nameBuf: "+Xa);Wc||(Wc=Xa);for(e=0;e<d;)b(),e++;za=0;8==a&&(j(),u&&window.console.log(q.join("")),D[B]=Array(2),D[B][0]=q.join(""),D[B][1]=Xa.join(""),B++);l()}}function l(){var a=
[],c;w&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b(),u&&window.console.log("CRC:"));E&&m();a[0]=b();if(8!=a[0])u&&window.console.log("Unknown compression method!");else{w=b();u&&w&-32&&window.console.log("Unknown flags set!");b();b();b();b();b();b();if(w&4){a[0]=b();a[2]=b();H=a[0]+256*a[1];u&&window.console.log("Extra field size: "+H);for(a=0;a<H;a++)b()}if(w&8){a=0;for(Xa=[];c=b();){if("7"==c||":"==c)a=0;a<Vc-1&&(Xa[a++]=
c)}u&&window.console.log("original file name: "+Xa)}if(w&16)for(;b(););w&2&&(b(),b());j();b();b();b();b();b();b();b();b();E&&m()}}var q=[],u=s,w,B=0,D=[],I=Array(32768),C=0,E=s,za,Z=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,
90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,
231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],ea=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],da=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ja=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],V=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],oa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=a,
rc=0,ya=1,zb=0,Vc=256,Xa=[],Wc,Ab=Array(288),sa=Array(32),lb=0,kb=r,H=0,N=Array(17);N[0]=0;var ia,Va;ve.prototype.Nf=function(){u&&window.console.log(R);m();return D}};function we(){me.call(this);this.className="parserNRRD"}F(we,me);
we.prototype.parse=function(a,b){var c=0,d=b.match(/^([\s\S]*?)\r?\n\r?\n/),c=d[0].length,e,f,g,i,k,o,d=d[1].split(/\r?\n/);for(k=0,o=d.length;k<o;k++)if(e=d[k],e.match(/NRRD\d+/))this.xg=p;else if(!e.match(/^#/)&&(i=e.match(/(.*):(.*)/)))f=i[1].trim(),e=i[2].trim(),(g=this.kg[f])?g.call(this,e):this[f]=e;this.xg||h(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&h(Error("Only raw or gz/gzip encoding is allowed"));if(!this.ia&&(this.ia=[new Q(1,0,0),
new Q(0,1,0),new Q(0,0,1)],this.le)){d=[];for(i=0;2>=i;i++)d.push(!isNaN(this.le[i])?this.ia[i].scale(this.le[i]):n)}i=0;i="gzip"==this.encoding||"gz"==this.encoding?(new ve(b.substr(c))).Nf()[0][0]:b.substr(c);c=this.wb[0]*this.wb[1]*this.wb[2];d=Array(c);k=-Infinity;o=Infinity;for(e=0;e<c;e++)f=this.fd(i,0+e*this.ed),d[e]=f,k=Math.max(k,f),o=Math.min(o,f);a.S=[this.wb[0],this.wb[1],this.wb[2]];a.H=[(new Q(this.ia[0][0],this.ia[0][1],this.ia[0][2])).sb(),(new Q(this.ia[1][0],this.ia[1][1],this.ia[1][2])).sb(),
(new Q(this.ia[2][0],this.ia[2][1],this.ia[2][2])).sb()];a.Ha=[o,k];a.ne(o,k);a.sa();re(a,d,this.wb,k);c=new sd;c.U=a;this.dispatchEvent(c)};
we.prototype.kg={type:function(a){switch(a){case "unsigned char":case "uint8":this.fd=this.l;this.ed=1;break;case "signed char":case "int8":this.fd=this.gh;this.ed=1;break;case "short":case "signed short":case "unsigned short":case "short int":case "int16":this.fd=this.gd;this.ed=2;break;case "int":case "int32":break;case "float":this.fd=this.nc;this.ed=4;break;default:h(Error("Only short/int/int8/float data is allowed. Found "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=
a},dimension:function(a){return parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.wb=e},"space directions":function(a){var b,c,d;c=a.match(/\(.*?\)/g);return this.ia=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);
var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.le=e}};A("X.parserNRRD",we);A("X.parserNRRD.prototype.parse",we.prototype.parse);function xe(a){x(a)||h(Error("Invalid data."));M.call(this);this.className="parserHelper";this.se=a;this.yc=0;this.Nh=this.cb=1;this.Ph=2;this.Ff=this.Oh=4}F(xe,M);xe.prototype.tb=aa();xe.prototype.data=t("se");function $(a,b){x(b)||(b=1);var c=a.tb(a.se,a.yc,b)[0];a.yc+=a.cb*b;return 1==b?c[0]:c};function ye(){me.call(this);this.className="parserMGZ"}F(ye,me);
ye.prototype.parse=function(a,b,c){var d=0,e=d=c?(new ve(b.substr(0))).Nf()[0][0]:b.substr(0),f=d=c=0,g=0,i=0,k=[[0,0,0,0],[0,0,0,0],[0,0,0,0]],b=[],o=[],i=r,j,i={value:0,name:"uchar",size:1,Pc:this.sf.bind(this)},m={value:1,name:"int",size:4,Pc:this.uf.bind(this)},l={value:3,name:"float",size:4,Pc:this.ce.bind(this)},q={value:4,name:"short",size:2,Pc:this.tf.bind(this)},o=256,e=new xe(e),c=this.uf.bind(this),d=e.Oh;e.tb=c;e.cb=d;$(e);c=$(e);d=$(e);f=$(e);$(e);g=$(e);switch(g){case 0:j=i;break;case 1:j=
m;break;case 3:j=l;break;case 4:j=q}$(e);i=this.tf.bind(this);m=e.Ph;e.tb=i;e.cb=m;i=$(e);o-=2;0<i&&(i=this.ce.bind(this),m=e.Ff,e.tb=i,e.cb=m,o-=60,b[0]=$(e),b[1]=$(e),b[2]=$(e),k[0][0]=$(e),k[1][0]=$(e),k[2][0]=$(e),k[0][1]=$(e),k[1][1]=$(e),k[2][1]=$(e),k[0][2]=$(e),k[1][2]=$(e),k[2][2]=$(e),k[0][3]=$(e),k[1][3]=$(e),k[2][3]=$(e));k=this.sf.bind(this);i=e.Nh;e.tb=k;e.cb=i;$(e,o);k=j.size;e.tb=j.Pc;e.cb=k;o=$(e,c*d*f);e.yc+16<e.data().length&&(j=this.ce.bind(this),k=e.Ff,e.tb=j,e.cb=k,$(e),$(e),
$(e),$(e));j=o;e={Jg:0,$h:0,gg:0,nh:1,Rh:0,min:0,Ng:0,max:0,Hg:0};k=j.length;e.size=k;l=0;l=1;i=0;for(m=k;0<=m;m--)i+=j[m],l*=j[m],e.min>=j[m]&&(e.min=j[m],e.Ng=m),e.max<=j[m]&&(e.max=j[m],e.Hg=m);e.nh=l;e.Rh=i;for(l=e.Jg=i/k,m=k,i=0;m--;i+=Math.pow(j[m]-l,2));i=(e.gg=Math.sqrt(e.$h=i/k),e);c=[c,d,f];a.S=c;a.H=b;b=i.min;d=i.max;a.Ha=[b,d];a.ne(b,d);a.sa();re(a,o,c,d);b=new sd;b.U=a;this.dispatchEvent(b)};A("X.parserMGZ",ye);A("X.parserMGZ.prototype.parse",ye.prototype.parse);function ze(){me.call(this);this.className="parserCRV"}F(ze,me);
ze.prototype.parse=function(a,b){var c=a.ue;0==c.length&&h(Error("No _pointIndices defined on the X.object."));var d=0,e=(this.l(b,d)<<16)+(this.l(b,d+1)<<8)+this.l(b,d+2)&16777215,d=d+3;if(16777215!=e)alert("Can't load curvature file, invalid magic number.");else{var e=qe(this,b,d),d=d+4+4+4,f=0,g=0,i=0,k=0,o=0,j=0,m=0,l=0,q=0,u=0,w=0,B=Array(e),D=Array(2),I=Array(2),C;for(C=0;C<e;C++){var E=ne(this,b,d),d=d+4;0==C&&(D[0]=I[0]=E);0<=E?(f++,k+=E):(g++,i+=E);q+=E;w++;I[0]=Math.max(E,I[0]);D[0]=Math.min(E,
D[0]);B[C]=E}0!=f&&(o=k/f);0!=g&&(j=i/g);0!=w&&(u=q/w);for(d=q=i=k=0;d<e;d++)E=B[d],w=0,0<=E?(w=Math.pow(E-o,2),k+=w):(w=Math.pow(E-j,2),i+=w),w=Math.pow(E-u,2),q+=w;1<f&&(m=Math.sqrt(k/(f-1)));1<g&&(l=Math.sqrt(i/(g-1)));D[1]=j-2.5*l;I[1]=o+2.5*m;g=c.length;f=[];for(d=0;d<g;d++)i=c[d],i>e&&h(Error("Could not find scalar for vertex.")),i=B[i],f.push(i),f.push(i),f.push(i);a.o.Dc=D[1];a.o.Cc=I[1];a.o._minThreshold=D[1];a.o._maxThreshold=I[1];a.o.u=B;c=a.o;c.Bc=f;c.c=p;c=new sd;c.U=a;this.dispatchEvent(c)}};
A("X.parserCRV",ze);A("X.parserCRV.prototype.parse",ze.prototype.parse);function Ae(){me.call(this);this.className="parserTRK"}F(Ae,me);
Ae.prototype.parse=function(a,b){var c=a.f,d=a.h,e=a.ja,f=0,g=f+6,i=0,k=Infinity,o;for(o=0;3>o;o++)var j=this.gd(b,g+2*o),i=Math.max(i,j),k=Math.min(k,j);var m=oe(this,b,f+12,3)[0];oe(this,b,f+24,3);var l=this.gd(b,f+36),q=this.gd(b,f+238);oe(this,b,f+440,16);oe(this,b,f+956,6);g=pe(this,b,f+988);f=pe(this,b,f+996);i=[];k=[];o=Infinity;var j=-Infinity,u=r,w=r,B=r,D=r,I=r,C=r,E;for(E=0;E<g;E++){for(var za=pe(this,b,f),Z=new P,ea=0,f=f+4,da=0;da<za;da++){var ja=this.nc(b,f),f=f+4,V=this.nc(b,f),f=f+
4,oa=this.nc(b,f),f=f+4,R=r;0<l&&(oe(this,b,f,l),f+=4*l);ja/=m[0];V/=m[1];oa/=m[2];Z.add(ja,V,oa);0<da&&(R=Z.get(da-1),ea+=Math.sqrt(Math.pow(ja-R[0],2)+Math.pow(V-R[1],2)+Math.pow(oa-R[2],2)))}0<q&&(f+=4*q);da=Z.Ea;R=Z.Ba;za=Z.Fa;ja=Z.Ca;V=Z.Ga;oa=Z.Da;if(!u||da<u)u=da;if(!w||R>w)w=R;if(!B||za<B)B=za;if(!D||ja>D)D=ja;if(!I||V<I)I=V;if(!C||oa>C)C=oa;i.push(Z);k.push(ea)}f=(u+w)/2;B=(B+D)/2;C=(I+C)/2;I=[];for(E=0;E<g;E++){D=i[E];m=D.count();ea=k[E];o=Math.min(o,ea);j=Math.max(j,ea);for(da=0;da<m-1;da++)q=
D.get(da),l=D.get(da+1),c.add(q[0],q[1],q[2]),c.add(l[0],l[1],l[2]),u=q[0]-f,w=q[1]-B,Z=q[2]-C,R=Math.sqrt(u*u+w*w+Z*Z),za=l[0]-f,ja=l[1]-B,V=l[2]-C,oa=Math.sqrt(za*za+ja*ja+V*V),d.add(u/R,w/R,Z/R),d.add(za/oa,ja/oa,V/oa),l=[Math.abs(l[0]-q[0]),Math.abs(l[1]-q[1]),Math.abs(l[2]-q[2])],q=Math.sqrt(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]),l[0]/=q,l[1]/=q,l[2]/=q,e.add(l[0],l[1],l[2]),e.add(l[0],l[1],l[2]),I.push(ea),I.push(ea),I.push(ea),I.push(ea),I.push(ea),I.push(ea)}a.Ya("LINES");R=new nd;R.Dc=o;R.Cc=j;R._minThreshold=
o;R._maxThreshold=j;c=R;c.Bc=I;c.c=p;R.we=s;a.o=R;c=new sd;c.U=a;this.dispatchEvent(c)};A("X.parserTRK",Ae);A("X.parserTRK.prototype.parse",Ae.prototype.parse);function Be(){me.call(this);this.className="parserLUT"}F(Be,me);Be.prototype.parse=function(a,b,c){var b=b.split("\n"),d=b.length,e;for(e=0;e<d;++e){var f=b[e],f=f.replace(/^\s+|\s+$/g,"");"#"!=f[0]&&(f=f.split(" "),f=f.filter(function(a){return""!=a}),6==f.length&&(f[2]=parseInt(f[2],10)/255,f[3]=parseInt(f[3],10)/255,f[4]=parseInt(f[4],10)/255,f[5]=parseInt(f[5],10)/255,c.add(parseInt(f[0],10),f[1],f[2],f[3],f[4],f[5],10)))}c=new sd;c.U=a;this.dispatchEvent(c)};A("X.parserLUT",Be);
A("X.parserLUT.prototype.parse",Be.prototype.parse);function Ce(){M.call(this);this.className="loader";this.Wb=r;this.Xb=0}F(Ce,M);function De(a){x(a.Wb)||(a.Wb=new Mb);return a.Wb}v=Ce.prototype;v.Bg=function(a){Ee(this,1.7);setTimeout(function(){Jc(a.M.file());a.va();De(this).set(a.id(),p)}.bind(this),100)};
function Fe(a,b){x(b.file())||h(Error("Internal error during file loading."));var c=De(a),d=b.id();Ob(c.r,d)||(b.f.clear(),b.h.clear(),c=b.file().path(),d=c.split(".").pop(),d=d.toUpperCase(),d==Ge||d==He||d==Ie||d==Je||d==Ke||d==Le||d==Me||h(Error("The "+d+" file format is not supported.")),d=new XMLHttpRequest,K(d,"abort",a.Ib.bind(a,d,b)),K(d,"error",a.Ib.bind(a,d,b)),K(d,"load",a.zg.bind(a,d,b)),d.open("GET",c,p),d.overrideMimeType("text/plain; charset=x-user-defined"),d.setRequestHeader("Content-Type",
"text/plain"),d.send(r),De(a).set(b.id(),s))}function Ee(a,b){a.Xb+=b/De(a).Z()/3;1<a.Xb&&(a.Xb=1);var c=new Md;c.xe=a.Xb;a.dispatchEvent(c)}v.Ib=function(){h(Error("Could not get the file."))};v.yg=function(a,b){setTimeout(function(){var c=new Be;sc(c,yc,this.fh.bind(this));c.parse(b,a.response,b.q)}.bind(this),100)};
v.Ag=function(a,b){setTimeout(function(){if("crv"==b.o.file().path().split(".").pop().toLowerCase()){var c=new ze;sc(c,yc,this.hh.bind(this));c.parse(b,a.response)}else h(Error("Only .CRV files supported."))}.bind(this),100)};
v.zg=function(a,b){Ee(this,1);setTimeout(function(){var c=b.file().path().split(".").pop().toLowerCase();if("stl"==c)c=new se,sc(c,yc,this.Lb.bind(this)),c.parse(b,a.response);else if("vtk"==c)c=new te,sc(c,yc,this.Lb.bind(this)),c.parse(b,a.response);else if("trk"==c)c=new Ae,sc(c,yc,this.Lb.bind(this)),c.parse(b,a.response);else if("fsm"==c)c=new ue,sc(c,yc,this.Lb.bind(this)),c.parse(b,a.response);else if("nrrd"==c)c=new we,sc(c,yc,this.Lb.bind(this)),c.parse(b,a.response);else if("mgh"==c||"mgz"==
c){var d=new ye;sc(d,yc,this.Lb.bind(this));d.parse(b,a.response,"mgz"==c)}}.bind(this),100)};v.Lb=function(a){Ee(this,1);setTimeout(function(){var b=a.U;Jc(b.file());b.va();De(this).set(b.id(),p)}.bind(this),100)};v.hh=function(a){setTimeout(function(){var b=a.U;Jc(b.o.file());b.va();De(this).set(b.o.id(),p)}.bind(this),100)};v.fh=function(a){setTimeout(function(){var b=a.U;Jc(b.q.file());b.va();De(this).set(b.q.id(),p)}.bind(this),100)};
var He="STL",Je="VTK",Ge="TRK",Ie="FSM",Ke="NRRD",Le="MGH",Me="MGZ";var Ne=ca.window;function Oe(a,b,c){ma(a)?c&&(a=wa(a,c)):a&&"function"==typeof a.handleEvent?a=wa(a.handleEvent,a):h(Error("Invalid listener argument"));return 2147483647<b?-1:Ne.setTimeout(a,b||0)};function le(a){Y.call(this);this.className="labelMap";this.Ja=a}F(le,Y);le.prototype.va=function(){var a=new sd;a.U=this;this.dispatchEvent(a);this.Ja.va()};A("X.labelMap",le);function Pe(a,b){(!z(a)||!z(b))&&h(Error("A camera needs valid width and height values."));M.call(this);this.className="camera";this.position=new Q(0,0,100);this.focus=new Q(0,0,0);this.up=new Q(0,1,0);this.view=this.bd(this.position,this.focus);this.qb=new Float32Array(this.view.I())}F(Pe,M);v=Pe.prototype;v.Xd=function(a){(!x(a)||!(a instanceof ge))&&h(Error("Could not observe the interactor."));K(a,ud,this.ah.bind(this));K(a,wd,this.eh.bind(this))};
v.eh=function(a){a instanceof Fd||h(Error("Received no valid zoom event."));a.fb?this.Of(a.Oa):this.Pf(a.Oa)};v.ah=function(a){a instanceof Dd||h(Error("Received no valid pan event."));this.qf(a.G)};v.Jh=function(a){(!x(a)||!(a instanceof T))&&h(Error("Invalid view matrix."));this.view=a;this.qb=new Float32Array(this.view.I())};v.md=function(a,b,c){(!z(a)||!z(b)||!z(c))&&h(Error("The position was invalid."));this.position=new Q(a,b,c);this.reset()};
v.Ch=function(a,b,c){(!z(a)||!z(b)||!z(c))&&h(Error("The focus was invalid."));this.focus=new Q(a,b,c);this.reset()};v.Ih=function(a,b,c){(!z(a)||!z(b)||!z(c))&&h(Error("The up-vector was invalid."));this.up=new Q(a,b,c);this.reset()};v.reset=function(){this.view=this.bd(this.position,this.focus);this.qb=new Float32Array(this.view.I())};
v.qf=function(a){a instanceof ad||h(Error("Invalid distance vector for pan operation."));a=new Q(-a.x,a.y,0);a=kd(4).translate(a);this.view=new T(a.multiply(this.view));this.qb=new Float32Array(this.view.I());this.dispatchEvent(new Id)};v.Of=function(a){var b=20;x(a)&&!a&&(b=1);a=new Q(0,0,b);a=kd(4).translate(a);this.view=new T(a.multiply(this.view));this.qb=new Float32Array(this.view.I());this.dispatchEvent(new Id)};
v.Pf=function(a){var b=30;x(a)&&!a&&(b=1);a=new Q(0,0,-b);a=kd(4).translate(a);this.view=new T(a.multiply(this.view));this.qb=new Float32Array(this.view.I());this.dispatchEvent(new Id)};v.bd=function(a,b){(!(a instanceof Q)||!(b instanceof Q))&&h(Error("3D vectors required for calculating the view."));return kd(4)};A("X.camera",Pe);A("X.camera.prototype.setView",Pe.prototype.Jh);A("X.camera.prototype.setPosition",Pe.prototype.md);A("X.camera.prototype.setFocus",Pe.prototype.Ch);
A("X.camera.prototype.setUp",Pe.prototype.Ih);A("X.camera.prototype.pan",Pe.prototype.qf);A("X.camera.prototype.zoomIn",Pe.prototype.Of);A("X.camera.prototype.zoomOut",Pe.prototype.Pf);function Qe(a){ge.call(this,a);this.className="interactor3D"}F(Qe,ge);Qe.prototype.mc=function(a){Qe.g.mc.call(this,a);var b=new Fd;x(a.Gb)||(a.Gb=0);b.fb=0>a.Gb;b.Oa=p;this.dispatchEvent(b)};function Re(a){M.call(this);this.className="array";this.u=[];this.re=a}F(Re,M);Re.prototype.add=function(a){this.u.push(a);return p};Re.prototype.clear=function(){this.u.length=0};function Se(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Se(a,b,d);for(Se(a,d,c);b<d;++b)if(0<a.re(a.u[b],a.u[d])){var e=a.u[b];a.u[b]=a.u[d];for(var f=a,g=d,i=c;g+1<i&&0>f.re(f.u[g+1],e);){var k=f,o=g+1,j=k.u[g];k.u[g]=k.u[o];k.u[o]=j;++g}f.u[g]=e}}}Re.prototype.sort=function(){Se(this,0,this.u.length)};function Te(a,b){Pe.call(this,a,b);this.className="camera2D"}F(Te,Pe);function Ue(a,b){Pe.call(this,a,b);this.className="camera3D";this.lg=45;var c=Float32Array,d;d=a/b;var e=1*Math.tan(this.lg*Math.PI/360),f=-e;d=new T([[2/(e*d-f*d),0,(e*d+f*d)/(e*d-f*d),0],[0,2/(e-f),(e+f)/(e-f),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.ih=new c(d.I())}F(Ue,Pe);Ue.prototype.Xd=function(a){Ue.g.Xd.call(this,a);K(a,vd,this.dh.bind(this))};Ue.prototype.dh=function(a){a instanceof Ed||h(Error("Received no valid rotate event."));this.rotate(a.G)};
Ue.prototype.rotate=function(a){a instanceof Array&&2==a.length?a=new ad(a[0],a[1]):a instanceof ad||h(Error("Invalid distance vector for rotate operation."));var b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=kd(4),d=new Q(parseFloat(this.view.C(0,0)),parseFloat(this.view.C(0,1)),parseFloat(this.view.C(0,2))),b=c.rotate(b,new Q(parseFloat(this.view.C(1,0)),parseFloat(this.view.C(1,1)),parseFloat(this.view.C(1,2)))),a=c.rotate(a,d);this.view=new T(this.view.multiply(a.multiply(b)));this.qb=new Float32Array(this.view.I());
this.dispatchEvent(new Id)};Ue.prototype.bd=function(a,b){Ue.g.bd.call(this,a,b);var c=kd(4),d=new Q(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.up.d();e.Zb(d)&&(e.b+=1.0E-6);var f=Yc(e,d),e=Yc(d,f),f=f.normalize(),e=e.normalize();S(c,0,0,f.x);S(c,0,1,f.y);S(c,0,2,f.b);S(c,0,3,0);S(c,1,0,e.x);S(c,1,1,e.y);S(c,1,2,e.b);S(c,1,3,0);S(c,2,0,d.x);S(c,2,1,d.y);S(c,2,2,d.b);S(c,2,3,0);S(c,3,0,0);S(c,3,1,0);S(c,3,2,0);S(c,3,3,1);d=a.d();return c.translate(d.J())};A("X.camera3D",Ue);
A("X.camera3D.prototype.rotate",Ue.prototype.rotate);function Ve(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Ve.prototype.d=function(){return new Ve(this.top,this.right,this.bottom,this.left)};Ve.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};Ve.prototype.contains=function(a){return!this||!a?s:a instanceof Ve?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function We(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}v=We.prototype;v.d=function(){return new We(this.left,this.top,this.width,this.height)};v.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};
v.Ve=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,p}return s};v.contains=function(a){return a instanceof We?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
v.$=function(){return new bd(this.width,this.height)};function Xe(a,b){var c=Ud(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,r))?c[b]||c.getPropertyValue(b):""}function Ye(a,b){return a.currentStyle?a.currentStyle[b]:r}function Ze(a,b){return Xe(a,b)||Ye(a,b)||a.style&&a.style[b]}function $e(a){a=a?9==a.nodeType?a:Ud(a):document;return G&&!nb(9)&&!ee(Sd(a))?a.body:a.documentElement}
function af(a){var b=a.getBoundingClientRect();G&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function bf(a){if(G&&!nb(8))return a.offsetParent;for(var b=Ud(a),c=Ze(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=Ze(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return r}
function cf(a){for(var b=new Ve(0,Infinity,Infinity,0),c=Sd(a),d=c.A.body,e=c.A.documentElement,f=!J&&"CSS1Compat"==c.A.compatMode?c.A.documentElement:c.A.body;a=bf(a);)if((!G||0!=a.clientWidth)&&(!J||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=Ze(a,"overflow")){var g=df(a),i;i=a;if(Ua&&!jb("1.9")){var k=parseFloat(Xe(i,"borderLeftWidth"));if(ef(i))var o=i.offsetWidth-i.clientWidth-k-parseFloat(Xe(i,"borderRightWidth")),k=k+o;i=new Zc(k,parseFloat(Xe(i,"borderTopWidth")))}else i=new Zc(i.clientLeft,
i.clientTop);g.x+=i.x;g.y+=i.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.A.parentWindow||c.A.defaultView||window;e=c.document;J&&!jb("500")&&!Ya?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new bd(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new bd(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:r}
function df(a){var b,c=Ud(a),d=Ze(a,"position"),e=Ua&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Zc(0,0),g=$e(c);if(a==g)return f;if(a.getBoundingClientRect)b=af(a),a=fe(Sd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(J&&"fixed"==Ze(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Ta||J&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=bf(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Ta||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function ff(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function gf(a){if("none"!=Ze(a,"display"))return hf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=hf(a);b.display=c;b.position=e;b.visibility=d;return a}function hf(a){var b=a.offsetWidth,c=a.offsetHeight,d=J&&!b&&!c;return(!ha(b)||d)&&a.getBoundingClientRect?(a=af(a),new bd(a.right-a.left,a.bottom-a.top)):new bd(b,c)}function jf(a,b){a.style.display=b?"":"none"}function ef(a){return"rtl"==Ze(a,"direction")}
function kf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var lf={thin:2,medium:4,thick:6};function mf(a,b){if("none"==Ye(a,b+"Style"))return 0;var c=Ye(a,b+"Width");return c in lf?lf[c]:kf(a,c)};function nf(a){this.na=a;this.p=[]}F(nf,Ub);var of=[];function pf(a,b,c,d,e){ka(c)||(of[0]=c,c=of);for(var f=0;f<c.length;f++)a.p.push(K(b,c[f],d||a,e||s,a.na||a))}nf.prototype.hd=function(){vb(this.p,uc);this.p.length=0};nf.prototype.z=function(){nf.g.z.call(this);this.hd()};nf.prototype.handleEvent=function(){h(Error("EventHandler.handleEvent not implemented"))};function qf(){}(function(a){a.Le=function(){return a.vg||(a.vg=new a)}})(qf);qf.prototype.Ud=0;qf.Le();function rf(a){this.ta=a||Sd()}F(rf,Ic);v=rf.prototype;v.ug=qf.Le();v.Se=r;v.rb=s;v.j=r;v.Kb=r;v.Eb=r;v.Yb=r;v.di=s;v.e=t("j");v.ge=function(a){this.Kb&&this.Kb!=a&&h(Error("Method not supported"));rf.g.ge.call(this,a)};v.Qc=t("ta");v.Fb=function(){this.j=this.ta.createElement("div")};v.Ob=function(a){this.ha(a)};v.ha=function(a,b){this.rb&&h(Error("Component already rendered"));this.j||this.Fb();a?a.insertBefore(this.j,b||r):this.ta.A.body.appendChild(this.j);(!this.Kb||this.Kb.rb)&&this.Oc()};
v.Oc=function(){this.rb=p;sf(this,function(a){!a.rb&&a.e()&&a.Oc()})};v.ac=function(){sf(this,function(a){a.rb&&a.ac()});this.Uc&&this.Uc.hd();this.rb=s};v.z=function(){rf.g.z.call(this);this.rb&&this.ac();this.Uc&&(this.Uc.ma(),delete this.Uc);sf(this,function(a){a.ma()});!this.di&&this.j&&be(this.j);this.Kb=this.j=this.Yb=this.Eb=r};v.Wc=function(){return!!this.Eb&&0!=this.Eb.length};function sf(a,b){a.Eb&&vb(a.Eb,b,n)}
v.removeChild=function(a,b){if(a){var c=y(a)?a:a.Se||(a.Se=":"+(a.ug.Ud++).toString(36)),a=this.Yb&&c?(c in this.Yb?this.Yb[c]:n)||r:r;if(c&&a){var d=this.Yb;c in d&&delete d[c];Bb(this.Eb,a);b&&(a.ac(),a.j&&be(a.j));c=a;c==r&&h(Error("Unable to set parent component"));c.Kb=r;rf.g.ge.call(c,r)}}a||h(Error("Child is not in parent component"));return a};function tf(){}F(tf,Ic);v=tf.prototype;v.pe=0;v.lc=0;v.Rd=100;v.Je=0;v.me=1;v.wg=s;v.Og=s;v.od=function(a){a=uf(this,a);this.pe!=a&&(this.pe=a+this.Je>this.Rd?this.Rd-this.Je:a<this.lc?this.lc:a,!this.wg&&!this.Og&&this.dispatchEvent("change"))};v.Tc=function(){return uf(this,this.pe)};v.Sc=function(){return uf(this,this.lc)};v.Rc=function(){return uf(this,this.Rd)};function uf(a,b){return a.me==r?b:a.lc+Math.round((b-a.lc)/a.me)*a.me};function vf(a){this.ta=a||Sd();this.Mb=new tf;K(this.Mb,"change",this.rg,s,this)}F(vf,rf);var wf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};v=vf.prototype;v.Fb=function(){this.pa=this.Qc().Fb("div","progress-bar-thumb");var a=wf[this.pf];this.j=this.Qc().Fb("div",a,this.pa);xf(this);this.e().setAttribute("aria-valuemin",this.Sc());this.e().setAttribute("aria-valuemax",this.Rc())};
v.Oc=function(){vf.g.Oc.call(this);G&&7>bb&&K(this.e(),"resize",this.sd,s,this);this.sd();var a=this.e();a.setAttribute("role","progressbar");a.Pi="progressbar";this.e().setAttribute("aria-live","polite")};v.ac=function(){vf.g.ac.call(this);yf(this)};function yf(a){G&&7>bb&&tc(a.e(),"resize",a.sd,s,a)}v.Tc=function(){return this.Mb.Tc()};v.od=function(a){this.Mb.od(a);this.e()&&xf(this)};function xf(a){var b=a.Tc();a.e().setAttribute("aria-valuenow",b)}v.Sc=function(){return this.Mb.Sc()};v.Rc=function(){return this.Mb.Rc()};
v.pf="horizontal";v.rg=function(){this.sd();this.dispatchEvent("change")};v.sd=function(){if(this.pa){var a=this.Sc(),b=this.Rc(),a=(this.Tc()-a)/(b-a),b=Math.round(100*a);"vertical"==this.pf?G&&7>bb?(this.pa.style.top=0,this.pa.style.height="100%",b=this.pa.offsetHeight,a=Math.round(a*b),this.pa.style.top=b-a+"px",this.pa.style.height=a+"px"):(this.pa.style.top=100-b+"%",this.pa.style.height=b+"%"):this.pa.style.width=b+"%"}};v.z=function(){yf(this);vf.g.z.call(this);this.pa=r;this.Mb.ma()};function zf(a,b){x(a)||h(Error("No valid parent element."));x(b)||h(Error("Invalid initial value."));vf.call(this);this.className="progressbar";this.fa=a;this.zc=this.Ia=r;this.bb=[];this.bb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.od(b);this.Md()}F(zf,vf);
zf.prototype.Md=function(){if("static"==this.fa.style.position||""==this.fa.style.position)this.fa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Yd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.bb[0]),d=document.createTextNode(this.bb[1]),e=document.createTextNode(this.bb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.Ia=b;this.Ob(this.fa);a=this.e();a.style.position="absolute";a.style.top=(this.fa.clientHeight-
5)/2;a.style.left=(this.fa.clientWidth-100)/2};function Af(a){var b=a.e().style.top,c=a.e().style.left;be(a.e());var d=new zf(a.fa,100),e=d.e();e.style.position="absolute";e.style.top=b;e.style.left=c;(e.firstElementChild!=n?e.firstElementChild:ce(e.firstChild)).classList.add("progress-bar-thumb-done");a.zc=d}zf.prototype.Nd=function(){this.Ia&&be(this.Ia);this.e()&&be(this.e());this.zc&&be(this.zc.e());this.zc=this.Ia=r};function Bf(a){x(a)||h(Error("An ID to a valid container (<div>..) is required."));a=Vd(a);(!(na(a)&&1==a.nodeType)||0==a.clientWidth||0==a.clientHeight)&&h(Error("Could not find the given container or it has an undefined size."));M.call(this);this.className="renderer";this.container=a;this.width=this.container.clientWidth;this.height=this.container.clientHeight;this.interactor=this.camera=this.canvas=r;this.La=new Re(td);this.$a=[];this.K=r;this.initialLoadingCompleted=this.$c=s;this.a=this.wa=r;
this.config={PROGRESSBAR_ENABLED:p};window.console.log("XTK Release 4 -- 04/12/12 -- http://www.goXTK.com")}F(Bf,M);v=Bf.prototype;v.bh=function(a){this.wa&&this.wa.od(100*a.xe)};v.Sg=function(a){x(a)&&a instanceof sd&&this.ab(a.U)};v.$d=function(a){(!x(a)||!(a instanceof Jd))&&h(Error("Invalid hover event."))};v.ae=function(a){(!x(a)||!(a instanceof Hd))&&h(Error("Invalid scroll event."))};v.oc=function(){this.camera.reset();this.ha(s,s)};
function Cf(a){a.config.PROGRESSBAR_ENABLED&&a.wa&&!a.ve&&(Af(a.wa),a.ve=Oe(function(){this.ve=r;this.wa&&(this.wa.Nd(),this.wa=r);this.Ob()}.bind(a),700))}
v.R=function(a){var b=Yd("canvas");b.width=this.width;b.height=this.height;this.container.appendChild(b);try{var c=b.getContext(a);c||h(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.container.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";h(Error(e))}this.K=new Ce;K(this.K,
Ad,this.bh.bind(this));this.canvas=b;this.a=c;b=new Qe(this.canvas);"2d"==a&&(b=new ie(this.canvas));b.R();K(b,zd,this.oc.bind(this));K(b,Bd,this.$d.bind(this));K(b,xd,this.ae.bind(this));this.interactor=b;b=new Ue(this.width,this.height);"2d"==a&&(b=new Te(this.width,this.height));b.Xd(this.interactor);K(b,yd,this.ha.bind(this,s,s));this.camera=b};v.add=function(a){this.$a.push(a);this.ab(a)};
v.ab=function(a){(!this.canvas||!this.a)&&h(Error("The renderer was not initialized properly."));x(a)||(window.console.log(a),h(Error("Illegal object.")));xc(a)||K(a,yc,this.Sg.bind(this))};v.get=function(a){x(a)||h(Error("Invalid object id."));for(var b=this.La.u,c=b.length,d=0,d=0;d<c;d++)if(b[d]._id==a)return b[d];return r};
v.Ob=function(){(!this.canvas||!this.a)&&h(Error("The renderer was not initialized properly."));x(this.zf)||(!x(this.K.Wb)||!this.K.Wb.Cd(s)?this.wa?(Cf(this),eval("this.onShowtime()"),this._initialLoadingCompleted=p):this.ha(s,p):(this.config.PROGRESSBAR_ENABLED&&!this.wa&&(this.wa=new zf(this.container,3)),this.zf=Oe(function(){this.zf=r;this.Ob()}.bind(this),100)))};v.of=aa();v.ha=aa();
v.Nc=function(){this.La.clear();delete this.La;this.$a.length=0;delete this.$a;delete this.K;this.K=r;delete this.camera;this.camera=r;delete this.interactor;this.interactor=r;delete this.a;this.a=r;be(this.canvas);delete this.canvas;this.canvas=r};function Df(a){function b(a,b,d){b=2*b*Math.PI;b=k.Na(Math.cos(b)).ub(o.Na(Math.sin(b)));a=c.ub(e.Na(a)).ub(b.Na(f));d=b.Na(1-Math.abs(d)).ub(g.Na(d));return new Lc(a,d)}this.n=[];for(var a=a||{},c=new L(a.start||[0,-1,0]),d=new L(a.end||[0,1,0]),e=d.Jb(c),f=a.xa||1,a=a.Za||16,g=e.Qb(),i=0.5<Math.abs(g.y()),k=(new L(i,!i,0)).Mc(g).Qb(),o=k.Mc(g).Qb(),i=new Lc(c,g.cd()),d=new Lc(d,g.Qb()),j=[],m=0;m<a;m++){var l=m/a,q=(m+1)/a;j.push(new Pc([i,b(0,l,-1),b(0,q,-1)]));j.push(new Pc([b(0,q,0),b(0,l,0),
b(1,l,0),b(1,q,0)]));j.push(new Pc([d,b(1,q,1),b(1,l,1)]))}return Rc(j)}F(Df,O);A("CSG.cylinder",Df);function Ef(a,b,c){(!x(a)||!(a instanceof Array)||3!=a.length)&&h(Error("Invalid start position."));(!x(b)||!(b instanceof Array)||3!=b.length)&&h(Error("Invalid end position."));z(c)||h(Error("Invalid radius."));U.call(this);this.className="cylinder";this.Yf=a;this.Tf=b;this.vd=c;this.wd=32;this.sa()}F(Ef,U);Ef.prototype.sa=function(){rd(this,new Df({start:this.Yf,end:this.Tf,xa:this.vd,Za:this.wd}))};A("X.cylinder",Ef);function Ff(a,b,c,d,e,f,g,i){var k,o=c.offsetParent;if(o){var j="HTML"==o.tagName||"BODY"==o.tagName;if(!j||"static"!=Ze(o,"position"))k=df(o),j||(k=$c(k,new Zc(o.scrollLeft,o.scrollTop)))}o=df(a);j=gf(a);o=new We(o.x,o.y,j.width,j.height);(j=cf(a))&&o.Ve(new We(j.left,j.top,j.right-j.left,j.bottom-j.top));var j=Sd(a),m=Sd(c);if(j.A!=m.A){var l=j.A.body,m=m.A.parentWindow||m.A.defaultView,q=new Zc(0,0),u=Ud(l)?Ud(l).parentWindow||Ud(l).defaultView:window,w=l;do{var B;if(u==m)B=df(w);else{var D=w;
B=new Zc;if(1==D.nodeType)if(D.getBoundingClientRect)D=af(D),B.x=D.left,B.y=D.top;else{var I=fe(Sd(D)),D=df(D);B.x=D.x-I.x;B.y=D.y-I.y}else{var I=ma(D.pg),C=D;D.targetTouches?C=D.targetTouches[0]:I&&D.ua.targetTouches&&(C=D.ua.targetTouches[0]);B.x=C.clientX;B.y=C.clientY}}q.x+=B.x;q.y+=B.y}while(u&&u!=m&&(w=u.frameElement)&&(u=u.parent));l=$c(q,df(l));G&&!ee(j)&&(l=$c(l,fe(j)));o.left+=l.x;o.top+=l.y}a=(b&4&&ef(a)?b^2:b)&-5;b=new Zc(a&2?o.left+o.width:o.left,a&1?o.top+o.height:o.top);k&&(b=$c(b,
k));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var E;if(g&&(E=cf(c))&&k)E.top-=k.y,E.right-=k.x,E.bottom-=k.y,E.left-=k.x;return Gf(b,c,d,f,E,g,i)}
function Gf(a,b,c,d,e,f,g){var a=a.d(),i=0,k=(c&4&&ef(b)?c^2:c)&-5,c=gf(b),g=g?g.d():c.d();if(d||0!=k)k&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),k&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){i=a;d=0;if(65==(f&65)&&(i.x<e.left||i.x>=e.right))f&=-2;if(132==(f&132)&&(i.y<e.top||i.y>=e.bottom))f&=-5;i.x<e.left&&f&1&&(i.x=e.left,d|=1);i.x<e.left&&i.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(i.x+g.width-e.right),0),d|=4);i.x+g.width>e.right&&f&1&&(i.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(i.x<e.left?16:0)|(i.x+g.width>e.right?32:0));i.y<e.top&&f&4&&(i.y=e.top,d|=2);i.y>=e.top&&i.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(i.y+g.height-e.bottom),0),d|=8);i.y+g.height>e.bottom&&f&4&&(i.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(i.y<e.top?64:0)|(i.y+g.height>e.bottom?128:0));i=d}else i=256;if(i&496)return i}f=a;e=Ua&&(Na||ab)&&jb("1.9");f instanceof Zc?(a=f.x,f=f.y):(a=f,f=n);b.style.left=ff(a,e);b.style.top=ff(f,e);cd(c,g)||(a=ee(Sd(Ud(b))),
G&&(!a||!jb("8"))?(c=b.style,a?(G?(a=kf(b,Ye(b,"paddingLeft")),e=kf(b,Ye(b,"paddingRight")),f=kf(b,Ye(b,"paddingTop")),d=kf(b,Ye(b,"paddingBottom")),a=new Ve(f,e,d,a)):(a=Xe(b,"paddingLeft"),e=Xe(b,"paddingRight"),f=Xe(b,"paddingTop"),d=Xe(b,"paddingBottom"),a=new Ve(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),G?(e=mf(b,"borderLeft"),f=mf(b,"borderRight"),d=mf(b,"borderTop"),b=mf(b,"borderBottom"),b=new Ve(d,f,b,e)):(e=Xe(b,"borderLeftWidth"),f=Xe(b,"borderRightWidth"),d=Xe(b,"borderTopWidth"),
b=Xe(b,"borderBottomWidth"),b=new Ve(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Ua?b.MozBoxSizing="border-box":J?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return i};function Hf(){}Hf.prototype.ya=aa();function If(a,b){this.element=a;this.Ce=b}F(If,Hf);If.prototype.ya=function(a,b,c){Ff(this.element,this.Ce,a,b,n,c)};function Jf(a,b){this.na=new nf(this);this.fe(a||r);b&&this.Ya(b)}F(Jf,Ic);v=Jf.prototype;v.j=r;v.Zf=p;v.ye=r;v.aa=s;v.Mh=s;v.Pd=-1;v.tg=s;v.jg=p;v.Pb="toggle_display";v.Ya=ba("Pb");v.e=t("j");v.fe=function(a){this.aa&&h(Error("Can not change this state of the popup while showing."));this.j=a};
v.s=function(a){this.tc&&this.tc.stop();this.dc&&this.dc.stop();if(a){if(!this.aa&&this.Yd()){this.j||h(Error("Caller must call setElement before trying to show the popup"));this.ya();a=Ud(this.j);this.tg&&pf(this.na,a,"keydown",this.Qg,p);if(this.Zf)if(pf(this.na,a,"mousedown",this.lf,p),G){var b;try{b=a.activeElement}catch(c){}for(;b&&"IFRAME"==b.nodeName;){try{var d=b.contentDocument||b.contentWindow.document}catch(e){break}a=d;b=a.activeElement}pf(this.na,a,"mousedown",this.lf,p);pf(this.na,a,
"deactivate",this.kf)}else pf(this.na,a,"blur",this.kf);"toggle_display"==this.Pb?(this.j.style.visibility="visible",jf(this.j,p)):"move_offscreen"==this.Pb&&this.ya();this.aa=p;this.tc?(sc(this.tc,"end",this.nf,s,this),this.tc.play()):this.nf()}}else Kf(this)};v.ya=fa;function Kf(a,b){if(!a.aa||!a.dispatchEvent({type:"beforehide",target:b}))return s;a.na&&a.na.hd();a.dc?(sc(a.dc,"end",Aa(a.Be,b),s,a),a.dc.play()):a.Be(b);return p}
v.Be=function(a){"toggle_display"==this.Pb?this.Mh?Oe(this.Re,0,this):this.Re():"move_offscreen"==this.Pb&&(this.j.style.left="-200px",this.j.style.top="-200px");this.aa=s;this.Zd(a)};v.Re=function(){this.j.style.visibility="hidden";jf(this.j,s)};v.Yd=function(){return this.dispatchEvent("beforeshow")};v.nf=function(){this.Pd=Ba();this.dispatchEvent("show")};v.Zd=function(a){Ba();this.dispatchEvent({type:"hide",target:a})};
v.lf=function(a){a=a.target;!de(this.j,a)&&(!this.ye||de(this.ye,a))&&!(150>Ba()-this.Pd)&&Kf(this,a)};v.Qg=function(a){27==a.keyCode&&Kf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};v.kf=function(a){if(this.jg){var b=Ud(this.j);if(G||Ta){if(a=b.activeElement,!a||de(this.j,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>Ba()-this.Pd||Kf(this)}};v.z=function(){Jf.g.z.call(this);this.na.ma();Wb(this.tc);Wb(this.dc);delete this.j;delete this.na};function Lf(a,b){this.Dd=a instanceof Zc?a:new Zc(a,b)}F(Lf,Hf);Lf.prototype.ya=function(a,b,c,d){Ff($e(a),0,a,b,this.Dd,c,r,d)};function Mf(a,b){this.lh=4;this.de=b||n;Jf.call(this,a)}F(Mf,Jf);Mf.prototype.md=function(a){this.de=a||n;this.aa&&this.ya()};Mf.prototype.ya=function(){if(this.de){var a=!this.aa&&"move_offscreen"!=this.Pb,b=this.e();a&&(b.style.visibility="hidden",jf(b,p));this.de.ya(b,this.lh,this.Ni);a&&jf(b,s)}};function Nf(a,b,c){this.ta=c||(a?Sd(Vd(a)):Sd());Mf.call(this,this.ta.Fb("div",{style:"position:absolute;display:none;"}));this.Ed=new Zc(1,1);this.ob=new Rb;a&&Of(this,a);if(b!=r)if(a=this.e(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Ud(a).createTextNode(b))}}F(Nf,Mf);var Pf=[];v=Nf.prototype;v.X=r;v.className="goog-tooltip";
v.Ef=500;v.sg=0;v.Qc=t("ta");function Of(a,b){b=Vd(b);a.ob.add(b);K(b,"mouseover",a.Oe,s,a);K(b,"mouseout",a.Vc,s,a);K(b,"mousemove",a.Ne,s,a);K(b,"focus",a.Me,s,a);K(b,"blur",a.Vc,s,a)}v.detach=function(a){if(a)a=Vd(a),Qf(this,a),this.ob.remove(a);else{for(var b=this.ob.pb(),c=0;a=b[c];c++)Qf(this,a);this.ob.clear()}};function Qf(a,b){tc(b,"mouseover",a.Oe,s,a);tc(b,"mouseout",a.Vc,s,a);tc(b,"mousemove",a.Ne,s,a);tc(b,"focus",a.Me,s,a);tc(b,"blur",a.Vc,s,a)}
v.fe=function(a){var b=this.e();b&&be(b);Nf.g.fe.call(this,a);a&&(b=this.ta.A.body,b.insertBefore(a,b.lastChild))};v.Yd=function(){if(!Jf.prototype.Yd.call(this))return s;if(this.anchor)for(var a,b=0;a=Pf[b];b++)de(a.e(),this.anchor)||a.s(s);0<=ub(Pf,this)||Pf.push(this);a=this.e();a.className=this.className;Rf(this);K(a,"mouseover",this.Qe,s,this);K(a,"mouseout",this.Pe,s,this);Sf(this);return p};
v.Zd=function(){Bb(Pf,this);for(var a=this.e(),b,c=0;b=Pf[c];c++)b.anchor&&de(a,b.anchor)&&b.s(s);this.rf&&Tf(this.rf);tc(a,"mouseover",this.Qe,s,this);tc(a,"mouseout",this.Pe,s,this);this.anchor=n;if(0==(this.Ma?this.aa?4:1:this.Hb?3:this.aa?2:0))this.ld=s;Jf.prototype.Zd.call(this)};v.cf=function(a,b){this.anchor==a&&this.ob.contains(this.anchor)&&(this.ld||!this.Oi?(this.s(s),this.aa||(this.anchor=a,this.md(b||Uf(this,0)),this.s(p))):this.anchor=n);this.Ma=n};
v.Ig=function(a){this.Hb=n;a==this.anchor&&(this.X==r||this.X!=this.e()&&!this.ob.contains(this.X))&&(!this.ze||!this.ze.X)&&this.s(s)};function Vf(a,b){var c=fe(a.ta);a.Ed.x=b.clientX+c.x;a.Ed.y=b.clientY+c.y}v.Oe=function(a){var b=Wf(this,a.target);this.X=b;Rf(this);b!=this.anchor&&(this.anchor=b,this.Ma||(this.Ma=Oe(wa(this.cf,this,b,n),this.Ef)),Xf(this),Vf(this,a))};function Wf(a,b){try{for(;b&&!a.ob.contains(b);)b=b.parentNode;return b}catch(c){return r}}
v.Ne=function(a){Vf(this,a);this.ld=p};v.Me=function(a){this.X=a=Wf(this,a.target);this.ld=p;if(this.anchor!=a){this.anchor=a;var b=Uf(this,1);Rf(this);this.Ma||(this.Ma=Oe(wa(this.cf,this,a,b),this.Ef));Xf(this)}};function Uf(a,b){if(0==b){var c=a.Ed.d();return new Yf(c)}return new Zf(a.X)}function Xf(a){if(a.anchor)for(var b,c=0;b=Pf[c];c++)de(b.e(),a.anchor)&&(b.ze=a,a.rf=b)}
v.Vc=function(a){var b=Wf(this,a.target),c=Wf(this,a.relatedTarget);b!=c&&(b==this.X&&(this.X=r),Sf(this),this.ld=s,this.aa&&(!a.relatedTarget||!de(this.e(),a.relatedTarget))?Tf(this):this.anchor=n)};v.Qe=function(){var a=this.e();this.X!=a&&(Rf(this),this.X=a)};v.Pe=function(a){var b=this.e();if(this.X==b&&(!a.relatedTarget||!de(b,a.relatedTarget)))this.X=r,Tf(this)};function Sf(a){a.Ma&&(Ne.clearTimeout(a.Ma),a.Ma=n)}
function Tf(a){if(2==(a.Ma?a.aa?4:1:a.Hb?3:a.aa?2:0))a.Hb=Oe(wa(a.Ig,a,a.anchor),a.sg)}function Rf(a){a.Hb&&(Ne.clearTimeout(a.Hb),a.Hb=n)}v.z=function(){this.s(s);Sf(this);this.detach();this.e()&&be(this.e());this.X=r;delete this.ta;Nf.g.z.call(this)};function Yf(a,b){Lf.call(this,a,b)}F(Yf,Lf);Yf.prototype.ya=function(a,b,c){b=$e(a);b=cf(b);c=c?new Ve(c.top+10,c.right,c.bottom,c.left+10):new Ve(10,0,0,10);Gf(this.Dd,a,4,c,b,9)&496&&Gf(this.Dd,a,4,c,b,5)};function Zf(a){If.call(this,a,3)}F(Zf,If);
Zf.prototype.ya=function(a,b,c){var d=new Zc(10,0);Ff(this.element,this.Ce,a,b,d,c,9)&496&&Ff(this.element,2,a,1,d,c,5)};function $f(a,b,c,d){x(a)||h(Error("No valid parent element."));(!z(b)||!z(c))&&h(Error("Invalid coordinates."));(!x(d)||!(d instanceof ge))&&h(Error("Invalid interactor."));Nf.call(this);this.className="caption";this.fa=a;this.Ic=b;this.Jc=c;this.Ia=r;this.bb=[];this.bb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];sc(d,Cd,this.Nd.bind(this));this.Md()}F($f,Nf);
$f.prototype.Md=function(){if("static"==this.fa.style.position||""==this.fa.style.position)this.fa.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Yd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.bb[0]);a.appendChild(b);b.appendChild(c);this.Ia=b;this.md(new Lf(this.Ic,this.Jc));this.s(p);Of(this,this.fa);this.e().classList.add("x-tooltip")};$f.prototype.Nd=function(){this.s(s);this.Ia&&be(this.Ia);this.e()&&be(this.e());this.Ia=r};function ag(){M.call(this);this.className="shader";this.Gc="";this.Gc="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.Ac="";this.Ac="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool useTextureThreshold;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelMapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelMapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelMapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (useTextureThreshold) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
F(ag,M);
var bg={Di:"vertexPosition",Ci:"vertexNormal",Bi:"vertexColor",Fi:"vertexTexturePos",Ei:"vertexScalar"},cg={Gi:"view",ki:"perspective",ei:"center",ji:"objectTransform",wi:"useObjectColor",hi:"objectColor",yi:"useScalars",si:"scalarsReplaceMode",pi:"scalarsMin",mi:"scalarsMax",qi:"scalarsMinColor",ni:"scalarsMaxColor",ri:"scalarsMinThreshold",oi:"scalarsMaxThreshold",li:"pointSize",ii:"objectOpacity",gi:"normal",xi:"usePicking",zi:"useTexture",Ai:"useTextureThreshold",vi:"useLabelMapTexture",fi:"labelMapOpacity",
ti:"textureSampler",ui:"textureSampler2",Hi:"volumeLowerThreshold",Ki:"volumeUpperThreshold",Ji:"volumeScalarMin",Ii:"volumeScalarMax"};
function dg(a){var b=Object.keys(cg);Object.keys(bg).every(function(a){a=eval("X.shaders.attributes."+a);return-1!=this.Gc.search(a)||-1!=this.Ac.search(a)}.bind(a))||h(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=eval("X.shaders.uniforms."+a);return-1!=this.Gc.search(a)||-1!=this.Ac.search(a)}.bind(a))||h(Error("Could not find all uniforms in the shader sources."))}A("X.shaders.attributes",bg);A("X.shaders.uniforms",cg);function eg(a,b,c){x(a)||h(Error("Invalid GL Buffer."));x(b)||h(Error("Invalid number of items."));x(c)||h(Error("Invalid item size."));M.call(this);this.className="buffer";this.Q=a;this.Qa=b;this.Ra=c}F(eg,M);function fg(a){Bf.call(this,a);this.className="renderer3D";this.hc=this.kc=this.gc=this.jc=this.fc=this.ic=this.he=this.ie=r;this.lb=[0,0,0];this.wf=r;this.zd=new Mb;this.vc=new Mb;this.xc=new Mb;this.Wd=new Mb;this.Kc=new Mb;this.kd=new Mb;this.pd=new Mb;this.qd=new Mb;this.config={PROGRESSBAR_ENABLED:p,PICKING_ENABLED:p,ORDERING_ENABLED:p,STATISTICS_ENABLED:s}}F(fg,Bf);v=fg.prototype;v.oh=function(){this.hc=this.kc=this.gc=this.jc=this.fc=this.ic=r;this.lb=[0,0,0]};
v.$d=function(a){fg.g.$d.call(this,a);var b=a.Ic,a=a.Jc,c=this.get(this.vf(b,a));if(c&&(c=c.caption()))(new $f(this.container,this.container.offsetLeft+b+10,this.container.offsetTop+a+10,this.interactor)).e().innerHTML=c};
v.R=function(){fg.g.R.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.width,this.height),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.config.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();
this.a.bindTexture(this.a.TEXTURE_2D,c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.width,this.height,0,this.a.RGB,this.a.UNSIGNED_BYTE,r);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.width,this.height);this.a.bindRenderbuffer(this.a.RENDERBUFFER,r);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,
this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.wf=a}}catch(d){h(Error("Exception while accessing GL Context!\n"+d))}gg(this)};
function gg(a){var b=new ag;(!x(a.canvas)||!x(a.a)||!x(a.camera))&&h(Error("Renderer was not initialized properly."));(!x(b)||!(b instanceof ag))&&h(Error("Could not add shaders."));dg(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.Ac);a.a.shaderSource(d,b.Gc);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||h(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,
a.a.COMPILE_STATUS)||h(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||h(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.he=e;Object.keys(bg).forEach(function(a){a=eval("X.shaders.attributes."+a);this.zd.set(a,this.a.getAttribLocation(this.he,a));
this.a.enableVertexAttribArray(this.zd.get(a))}.bind(a));Object.keys(cg).forEach(function(a){a=eval("X.shaders.uniforms."+a);this.vc.set(a,this.a.getUniformLocation(this.he,a))}.bind(a));a.ie=b}
v.ab=function(a){fg.g.ab.call(this,a);var b=s;this.get(a._id)&&(b=p);var c=a._id,d=a.f,e=a.h,f=a.ja,g=a.M,i=a.k,k=a.Cb,o=a.q,j=a.B,m=a.o;if(x(j)&&x(j.k)&&j.k.c)this.ab(j);else if(x(o)&&x(o.k)&&o.k.c)b=this.K,x(a.q)||h(Error("Internal error during file loading.")),c=a.q.file().path(),m=new XMLHttpRequest,K(m,"abort",b.Ib.bind(b,m,a)),K(m,"error",b.Ib.bind(b,m,a)),K(m,"load",b.yg.bind(b,m,a)),m.open("GET",c,p),m.overrideMimeType("text/plain; charset=x-user-defined"),m.setRequestHeader("Content-Type",
"text/plain"),m.send(r),De(b).set(a.q.id(),s);else if(x(g)&&x(g.k)&&g.k.c)b=this.K,x(a.M)||h(Error("Internal error during texture loading.")),c=new Image,m=a.M.file().path(),c.src=m,a.M.td=c,sc(c,"load",b.Bg.bind(b,a)),De(b).set(a.id(),s),Ee(b,0.3);else if(x(i)&&i.c)Fe(this.K,a);else if(x(m)&&x(m.k)&&m.k.c)b=this.K,x(a.o)||h(Error("Internal error during file loading.")),c=a.o.file().path(),m=new XMLHttpRequest,K(m,"abort",b.Ib.bind(b,m,a)),K(m,"error",b.Ib.bind(b,m,a)),K(m,"load",b.Ag.bind(b,m,a)),
m.open("GET",c,p),m.overrideMimeType("text/plain; charset=x-user-defined"),m.setRequestHeader("Content-Type","text/plain"),m.send(r),De(b).set(a.o.id(),s);else{if(a.c&&0<a.children().length){i=a.children();o=i.length;for(j=j=0;j<o;j++)this.ab(i[j])}if(0==d.count())Jc(a);else{for(i=0;this.$c;)i++,window.console.log("Possible thread lock avoided: "+i);this.$c=p;o=a instanceof je&&a.Ja instanceof le;b&&x(g)&&g.c&&(i=this.pd.get(c),x(i)&&this.a.isBuffer(i.Q)&&this.a.deleteBuffer(i.Q));i=r;x(g)&&(!b||
g.c?(i=a.jb,x(i)||h(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),j=this.a.createTexture(),j.Te=g.td,this.qd.set(g._id,j),this.a.bindTexture(this.a.TEXTURE_2D,j),g.Bb?(this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.Fc,g.Ec,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.Bb),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,
p)):(this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,j.Te),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,s)),o?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,
r),j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(i),this.a.STATIC_DRAW),i=new eg(j,i.length,2),Jc(g)):i=this.pd.get(c));Ee(this.K,0.1);if(o)this.$c=s,Ee(this.K,0.9);else{if(d.c||k.c){o=k.i;g=o.oa(new Q(d.Ea,d.Fa,d.Ga));o=o.oa(new Q(d.Ba,d.Ca,d.Da));if(this.ic===r||g.x<this.ic)this.ic=g.x;if(this.fc===r||o.x>this.fc)this.fc=o.x;if(this.jc===r||g.y<this.jc)this.jc=g.y;if(this.gc===r||o.y>this.gc)this.gc=o.y;if(this.kc===r||g.b<
this.kc)this.kc=g.b;if(this.hc===r||o.b>this.hc)this.hc=o.b;this.lb=[(this.ic+this.fc)/2,(this.jc+this.gc)/2,(this.kc+this.hc)/2];Jc(k)}b&&d.c&&(k=this.xc.get(c),x(k)&&this.a.isBuffer(k.Q)&&this.a.deleteBuffer(k.Q));k=r;!b||d.c?(k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(d.all()),this.a.STATIC_DRAW),k=new eg(k,d.count(),3),Jc(d)):k=this.xc.get(c);Ee(this.K,0.3);b&&e.c&&(g=this.xc.get(c),x(g)&&this.a.isBuffer(g.Q)&&this.a.deleteBuffer(g.Q));
g=r;!b||e.c?(g=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(e.all()),this.a.STATIC_DRAW),g=new eg(g,e.count(),3),Jc(e)):g=this.Wd.get(c);Ee(this.K,0.3);b&&f.c&&(e=this.Kc.get(c),x(e)&&this.a.isBuffer(e.Q)&&this.a.deleteBuffer(e.Q));e=r;0<f.length()&&(!b||f.c?(f.length()!=d.length()&&h(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,
new Float32Array(f.all()),this.a.STATIC_DRAW),e=new eg(e,f.count(),3),Jc(f)):e=this.Kc.get(c));Ee(this.K,0.2);b&&m&&m.c&&(f=this.kd.get(c),x(f)&&this.a.isBuffer(f.Q)&&this.a.deleteBuffer(f.Q));f=r;m&&(f=m.Bc,!b||m.c?(f.length!=d.length()&&h(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(f),this.a.STATIC_DRAW),f=new eg(d,f.length,3),Jc(m)):f=this.kd.get(c));Ee(this.K,0.1);b||this.La.add(a);
this.xc.set(c,k);this.Wd.set(c,g);this.Kc.set(c,e);this.pd.set(c,i);this.kd.set(c,f);Jc(a);this.$c=s}}}};function hg(a,b){var c=b.f.yb,c=a.camera.view.oa(b.Cb.i.oa(new Q(c[0],c[1],c[2]))),c=Uc(a.camera.position,c);return Math.round(1E3*c)/1E3}
v.vf=function(a,b){if(this.config.PICKING_ENABLED){this.ha(p,s);var c=new Uint8Array(4);this.a.readPixels(a,this.height-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);var d=Math.round(10*(c[0]/255)),e=Math.round(10*(c[1]/255)),c=Math.round(10*(c[2]/255));return 100*d+10*e+c}return-1};
v.ha=function(a,b){fg.g.ha.call(this,a,b);var c=this.La.u,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.wf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.a.viewport(0,0,this.width,this.height);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.camera.ih,f=this.camera.qb;this.a.uniformMatrix4fv(this.vc.get("perspective"),s,e);this.a.uniformMatrix4fv(this.vc.get("view"),s,f);e=this.lb;this.a.uniform3f(this.vc.get("center"),parseFloat(e[0]),parseFloat(e[1]),
parseFloat(e[2]));f=this.$a.length;for(e=0;e<f;++e){var g=this.$a[e];if(g instanceof Y){var i=new Q(1,0,0),i=this.camera.view.oa(i),k=Uc(this.camera.position,i),i=new Q(-1,0,0),i=this.camera.view.oa(i),o=Uc(this.camera.position,i),i=new Q(0,1,0),i=this.camera.view.oa(i),j=Uc(this.camera.position,i),i=new Q(0,-1,0),i=this.camera.view.oa(i),m=Uc(this.camera.position,i),i=new Q(0,0,1),i=this.camera.view.oa(i),l=Uc(this.camera.position,i),i=new Q(0,0,-1),i=this.camera.view.oa(i),i=Uc(this.camera.position,
i),q=Math.max(k,j,l,o,m,i);q==k||q==o?ke(g,0):q==j||q==m?ke(g,1):(q==l||q==i)&&ke(g,2)}}if(this.config.ORDERING_ENABLED){k=s;f=this.$a;g=f.length-1;do if(e=f[g],e instanceof Y&&e._volumeRendering){o=e.Ua;k=e.gb.children();1==o?k=e.hb.children():2==o&&(k=e.ib.children());o=k.length;j=k[0];j.G=hg(this,j);j._opacity=e._opacity;m=k[o-1];m.G=hg(this,m);m._opacity=e._opacity;m=Math.round(1E3*((m.G-j.G)/o))/1E3;for(l=l=1;l<o-1;l++)i=Math.round(1E3*(j.G+l*m))/1E3,k[l].G=i,k[l]._opacity=e._opacity;k=p}while(g--);
f=this.La.u;g=f.length-1;do if(e=f[g],e._visible&&!(1==e._opacity||e instanceof je))e.G=hg(this,e),k=p;while(g--);k&&this.La.sort()}if(f=!a&&x(b)&&b&&this.config.STATISTICS_ENABLED)var u=0,w=0,B=0,D=0;var e=this.zd,g=e.get("vertexPosition"),k=e.get("vertexNormal"),o=e.get("vertexColor"),j=e.get("vertexTexturePos"),m=e.get("vertexScalar"),e=this.vc,l=e.get("usePicking"),i=e.get("useObjectColor"),q=e.get("objectColor"),I=e.get("useScalars"),C=e.get("scalarsReplaceMode"),E=e.get("scalarsMin"),za=e.get("scalarsMax"),
Z=e.get("scalarsMinColor"),ea=e.get("scalarsMaxColor"),da=e.get("scalarsMinThreshold"),ja=e.get("scalarsMaxThreshold"),V=e.get("objectOpacity"),oa=e.get("labelMapOpacity"),R=e.get("useTexture"),rc=e.get("useTextureThreshold"),ya=e.get("useLabelMapTexture"),zb=e.get("textureSampler"),Vc=e.get("textureSampler2"),Xa=e.get("volumeLowerThreshold"),Wc=e.get("volumeUpperThreshold"),Ab=e.get("volumeScalarMin"),sa=e.get("volumeScalarMax"),lb=e.get("objectTransform"),kb=e.get("pointSize"),e=d;do{var H=c[d-
e];if(H){var N=r;H instanceof je&&H.Ja&&(N=H.Ja);if(H._visible&&(!N||N._visible)){var ia=H._id,Va=H._magicMode,xa=this.xc.get(ia),ra=this.Wd.get(ia),Qb=this.Kc.get(ia),Wa=this.kd.get(ia),Gd=this.pd.get(ia);this.a.bindBuffer(this.a.ARRAY_BUFFER,xa.Q);this.a.vertexAttribPointer(g,xa.Ra,this.a.FLOAT,s,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,ra.Q);this.a.vertexAttribPointer(k,ra.Ra,this.a.FLOAT,s,0,0);a?this.a.uniform1i(l,p):this.a.uniform1i(l,s);Qb&&!a&&!Va?(this.a.uniform1i(i,s),this.a.bindBuffer(this.a.ARRAY_BUFFER,
Qb.Q),this.a.vertexAttribPointer(o,Qb.Ra,this.a.FLOAT,s,0,0)):(ra=1,Va&&!a&&(ra=0),this.a.uniform1i(i,ra),ra=H._color,a&&(999<ia&&h(Error("Id out of bounds.")),ra=Math.floor(0.01*ia),Qb=Math.floor(0.1*ia)-10*ra,ra=[ra/10,Qb/10,(ia-100*ra-10*Qb)/10]),this.a.uniform3f(q,parseFloat(ra[0]),parseFloat(ra[1]),parseFloat(ra[2])),this.a.vertexAttribPointer(o,xa.Ra,this.a.FLOAT,s,0,0));Wa&&!a&&!Va?(this.a.uniform1i(I,p),this.a.uniform1i(C,H.o.we),ia=H.o._minColor,Va=H.o._maxColor,this.a.uniform3f(Z,parseFloat(ia[0]),
parseFloat(ia[1]),parseFloat(ia[2])),this.a.uniform3f(ea,parseFloat(Va[0]),parseFloat(Va[1]),parseFloat(Va[2])),this.a.uniform1f(da,parseFloat(H.o._minThreshold)),this.a.uniform1f(ja,parseFloat(H.o._maxThreshold)),this.a.uniform1f(E,parseFloat(H.o.Dc)),this.a.uniform1f(za,parseFloat(H.o.Cc)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Wa.Q),this.a.vertexAttribPointer(m,Wa.Ra,this.a.FLOAT,s,0,0)):(this.a.uniform1i(I,s),this.a.vertexAttribPointer(m,xa.Ra,this.a.FLOAT,s,0,0));this.a.uniform1f(V,parseFloat(H._opacity));
H.M&&Gd&&!a?(this.a.uniform1i(R,p),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.qd.get(H.M._id)),this.a.uniform1i(zb,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,Gd.Q),this.a.vertexAttribPointer(j,Gd.Ra,this.a.FLOAT,s,0,0),this.a.uniform1i(rc,s)):(this.a.uniform1i(R,s),this.a.vertexAttribPointer(j,xa.Ra,this.a.FLOAT,s,0,0));N&&(this.a.uniform1i(rc,p),this.a.uniform1f(Xa,N._lowerThreshold),this.a.uniform1f(Wc,N._upperThreshold),Wa=N.Ha,this.a.uniform1f(Ab,Wa[0]),this.a.uniform1f(sa,
Wa[1]),Wa=N.B,this.a.uniform1i(ya,s),N._volumeRendering?this.a.uniform1f(V,parseFloat(N._opacity)):Wa&&Wa._visible&&(N=H.B._id,this.a.uniform1i(ya,p),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.qd.get(N)),this.a.uniform1i(Vc,1),this.a.uniform1f(oa,Wa._opacity)));this.a.uniformMatrix4fv(lb,s,H.Cb.ra);N=1;"POINTS"==H._type&&(N=H._pointSize);this.a.uniform1f(kb,N);N=-1;H.type()==pd?(N=this.a.TRIANGLES,f&&(w+=xa.Qa/3)):"LINES"==H.type()?(this.a.lineWidth(H.lineWidth()),
N=this.a.LINES,f&&(B+=xa.Qa/2)):"POINTS"==H.type()?(N=this.a.POINTS,f&&(D+=xa.Qa)):"TRIANGLE_STRIPS"==H.type()?(N=this.a.TRIANGLE_STRIP,f&&(w+=xa.Qa/3)):"POLYGONS"==H.type()&&(N=0==xa.Qa%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(w+=xa.Qa/3));f&&(u+=xa.Qa);this.a.drawArrays(N,0,xa.Qa)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+u+" | ")+("Triangles: "+Math.round(w)+" | "),c=c+("Lines: "+B+" | ")+("Points: "+D+" | ")+("Textures: "+this.qd.Z()),window.console.log(c))}};
v.Nc=function(){this.ie=r;delete this.ie;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);fg.g.Nc.call(this)};A("X.renderer3D",fg);A("X.renderer3D.prototype.init",fg.prototype.R);A("X.renderer3D.prototype.add",fg.prototype.add);A("X.renderer3D.prototype.onShowtime",fg.prototype.of);A("X.renderer3D.prototype.get",fg.prototype.get);A("X.renderer3D.prototype.render",fg.prototype.Ob);A("X.renderer3D.prototype.destroy",fg.prototype.Nc);A("X.renderer3D.prototype.resetBoundingBox",fg.prototype.oh);
A("X.renderer3D.prototype.resetViewAndRender",fg.prototype.oc);A("X.renderer3D.prototype.pick",fg.prototype.vf);function ig(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new L(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Lc(c.ub(e.Na(d)),e))}this.n=[];for(var a=a||{},c=new L(a.lb||[0,0,0]),d=a.xa||1,e=a.Za||16,a=a.Qh||8,f=[],g,i=0;i<e;i++)for(var k=0;k<a;k++)g=[],b(i/e,k/a),0<k&&b((i+1)/e,k/a),k<a-1&&b((i+1)/e,(k+1)/a),b(i/e,(k+1)/a),f.push(new Pc(g));return Rc(f)}F(ig,O);A("CSG.sphere",ig);function jg(a,b){(!x(a)||!(a instanceof Array)||3!=a.length)&&h(Error("Invalid center."));z(b)||h(Error("Invalid radius."));U.call(this);this.className="Sphere";this.m=a;this.vd=b;this.wd=32;this.Xf=16;this.sa()}F(jg,U);jg.prototype.sa=function(){rd(this,new ig({lb:this.m,xa:this.vd,Za:this.wd,Qh:this.Xf}))};A("X.sphere",jg);function kg(a){this.n=[];var a=a||{},b=new L(a.lb||[0,0,0]),c=!a.xa?[1,1,1]:a.xa.length?a.xa:[a.xa,a.xa,a.xa];return Rc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Pc(a[0].map(function(e){e=new L(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Lc(e,new L(a[1]))}))}))}F(kg,O);A("CSG.cube",kg);function lg(a,b,c,d){(!x(a)||!(a instanceof Array)||3!=a.length)&&h(Error("Invalid center."));(!z(b)||!z(c)||!z(d))&&h(Error("Invalid radii."));U.call(this);this.className="cube";this.m=a;this.Uf=b;this.Vf=c;this.Wf=d;this.jb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];this.sa()}F(lg,U);lg.prototype.sa=function(){rd(this,new kg({lb:this.m,xa:[this.Uf,this.Vf,this.Wf]}))};A("X.cube",lg);function mg(a,b){Bf.call(this,a);this.className="renderer2D";this.orientation=b;this.scale=1;this.Ke=this.Id=r;this.je=this.ke=0}F(mg,Bf);v=mg.prototype;v.ae=function(a){mg.g.ae.call(this,a);var b=this.$a[0];if(b){var c=this.orientation,d=0;"Y"==c?d=1:"Z"==c&&(d=2);a.W?b["_index"+c]<b.S[d]-1&&(b["_index"+c]+=1):0<b["_index"+c]&&(b["_index"+c]-=1);this.ha(s,s)}};v.R=function(){mg.g.R.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.width,this.height);this.Id=Yd("canvas")};
v.oc=function(){mg.g.oc.call(this);ng(this);this.ha(s,s)};v.ab=function(a){mg.g.ab.call(this,a);var b=s;this.get(a._id)&&(b=p);var c=a.k;if(x(c)&&c.c)Fe(this.K,a);else{"X"==this.orientation?this.Za=a.gb.children():"Y"==this.orientation?this.Za=a.hb.children():"Z"==this.orientation&&(this.Za=a.ib.children());var d=this.Za[0],c=d.kb+1,d=d.eb+1;if("X"==this.orientation)var e=d,d=c,c=e;this.ke=c;this.je=d;e=this.Id;e.width=c;e.height=d;this.Ke=e.getContext("2d");b||(this.La.add(a),ng(this))}};
function ng(a){var b=Math.min(a.width/a.ke,a.height/a.je);S(a.camera.view,2,3,10*b-10)}
v.ha=function(a,b){mg.g.ha.call(this,a,b);if(0!=this.La.u.length){var c=this.width,d=this.height,e=this.camera.view;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.C(0,3),g=-1*e.C(1,3),i=Math.max(1+e.C(2,3)/10,0.6);this.a.setTransform(i,0,0,i,f,g);var k=this.$a[0],e=this.Za[parseInt(k["_index"+this.orientation],10)].M.Bb,o=this.ke,j=this.je,c=1/(2*i)*(c-o*i)+f,d=1/(2*i)*(d-j*i)+g,g=this.Ke,o=g.getImageData(0,0,o,j),j=o.data,f=j.length,i=k.Ha[1],m=k._lowerThreshold,k=k._upperThreshold,
l=0;do{var q=[0,0,0,0],u=e[l]/255*i;u>=m&&u<=k&&(q=[e[l],e[l+1],e[l+2],e[l+3]]);u=f-1-l;j[u-3]=q[0];j[u-2]=q[1];j[u-1]=q[2];j[u]=q[3];l+=4}while(l<f);g.putImageData(o,0,0);this.a.drawImage(this.Id,c,d)}};A("X.renderer2D",mg);A("X.renderer2D.prototype.init",mg.prototype.R);A("X.renderer2D.prototype.add",mg.prototype.add);A("X.renderer2D.prototype.onShowtime",mg.prototype.of);A("X.renderer2D.prototype.get",mg.prototype.get);A("X.renderer2D.prototype.resetViewAndRender",mg.prototype.oc);
A("X.renderer2D.prototype.render",mg.prototype.Ob);A("X.renderer2D.prototype.destroy",mg.prototype.Nc);
