/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var o=void 0,q=!0,r=null,s=!1;function aa(){return function(){}}function ca(a){return function(b){this[a]=b}}function t(a){return function(){return this[a]}}var v,da=this;function ea(){}
function fa(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ia(a){return a!==o}function x(a){return a!=r}function ja(a){return"array"==fa(a)}function la(a){var b=fa(a);return"array"==b||"object"==b&&"number"==typeof a.length}function z(a){return"string"==typeof a}function E(a){return"number"==typeof a}function ma(a){return"function"==fa(a)}function na(a){a=fa(a);return"object"==a||"array"==a||"function"==a}function oa(a){return a[pa]||(a[pa]=++qa)}
var pa="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),qa=0;function ta(a,b,c){return a.call.apply(a.bind,arguments)}function va(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function wa(a,b,c){wa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:va;return wa.apply(r,arguments)}function xa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var ya=Date.now||function(){return+new Date};
function F(a,b){var c=a.split("."),d=da;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ia(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function G(a,b){function c(){}c.prototype=b.prototype;a.i=b.prototype;a.prototype=new c};window["X.counter"]=new function(){this.Zf=0;this.Kh=function(){return this.Zf++}};function Ba(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});F("Function.prototype.bind",Function.prototype.bind);function Ca(a){if(!Da.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ea,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Fa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ga,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ha,"&quot;"));return a}var Ea=/&/g,Fa=/</g,Ga=/>/g,Ha=/\"/g,Da=/[&<>\"]/;var Ia,Ja,Ka,La,Ma,Na,Oa;function Pa(){return da.navigator?da.navigator.userAgent:r}function Qa(){return da.navigator}Ma=La=Ka=Ja=Ia=s;var Ra;if(Ra=Pa()){var Wa=Qa();Ia=0==Ra.indexOf("Opera");Ja=!Ia&&-1!=Ra.indexOf("MSIE");La=(Ka=!Ia&&-1!=Ra.indexOf("WebKit"))&&-1!=Ra.indexOf("Mobile");Ma=!Ia&&!Ka&&"Gecko"==Wa.product}var Xa=Ia,I=Ja,Ya=Ma,Za=Ka,$a=La,ab,bb=Qa();ab=bb&&bb.platform||"";Na=-1!=ab.indexOf("Mac");Oa=-1!=ab.indexOf("Win");var cb=!!Qa()&&-1!=(Qa().appVersion||"").indexOf("X11"),db;
a:{var eb="",fb;if(Xa&&da.opera)var gb=da.opera.version,eb="function"==typeof gb?gb():gb;else if(Ya?fb=/rv\:([^\);]+)(\)|;)/:I?fb=/MSIE\s+([^\);]+)(\)|;)/:Za&&(fb=/WebKit\/(\S+)/),fb)var hb=fb.exec(Pa()),eb=hb?hb[1]:"";if(I){var ib,jb=da.document;ib=jb?jb.documentMode:o;if(ib>parseFloat(eb)){db=""+ib;break a}}db=eb}var mb={};
function nb(a){var b;if(!(b=mb[a])){b=0;for(var c=(""+db).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),n=RegExp("(\\d*)(\\D*)","g");do{var k=j.exec(g)||["","",""],m=n.exec(h)||["","",""];if(0==k[0].length&&0==m[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==m[1].length?0:parseInt(m[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==m[1].length?0:parseInt(m[1],10))?1:0)||((0==k[2].length)<(0==m[2].length)?-1:(0==k[2].length)>(0==m[2].length)?1:0)||(k[2]<m[2]?-1:k[2]>m[2]?1:0)}while(0==b)}b=mb[a]=0<=b}return b}var ob={};function pb(a){return ob[a]||(ob[a]=I&&document.documentMode&&document.documentMode>=a)};function qb(a,b){for(var c in a)b.call(o,a[c],c,a)}function rb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function sb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var tb="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function ub(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<tb.length;f++)c=tb[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var vb=Array.prototype,wb=vb.indexOf?function(a,b,c){return vb.indexOf.call(a,b,c)}:function(a,b,c){c=c==r?0:0>c?Math.max(0,a.length+c):c;if(z(a))return!z(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},xb=vb.forEach?function(a,b,c){vb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=z(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},yb=vb.map?function(a,b,c){return vb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=z(a)?
a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Bb=vb.some?function(a,b,c){return vb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=z(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return q;return s},Cb=vb.every?function(a,b,c){return vb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=z(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return s;return q};function Db(a,b){var c=wb(a,b);0<=c&&vb.splice.call(a,c,1)}
function Eb(a){return vb.concat.apply(vb,arguments)}function Fb(a){if(ja(a))return Eb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Gb(a,b,c){return 2>=arguments.length?vb.slice.call(a,b):vb.slice.call(a,b,c)};function Hb(a){if("function"==typeof a.ba)a=a.ba();else if(la(a)||z(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Ib(a){if("function"==typeof a.tb)return a.tb();if(z(a))return a.split("");if(la(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return rb(a)}
function Jb(a,b){if("function"==typeof a.every)return a.every(b,o);if(la(a)||z(a))return Cb(a,b,o);var c;if("function"==typeof a.oc)c=a.oc();else if("function"!=typeof a.tb)if(la(a)||z(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=sb(a);else c=o;for(var d=Ib(a),e=d.length,f=0;f<e;f++)if(!b.call(o,d[f],c&&c[f],a))return s;return q};var Kb="StopIteration"in da?da.StopIteration:Error("StopIteration");function Lb(){}Lb.prototype.next=function(){i(Kb)};Lb.prototype.$b=function(){return this};function Mb(a){if(a instanceof Lb)return a;if("function"==typeof a.$b)return a.$b(s);if(la(a)){var b=0,c=new Lb;c.next=function(){for(;;){b>=a.length&&i(Kb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Nb(a,b){if(la(a))try{xb(a,b,o)}catch(c){c!==Kb&&i(c)}else{a=Mb(a);try{for(;;)b.call(o,a.next(),o,a)}catch(d){d!==Kb&&i(d)}}};function Ob(a,b){this.u={};this.q=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.Id(a)}v=Ob.prototype;v.z=0;v.Hc=0;v.ba=t("z");v.tb=function(){Pb(this);for(var a=[],b=0;b<this.q.length;b++)a.push(this.u[this.q[b]]);return a};v.oc=function(){Pb(this);return this.q.concat()};v.Md=function(a){for(var b=0;b<this.q.length;b++){var c=this.q[b];if(Qb(this.u,c)&&this.u[c]==a)return q}return s};
v.kc=function(a,b){if(this===a)return q;if(this.z!=a.ba())return s;var c=b||Rb;Pb(this);for(var d,e=0;d=this.q[e];e++)if(!c(this.get(d),a.get(d)))return s;return q};function Rb(a,b){return a===b}v.clear=function(){this.u={};this.Hc=this.z=this.q.length=0};v.remove=function(a){return Qb(this.u,a)?(delete this.u[a],this.z--,this.Hc++,this.q.length>2*this.z&&Pb(this),q):s};
function Pb(a){if(a.z!=a.q.length){for(var b=0,c=0;b<a.q.length;){var d=a.q[b];Qb(a.u,d)&&(a.q[c++]=d);b++}a.q.length=c}if(a.z!=a.q.length){for(var e={},c=b=0;b<a.q.length;)d=a.q[b],Qb(e,d)||(a.q[c++]=d,e[d]=1),b++;a.q.length=c}}v.get=function(a,b){return Qb(this.u,a)?this.u[a]:b};v.set=function(a,b){Qb(this.u,a)||(this.z++,this.q.push(a),this.Hc++);this.u[a]=b};v.Id=function(a){var b;a instanceof Ob?(b=a.oc(),a=a.tb()):(b=sb(a),a=rb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};v.d=function(){return new Ob(this)};
v.$b=function(a){Pb(this);var b=0,c=this.q,d=this.u,e=this.Hc,f=this,g=new Lb;g.next=function(){for(;;){e!=f.Hc&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Kb);var g=c[b++];return a?g:d[g]}};return g};function Qb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Sb(a){this.u=new Ob;a&&this.Id(a)}function Tb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+oa(a):b.substr(0,1)+a}v=Sb.prototype;v.ba=function(){return this.u.ba()};v.add=function(a){this.u.set(Tb(a),a)};v.Id=function(a){for(var a=Ib(a),b=a.length,c=0;c<b;c++)this.add(a[c])};v.sd=function(a){for(var a=Ib(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};v.remove=function(a){return this.u.remove(Tb(a))};v.clear=function(){this.u.clear()};
v.contains=function(a){a=Tb(a);return Qb(this.u.u,a)};v.df=function(a){for(var b=new Sb,a=Ib(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};v.tb=function(){return this.u.tb()};v.d=function(){return new Sb(this)};v.kc=function(a){return this.ba()==Hb(a)&&Ub(this,a)};
function Ub(a,b){var c=Hb(b);if(a.ba()>c)return s;!(b instanceof Sb)&&5<c&&(b=new Sb(b));return Jb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.Md)a=b.Md(a);else if(la(b)||z(b))a=0<=wb(b,a);else a:{for(var c in b)if(b[c]==a){a=q;break a}a=s}return a})}v.$b=function(){return this.u.$b(s)};function Vb(){}Vb.prototype.Qe=s;Vb.prototype.pa=function(){this.Qe||(this.Qe=q,this.A())};Vb.prototype.A=function(){this.ig&&Wb.apply(r,this.ig)};function Xb(a){a&&"function"==typeof a.pa&&a.pa()}function Wb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];la(d)?Wb.apply(r,d):Xb(d)}};function Yb(a,b){this.jf=b;this.nc=[];a>this.jf&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.nc.push(this.Wc())}G(Yb,Vb);v=Yb.prototype;v.Ne=r;v.Pe=r;function Zb(a,b){a.nc.length<a.jf?a.nc.push(b):a.Pd(b)}v.Wc=function(){return this.Ne?this.Ne():{}};v.Pd=function(a){if(this.Pe)this.Pe(a);else if(na(a))if(ma(a.pa))a.pa();else for(var b in a)delete a[b]};v.A=function(){Yb.i.A.call(this);for(var a=this.nc;a.length;)this.Pd(a.pop());delete this.nc};function $b(){this.lc=[];this.me=new Ob;this.Qf=this.Rf=this.Sf=this.Nf=0;this.Fc=new Ob;this.Ke=this.Pf=0;this.ee=1;this.Qd=new Yb(0,4E3);this.Qd.Wc=function(){return new ac};this.Of=new Yb(0,50);this.Of.Wc=function(){return new bc};var a=this;this.Vd=new Yb(0,2E3);this.Vd.Wc=function(){return""+a.ee++};this.Vd.Pd=aa()}function bc(){this.Ae=this.time=this.count=0}
bc.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.Ae&&a.push(" [VarAlloc = ",this.Ae,"]");return a.join("")};function ac(){}function cc(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(dc(a.Se-c));e.push(" ",ec(a.Se-b));0==a.Rd?e.push(" Start        "):1==a.Rd?(e.push(" Done "),e.push(dc(a.zi-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.Gh&&e.push("[VarAlloc ",a.Gh,"] ");return e.join("")}
ac.prototype.toString=function(){return this.type==r?this.hg:"["+this.type+"] "+this.hg};$b.prototype.reset=function(){for(var a=0;a<this.lc.length;a++){var b=this.Qd.id;b&&Zb(this.Vd,b);Zb(this.Qd,this.lc[a])}this.lc.length=0;this.me.clear();this.Nf=ya();this.Ke=this.Pf=this.Qf=this.Rf=this.Sf=0;b=this.Fc.oc();for(a=0;a<b.length;a++){var c=this.Fc.get(b[a]);c.count=0;c.time=0;c.Ae=0;Zb(this.Of,c)}this.Fc.clear()};
$b.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.lc.length;d++){var e=this.lc[d];1==e.Rd&&c.pop();a.push(" ",cc(e,this.Nf,b,c.join("")));b=e.Se;a.push("\n");0==e.Rd&&c.push("|  ")}if(0!=this.me.ba()){var f=ya();a.push(" Unstopped timers:\n");Nb(this.me,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",ec(b.startTime),")\n")})}b=this.Fc.oc();for(d=0;d<b.length;d++)c=this.Fc.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.Pf,"\n","Total comments created ",
this.Ke,"\n","Overhead start: ",this.Sf," ms\n","Overhead end: ",this.Rf," ms\n","Overhead comment: ",this.Qf," ms\n");return a.join("")};function dc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function ec(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new $b;function fc(){}var gc=0;v=fc.prototype;v.key=0;v.Vb=s;v.Kd=s;v.V=function(a,b,c,d,e,f){ma(a)?this.ef=q:a&&a.handleEvent&&ma(a.handleEvent)?this.ef=s:i(Error("Invalid listener argument"));this.qc=a;this.Hf=b;this.src=c;this.type=d;this.capture=!!e;this.Td=f;this.Kd=s;this.key=++gc;this.Vb=s};v.handleEvent=function(a){return this.ef?this.qc.call(this.Td||this.src,a):this.qc.handleEvent.call(this.qc,a)};!I||pb(9);var hc=!I||pb(9),ic=I&&!nb("8");!Za||nb("528");Ya&&nb("1.9b")||I&&nb("8")||Xa&&nb("9.5")||Za&&nb("528");!Ya||nb("8");function jc(a,b){this.type=a;this.currentTarget=this.target=b}G(jc,Vb);v=jc.prototype;v.A=function(){delete this.type;delete this.target;delete this.currentTarget};v.zb=s;v.Bc=q;v.stopPropagation=function(){this.zb=q};v.preventDefault=function(){this.Bc=s};function kc(a){kc[" "](a);return a}kc[" "]=ea;function lc(a,b){a&&this.V(a,b)}G(lc,jc);v=lc.prototype;v.target=r;v.relatedTarget=r;v.offsetX=0;v.offsetY=0;v.clientX=0;v.clientY=0;v.screenX=0;v.screenY=0;v.button=0;v.keyCode=0;v.charCode=0;v.ctrlKey=s;v.altKey=s;v.shiftKey=s;v.metaKey=s;v.ya=r;
v.V=function(a,b){var c=this.type=a.type;jc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Ya){var e;a:{try{kc(d.nodeName);e=q;break a}catch(f){}e=s}e||(d=r)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Za||a.offsetX!==o?a.offsetX:a.layerX;this.offsetY=Za||a.offsetY!==o?a.offsetY:a.layerY;this.clientX=a.clientX!==o?a.clientX:a.pageX;this.clientY=a.clientY!==o?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.ya=a;delete this.Bc;delete this.zb};v.stopPropagation=function(){lc.i.stopPropagation.call(this);this.ya.stopPropagation?this.ya.stopPropagation():this.ya.cancelBubble=q};
v.preventDefault=function(){lc.i.preventDefault.call(this);var a=this.ya;if(a.preventDefault)a.preventDefault();else if(a.returnValue=s,ic)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};v.rg=t("ya");v.A=function(){lc.i.A.call(this);this.relatedTarget=this.currentTarget=this.target=this.ya=r};var mc={},nc={},oc={},pc={};
function J(a,b,c,d,e){if(b){if(ja(b)){for(var f=0;f<b.length;f++)J(a,b[f],c,d,e);return r}var d=!!d,g=nc;b in g||(g[b]={z:0,ja:0});g=g[b];d in g||(g[d]={z:0,ja:0},g.z++);var g=g[d],h=oa(a),j;g.ja++;if(g[h]){j=g[h];for(f=0;f<j.length;f++)if(g=j[f],g.qc==c&&g.Td==e){if(g.Vb)break;return j[f].key}}else j=g[h]=[],g.z++;f=qc();f.src=a;g=new fc;g.V(c,f,a,b,d,e);c=g.key;f.key=c;j.push(g);mc[c]=g;oc[h]||(oc[h]=[]);oc[h].push(g);a.addEventListener?(a==da||!a.Oe)&&a.addEventListener(b,f,d):a.attachEvent(b in
pc?pc[b]:pc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function qc(){var a=rc,b=hc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function tc(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)tc(a,b[f],c,d,e);else a=J(a,b,c,d,e),mc[a].Kd=q}
function uc(a,b,c,d,e){if(ja(b))for(var f=0;f<b.length;f++)uc(a,b[f],c,d,e);else{d=!!d;a:{f=nc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=oa(a),f[a]))){a=f[a];break a}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].qc==c&&a[f].capture==d&&a[f].Td==e){vc(a[f].key);break}}}
function vc(a){if(!mc[a])return s;var b=mc[a];if(b.Vb)return s;var c=b.src,d=b.type,e=b.Hf,f=b.capture;c.removeEventListener?(c==da||!c.Oe)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in pc?pc[d]:pc[d]="on"+d,e);c=oa(c);e=nc[d][f][c];if(oc[c]){var g=oc[c];Db(g,b);0==g.length&&delete oc[c]}b.Vb=q;e.sf=q;wc(d,f,c,e);delete mc[a];return q}
function wc(a,b,c,d){if(!d.ld&&d.sf){for(var e=0,f=0;e<d.length;e++)d[e].Vb?d[e].Hf.src=r:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.sf=s;0==f&&(delete nc[a][b][c],nc[a][b].z--,0==nc[a][b].z&&(delete nc[a][b],nc[a].z--),0==nc[a].z&&delete nc[a])}}function xc(a){var b,c=0,d=b==r;b=!!b;if(a==r)qb(oc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)vc(f.key),c++}});else if(a=oa(a),oc[a])for(var a=oc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)vc(f.key),c++}}
function yc(a){var b=zc,a=oa(a),c=oc[a];if(c){var d=ia(b),e=ia(o);return d&&e?(c=nc[b],!!c&&!!c[o]&&a in c[o]):!d&&!e?q:Bb(c,function(a){return d&&a.type==b||e&&a.capture==o})}return s}function Ac(a,b,c,d,e){var f=1,b=oa(b);if(a[b]){a.ja--;a=a[b];a.ld?a.ld++:a.ld=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.Vb&&(f&=Bc(j,e)!==s)}}finally{a.ld--,wc(c,d,b,a)}}return Boolean(f)}function Bc(a,b){var c=a.handleEvent(b);a.Kd&&vc(a.key);return c}
function rc(a,b){if(!mc[a])return q;var c=mc[a],d=c.type,e=nc;if(!(d in e))return q;var e=e[d],f,g;if(!hc){var h;if(!(h=b))a:{h=["window","event"];for(var j=da;f=h.shift();)if(x(j[f]))j=j[f];else{h=r;break a}h=j}f=h;h=q in e;j=s in e;if(h){if(0>f.keyCode||f.returnValue!=o)return q;a:{var n=s;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(k){n=q}if(n||f.returnValue==o)f.returnValue=q}}n=new lc;n.V(f,this);f=q;try{if(h){for(var m=[],l=n.currentTarget;l;l=l.parentNode)m.push(l);g=e[q];g.ja=g.z;for(var p=
m.length-1;!n.zb&&0<=p&&g.ja;p--)n.currentTarget=m[p],f&=Ac(g,m[p],d,q,n);if(j){g=e[s];g.ja=g.z;for(p=0;!n.zb&&p<m.length&&g.ja;p++)n.currentTarget=m[p],f&=Ac(g,m[p],d,s,n)}}else f=Bc(c,n)}finally{m&&(m.length=0),n.pa()}return f}d=new lc(b,this);try{f=Bc(c,d)}finally{d.pa()}return f}var Cc=0;function Dc(a){return a+"_"+Cc++};function K(a,b,c){this.ha=this.ga=this.fa=0;3==arguments.length?(this.fa=Number(a),this.ga=Number(b),this.ha=Number(c)):"x"in a&&"y"in a&&"z"in a?(this.fa=Number(a.x()),this.ga=Number(a.y()),this.ha=Number(a.b())):(this.fa=Number(a[0]),this.ga=Number(a[1]),this.ha=Number(a[2]))}
K.prototype={d:function(){return new K(this.fa,this.ga,this.ha)},nd:function(){return new K(-this.fa,-this.ga,-this.ha)},yb:function(a){return new K(this.fa+a.x(),this.ga+a.y(),this.ha+a.b())},Rb:function(a){return new K(this.fa-a.x(),this.ga-a.y(),this.ha-a.b())},Ma:function(a){return new K(this.fa*a,this.ga*a,this.ha*a)},Re:function(a){return new K(this.fa/a,this.ga/a,this.ha/a)},rb:function(a){return this.fa*a.x()+this.ga*a.y()+this.ha*a.b()},ae:function(a,b){return this.yb(a.Rb(this).Ma(b))},
length:function(){return Math.sqrt(this.rb(this))},Yb:function(){return this.Re(this.length())},Xc:function(a){return new K(this.ga*a.b()-this.ha*a.y(),this.ha*a.x()-this.fa*a.b(),this.fa*a.y()-this.ga*a.x())},x:t("fa"),y:t("ga"),b:t("ha")};F("csgVector",K);F("csgVector.prototype.clone",K.prototype.d);F("csgVector.prototype.plus",K.prototype.yb);F("csgVector.prototype.minus",K.prototype.Rb);F("csgVector.prototype.dividedBy",K.prototype.Re);F("csgVector.prototype.times",K.prototype.Ma);
F("csgVector.prototype.dot",K.prototype.rb);F("csgVector.prototype.lerp",K.prototype.ae);F("csgVector.prototype.length",K.prototype.length);F("csgVector.prototype.unit",K.prototype.Yb);F("csgVector.prototype.cross",K.prototype.Xc);F("csgVector.prototype.negated",K.prototype.nd);F("csgVector.prototype.x",K.prototype.x);F("csgVector.prototype.y",K.prototype.y);F("csgVector.prototype.z",K.prototype.b);function Ec(){this.td=o}
function Fc(a,b,c){switch(typeof b){case "string":Gc(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(b==r){c.push("null");break}if(ja(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],Fc(a,a.td?a.td.call(b,""+f,e):e,c),e=",";c.push("]");break}c.push("{");d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&(e=b[f],"function"!=typeof e&&(c.push(d),Gc(f,c),c.push(":"),
Fc(a,a.td?a.td.call(b,f,e):e,c),d=","));c.push("}");break;case "function":break;default:i(Error("Unknown type: "+typeof b))}}var Hc={'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Ic=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;
function Gc(a,b){b.push('"',a.replace(Ic,function(a){if(a in Hc)return Hc[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Hc[a]=e+b.toString(16)}),'"')};function Jc(){}G(Jc,Vb);v=Jc.prototype;v.Oe=q;v.od=r;v.qe=ca("od");v.addEventListener=function(a,b,c,d){J(this,a,b,c,d)};v.removeEventListener=function(a,b,c,d){uc(this,a,b,c,d)};
v.dispatchEvent=function(a){var b=a.type||a,c=nc;if(b in c){if(z(a))a=new jc(a,this);else if(a instanceof jc)a.target=a.target||this;else{var d=a,a=new jc(b,this);ub(a,d)}var d=1,e,c=c[b],b=q in c,f;if(b){e=[];for(f=this;f;f=f.od)e.push(f);f=c[q];f.ja=f.z;for(var g=e.length-1;!a.zb&&0<=g&&f.ja;g--)a.currentTarget=e[g],d&=Ac(f,e[g],a.type,q,a)&&a.Bc!=s}if(s in c)if(f=c[s],f.ja=f.z,b)for(g=0;!a.zb&&g<e.length&&f.ja;g++)a.currentTarget=e[g],d&=Ac(f,e[g],a.type,s,a)&&a.Bc!=s;else for(e=this;!a.zb&&e&&
f.ja;e=e.od)a.currentTarget=e,d&=Ac(f,e,a.type,s,a)&&a.Bc!=s;a=Boolean(d)}else a=q;return a};v.A=function(){Jc.i.A.call(this);xc(this);this.od=r};function L(){this.f="base";this.I=window["X.counter"].Kh();this.c=s}G(L,Jc);L.prototype.__defineGetter__("classname",t("f"));L.prototype.__defineGetter__("id",t("I"));F("X.base",L);function Kc(){L.call(this);this.f="indexer";this.Hd=[];this.W={}}G(Kc,L);Kc.prototype.add=function(a){x(a)||i(Error("Invalid object."));var b;b=[];Fc(new Ec,a,b);b=b.join("");b in this.W||(this.W[b]=this.Hd.length,this.Hd.push(a));return this.W[b]};Kc.prototype.unique=t("Hd");function Lc(a,b){this.$=new K(a);this.F=new K(b)}Lc.prototype={d:function(){return new Lc(this.$.d(),this.F.d())},Ja:function(){this.F=this.F.nd()},cf:function(a,b){return new Lc(this.$.ae(a.$,b),this.F.ae(a.F,b))},eh:t("$"),fe:t("F")};F("csgVertex",Lc);F("csgVertex.prototype.clone",Lc.prototype.d);F("csgVertex.prototype.flip",Lc.prototype.Ja);F("csgVertex.prototype.interpolate",Lc.prototype.cf);F("csgVertex.prototype.pos",Lc.prototype.eh);F("csgVertex.prototype.normal",Lc.prototype.fe);function Mc(a){L.call(this);this.f="file";this.Sa=a;this.c=q}G(Mc,L);function Nc(){L.call(this);this.f="colortable";this.W=new Ob;this.e=r}G(Nc,L);Nc.prototype.add=function(a,b,c,d,e,f){(!E(a)||!E(c)||!E(d)||!E(e)||!E(f))&&i(Error("Invalid color table entry."));this.W.set(a,[b,c,d,e,f]);this.c=q};Nc.prototype.__defineGetter__("file",t("e"));Nc.prototype.__defineSetter__("file",function(a){x(a)?(z(a)&&(a=new Mc(a)),this.e=a):this.e=r});function Oc(a,b){this.F=a;this.Zb=b}Oc.prototype={d:function(){return new Oc(this.F.d(),this.Zb)},Ja:function(){this.F=this.F.nd();this.Zb=-this.Zb},Nh:t("Zb"),fe:t("F")};F("csgPlane.prototype.w",Oc.prototype.Nh);F("csgPlane.prototype.normal",Oc.prototype.fe);function Pc(a,b){this.Ea=a;this.Dc=b;var c=a[0].$,d=a[2].$,d=a[1].$.Rb(c).Xc(d.Rb(c)).Yb();this.ea=new Oc(d,d.rb(c))}
Pc.prototype={d:function(){var a=this.Ea.map(function(a){return a.d()});return new Pc(a,this.Dc)},Ja:function(){this.Ea.reverse().map(function(a){a.Ja()});this.ea.Ja()},Mh:t("Ea"),wh:t("Dc"),Mf:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.Ea.length;h++){var j=a.F.rb(this.Ea[h].$)-a.Zb,j=-1.0E-5>j?2:1.0E-5<j?1:0,f=f|j;g.push(j)}switch(f){case 0:(0<a.F.rb(this.ea.F)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.Ea.length;h++){var n=(h+1)%
this.Ea.length,j=g[h],k=g[n],f=this.Ea[h],n=this.Ea[n];2!=j&&b.push(f);1!=j&&c.push(2!=j?f.d():f);3==(j|k)&&(j=(a.Zb-a.F.rb(f.$))/a.F.rb(n.$.Rb(f.$)),j=f.cf(n,j),b.push(j),c.push(j.d()))}3<=b.length&&d.push(new Pc(b,this.Dc));3<=c.length&&e.push(new Pc(c,this.Dc))}}};F("csgPolygon",Pc);F("csgPolygon.prototype.clone",Pc.prototype.d);F("csgPolygon.prototype.flip",Pc.prototype.Ja);F("csgPolygon.prototype.vertices",Pc.prototype.Mh);F("csgPolygon.prototype.shared",Pc.prototype.wh);function Qc(a){this.P=this.Q=this.ea=r;this.o=[];a&&this.Lb(a)}
Qc.prototype={d:function(){var a=new Qc;a.rh(this.ea&&this.ea.d());a.qh(this.Q&&this.Q.d());a.mh(this.P&&this.P.d());a.Cc(this.o.map(function(a){return a.d()}));return a},M:function(){for(var a=0;a<this.o.length;a++)this.o[a].Ja();this.ea.Ja();this.Q&&this.Q.M();this.P&&this.P.M();a=this.Q;this.Q=this.P;this.P=a},Ld:function(a){if(!this.ea)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].Mf(this.ea,b,c,b,c);this.Q&&(b=this.Q.Ld(b));c=this.P?this.P.Ld(c):[];return b.concat(c)},oa:function(a){this.o=
a.Ld(this.o);this.Q&&this.Q.oa(a);this.P&&this.P.oa(a)},Xa:function(){var a=this.o.slice();this.Q&&(a=a.concat(this.Q.Xa()));this.P&&(a=a.concat(this.P.Xa()));return a},Lb:function(a){if(a.length){this.ea||(this.ea=a[0].ea.d());for(var b=[],c=[],d=0;d<a.length;d++)a[d].Mf(this.ea,this.o,this.o,b,c);b.length&&(this.Q||(this.Q=new Qc),this.Q.Lb(b));c.length&&(this.P||(this.P=new Qc),this.P.Lb(c))}},rh:ca("ea"),qh:ca("Q"),mh:ca("P"),Gf:t("o"),Cc:ca("o")};function M(){this.o=[]}function Rc(a){var b=new M;b.Cc(a);return b}
M.prototype={d:function(){var a=new M;a.Cc(this.o.map(function(a){return a.d()}));return a},Fh:t("o"),Ad:function(a){var b=new Qc(this.d().o),a=new Qc(a.d().o);b.oa(a);a.oa(b);a.M();a.oa(b);a.M();b.Lb(a.Xa());return Rc(b.Xa())},Ca:function(a){var b=new Qc(this.d().o),a=new Qc(a.d().o);b.M();b.oa(a);a.oa(b);a.M();a.oa(b);a.M();b.Lb(a.Xa());b.M();return Rc(b.Xa())},hd:function(a){var b=new Qc(this.d().o),a=new Qc(a.d().o);b.M();a.oa(b);a.M();b.oa(a);a.oa(b);b.Lb(a.Xa());b.M();return Rc(b.Xa())},inverse:function(){var a=
this.d();a.o.map(function(a){a.Ja()});return a},Gf:t("o"),Cc:ca("o")};F("CSG",M);F("CSG.fromPolygons",Rc);F("CSG.prototype.toPolygons",M.prototype.Fh);F("CSG.prototype.union",M.prototype.Ad);F("CSG.prototype.subtract",M.prototype.Ca);F("CSG.prototype.intersect",M.prototype.hd);F("CSG.prototype.inverse",M.prototype.inverse);F("CSG.prototype.polygons",M.prototype.Gf);F("CSG.prototype.setPolygons",M.prototype.Cc);function Sc(a,b,c){this.x=ia(a)?a:0;this.y=ia(b)?b:0;this.b=ia(c)?c:0}Sc.prototype.d=function(){return new Sc(this.x,this.y,this.b)};Sc.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.b+")"};Sc.prototype.ye=function(){return[this.x,this.y,this.b]};function O(a,b,c){this.x=a;this.y=b;this.b=c}G(O,Sc);v=O.prototype;v.d=function(){return new O(this.x,this.y,this.b)};v.wb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};v.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};v.M=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};v.normalize=function(){return this.scale(1/this.wb())};v.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
v.Ca=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};v.kc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Tc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Uc(a,b){return new O(a.x+b.x,a.y+b.y,a.b+b.b)}function Xc(a,b){return new O(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Yc(a,b){this.x=ia(a)?a:0;this.y=ia(b)?b:0}Yc.prototype.d=function(){return new Yc(this.x,this.y)};Yc.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Zc(a,b){return new Yc(a.x-b.x,a.y-b.y)};function $c(a,b){this.x=a;this.y=b}G($c,Yc);v=$c.prototype;v.d=function(){return new $c(this.x,this.y)};v.wb=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};v.scale=function(a){this.x*=a;this.y*=a;return this};v.M=function(){this.x=-this.x;this.y=-this.y;return this};v.normalize=function(){return this.scale(1/this.wb())};v.add=function(a){this.x+=a.x;this.y+=a.y;return this};v.Ca=function(a){this.x-=a.x;this.y-=a.y;return this};
v.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};v.kc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function ad(a,b){this.width=a;this.height=b}function bd(a,b){return a==b?q:!a||!b?s:a.width==b.width&&a.height==b.height}v=ad.prototype;v.d=function(){return new ad(this.width,this.height)};v.toString=function(){return"("+this.width+" x "+this.height+")"};v.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};v.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
v.scale=function(a){this.width*=a;this.height*=a;return this};function cd(a,b){if(a instanceof cd)this.C=a.ye();else{var c;if(c=la(a))a:{for(var d=c=0;d<a.length;d++){if(!la(a[d])||0<c&&a[d].length!=c){c=s;break a}for(var e=0;e<a[d].length;e++)if(!E(a[d][e])){c=s;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.C=Fb(a):a instanceof ad?this.C=dd(a.height,a.width):E(a)&&E(b)&&0<a&&0<b?this.C=dd(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.v=new ad(this.C[0].length,this.C.length)}
function ed(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new cd(b)}function fd(a,b,c){for(var d=0;d<a.ca().height;d++)for(var e=0;e<a.ca().width;e++)b.call(c,a.C[d][e],d,e,a)}function gd(a,b){var c=new cd(a.ca());fd(a,function(d,e,f){c.C[e][f]=b.call(o,d,e,f,a)});return c}function dd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}v=cd.prototype;
v.add=function(a){bd(this.v,a.ca())||i(Error("Matrix summation is only supported on arrays of equal size"));return gd(this,function(b,c,d){return b+a.C[c][d]})};v.kc=function(a,b){if(this.v.width!=a.v.width||this.v.height!=a.v.height)return s;for(var c=b||0,d=0;d<this.v.height;d++)for(var e=0;e<this.v.width;e++)if(!(Math.abs(this.C[d][e]-a.C[d][e])<=(c||1.0E-6)))return s;return q};v.ca=t("v");v.D=function(a,b){return!(0<=a&&a<this.v.height&&0<=b&&b<this.v.width)?r:this.C[a][b]};
function Q(a,b,c,d){0<=b&&b<a.v.height&&0<=c&&c<a.v.width||i(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.v.height+","+a.v.width+")"));a.C[b][c]=d}v.multiply=function(a){if(a instanceof cd)return this.v.width!=a.ca().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),hd(this,a);if(E(a))return id(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
v.Ca=function(a){bd(this.v,a.ca())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return gd(this,function(b,c,d){return b-a.C[c][d]})};v.ye=t("C");v.toString=function(){var a=0;fd(this,function(b){b=(""+b).length;b>a&&(a=b)});var b=[];xb(this.C,function(c){b.push("[ ");xb(c,function(c){c=""+c;b.push(Array(a-c.length+1).join(" ")+c+" ")});b.push("]\n")});return b.join("")};
function hd(a,b){var c=new cd(a.v.height,b.ca().width);fd(c,function(a,e,f){for(var g=a=0;g<this.v.width;g++)a+=this.D(e,g)*b.D(g,f);Q(c,e,f,a)},a);return c}function id(a,b){return gd(a,function(a){return a*b})};function S(a,b){cd.call(this,a,b);this.f="matrix"}G(S,cd);function jd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new S(b)}v=S.prototype;v.L=function(){var a=[],b=this.ca();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.D(c,d));return a};
v.translate=function(a){this.v.width!=this.v.height&&i(Error("Can not translate non-square matrix."));var b=this.ca(),c=ed(b.height);a instanceof $c&&3==b.height?(Q(c,0,2,a.x),Q(c,1,2,a.y)):a instanceof O&&4==b.height?(Q(c,0,3,a.x),Q(c,1,3,a.y),Q(c,2,3,a.b)):i(Error("Translation failed."));return new S(this.multiply(c))};
v.rotate=function(a,b){(4!=this.ca().height||this.v.width!=this.v.height)&&i(Error("Only 4x4 matrices can be rotated."));(!x(b)||!(b instanceof O))&&i(Error("Invalid axis vector."));E(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=ed(4);Q(f,0,0,d+c.x*c.x*(1-d));Q(f,0,1,c.x*c.y*(1-d)-c.b*e);Q(f,0,2,c.x*c.b*(1-d)+c.y*e);Q(f,1,0,c.y*c.x*(1-d)+c.b*e);Q(f,1,1,d+c.y*c.y*(1-d));Q(f,1,2,c.y*c.b*(1-d)-c.x*e);Q(f,2,0,c.b*c.x*(1-d)-c.y*e);Q(f,2,1,c.b*c.y*(1-d)+c.x*e);Q(f,2,
2,d+c.b*c.b*(1-d));return new S(this.multiply(f))};v.sa=function(a){var b=this.ca(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof O&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new cd(c));return new O(parseFloat(a.D(0,0)),parseFloat(a.D(1,0)),parseFloat(a.D(2,0)))};v.Eh=function(a,b){var c=this.C[a];this.C[a]=this.C[b];this.C[b]=c};
v.Dh=function(a,b){for(var c=this.ca(),d=0,d=0;d<c.height;d++){var e=this.D(d,a);e||(e=0);var f=this.D(d,b);f||(f=0);Q(this,d,a,f);Q(this,d,b,e)}};F("X.matrix",S);F("X.matrix.createIdentityMatrix",jd);F("X.matrix.prototype.flatten",S.prototype.L);F("X.matrix.prototype.translate",S.prototype.translate);F("X.matrix.prototype.rotate",S.prototype.rotate);F("X.matrix.prototype.toArray",S.prototype.ye);F("X.matrix.prototype.getValueAt",S.prototype.D);F("X.matrix.prototype.multiplyByVector",S.prototype.sa);
F("X.matrix.prototype.swapRows",S.prototype.Eh);F("X.matrix.prototype.swapCols",S.prototype.Dh);function kd(){L.call(this);this.f="transform";this.l=jd(4);this.Fa=new Float32Array(this.l.L())}G(kd,L);kd.prototype.__defineGetter__("matrix",t("l"));kd.prototype.__defineSetter__("matrix",function(a){(!x(a)||!(a instanceof S))&&i(Error("Invalid matrix."));this.l=a;this.Fa=new Float32Array(this.l.L());this.c=q});v=kd.prototype;v.hh=function(a){(!E(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.l=this.l.rotate(a*Math.PI/180,new O(0,1,0));this.Fa=new Float32Array(this.l.L());this.c=q};
v.ih=function(a){(!E(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.l=this.l.rotate(a*Math.PI/180,new O(1,0,0));this.Fa=new Float32Array(this.l.L());this.c=q};v.jh=function(a){(!E(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.l=this.l.rotate(a*Math.PI/180,new O(0,0,1));this.Fa=new Float32Array(this.l.L());this.c=q};v.Hh=function(a){E(a)||i(Error("Invalid distance."));this.l=this.l.translate(new O(a,0,0));this.Fa=new Float32Array(this.l.L());this.c=q};
v.Ih=function(a){E(a)||i(Error("Invalid distance."));this.l=this.l.translate(new O(0,a,0));this.Fa=new Float32Array(this.l.L());this.c=q};v.Jh=function(a){E(a)||i(Error("Invalid distance."));this.l=this.l.translate(new O(0,0,a));this.Fa=new Float32Array(this.l.L());this.c=q};function ld(a,b,c){var d=a.l.D(b,c);d||(d=0);Q(a.l,b,c,-1*d);a.Fa=new Float32Array(a.l.L());a.c=q}v.og=function(){ld(this,0,0)};v.pg=function(){ld(this,1,1)};v.qg=function(){ld(this,2,2)};F("X.transform",kd);
F("X.transform.prototype.rotateX",kd.prototype.hh);F("X.transform.prototype.rotateY",kd.prototype.ih);F("X.transform.prototype.rotateZ",kd.prototype.jh);F("X.transform.prototype.translateX",kd.prototype.Hh);F("X.transform.prototype.translateY",kd.prototype.Ih);F("X.transform.prototype.translateZ",kd.prototype.Jh);F("X.transform.prototype.flipX",kd.prototype.og);F("X.transform.prototype.flipY",kd.prototype.pg);F("X.transform.prototype.flipZ",kd.prototype.qg);function md(){L.call(this);this.f="texture";this.Va=this.De=this.e=r;this.Oc=this.Pc=0}G(md,L);md.prototype.__defineGetter__("file",t("e"));md.prototype.__defineSetter__("file",function(a){x(a)?(z(a)&&(a=new Mc(a)),this.e=a):this.e=r});F("X.texture",md);function T(a){L.call(this);this.f="triplets";this.ib=Infinity;this.fb=-Infinity;this.jb=Infinity;this.gb=-Infinity;this.kb=Infinity;this.hb=-Infinity;this.Jc=[0,0,0];this.U=[];x(a)&&(this.U=a.U.slice(),this.ib=a.ib,this.fb=a.fb,this.jb=a.jb,this.gb=a.gb,this.kb=a.kb,this.hb=a.hb,this.Jc=a.Jc.slice())}G(T,L);
T.prototype.add=function(a,b,c){(!E(a)||!E(b)||!E(c))&&i(Error("Invalid triplet."));this.ib=Math.min(this.ib,a);this.fb=Math.max(this.fb,a);this.jb=Math.min(this.jb,b);this.gb=Math.max(this.gb,b);this.kb=Math.min(this.kb,c);this.hb=Math.max(this.hb,c);this.Jc=[(this.ib+this.fb)/2,(this.jb+this.gb)/2,(this.kb+this.hb)/2];this.c=q;return this.U.push(a,b,c)/3};
T.prototype.get=function(a){(!E(a)||0>a||3*a>this.U.length||a==this.count())&&i(Error("Invalid id."));a*=3;return[this.U[a],this.U[a+1],this.U[a+2]]};T.prototype.remove=function(a){(!E(a)||0>a||3*a>this.U.length||a==this.count())&&i(Error("Invalid id."));this.U.splice(a,3);this.c=q};T.prototype.clear=function(){this.U=[];this.c=q};T.prototype.__defineGetter__("count",function(){return this.U.length/3});T.prototype.__defineGetter__("length",function(){return this.U.length});F("X.triplets",T);
F("X.triplets.prototype.add",T.prototype.add);F("X.triplets.prototype.get",T.prototype.get);F("X.triplets.prototype.remove",T.prototype.remove);F("X.triplets.prototype.clear",T.prototype.clear);function U(){this.aa=nd;this.Qc=new kd;this.ab=[1,1,1];this.h=new T;this.j=new T;this.ma=new T;this.ob=this.w=r;this.Ee=[];this.va=q;this.Hb=this.gc=1;this.Db=r;this.fc=s;this.J=1;this.H=0}var nd="TRIANGLES";U.prototype.__defineGetter__("texture",function(){this.w||(this.w=new md);return this.w});U.prototype.__defineGetter__("transform",t("Qc"));U.prototype.__defineGetter__("points",t("h"));U.prototype.__defineGetter__("normals",t("j"));U.prototype.__defineGetter__("colors",t("ma"));
U.prototype.__defineGetter__("color",t("ab"));U.prototype.__defineSetter__("color",function(a){(!x(a)||!(a instanceof Array)||3==a.length)&&i(Error("Invalid color."));if(this.gd())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.ab=a;this.c=q});U.prototype.__defineGetter__("opacity",t("J"));
U.prototype.__defineSetter__("opacity",function(a){(!E(a)||1<a||0>a)&&i(Error("Invalid opacity."));if(this.gd())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.J=a;this.c=q});U.prototype.__defineGetter__("caption",t("Db"));U.prototype.__defineSetter__("caption",function(a){this.Db=a;this.c=q});U.prototype.__defineGetter__("visible",t("va"));
U.prototype.__defineSetter__("visible",function(a){if(this.gd())for(var b=this.children(),c=b.length,d=0,d=0;d<c;d++)b[d].Na=a;this.va=a;this.c=q});U.prototype.__defineGetter__("pointsize",t("gc"));U.prototype.__defineSetter__("pointsize",function(a){E(a)||i(Error("Invalid point size."));this.gc=a;this.c=q});U.prototype.__defineGetter__("magicmode",t("fc"));U.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.fc=a;this.c=q});
U.prototype.__defineGetter__("linewidth",t("Hb"));U.prototype.__defineSetter__("linewidth",function(a){E(a)||i(Error("Invalid line width."));this.Hb=a;this.c=q});function od(){this.e=r}od.prototype.__defineSetter__("file",function(a){this.e=x(a)?new Mc(a):r});od.prototype.__defineGetter__("file",function(){return!this.e?"":this.e.Sa});function pd(){L.call(this);this.f="scalars";this.Nc=this.s=this.e=r;this.Jb=Infinity;this.Ib=-Infinity;this.Dd=[0,1,0];this.Cd=[1,0,0];this.ec=-Infinity;this.ic=Infinity;this.Ge=q}G(pd,L);pd.prototype.__defineGetter__("file",t("e"));pd.prototype.__defineSetter__("file",function(a){x(a)?(z(a)&&(a=new Mc(a)),this.e=a):this.e=r});pd.prototype.__defineGetter__("array",t("s"));pd.prototype.__defineSetter__("array",function(a){this.Nc=this.s=a;this.c=q});pd.prototype.__defineGetter__("lowerThreshold",t("ec"));
pd.prototype.__defineSetter__("lowerThreshold",function(a){a<=this.Jb&&a>=this.Ib&&(this.ec=a)});pd.prototype.__defineGetter__("upperThreshold",t("ic"));pd.prototype.__defineSetter__("upperThreshold",function(a){a<=this.Jb&&a>=this.Ib&&(this.ic=a)});pd.prototype.__defineGetter__("min",t("Jb"));pd.prototype.__defineGetter__("max",t("Ib"));pd.prototype.__defineGetter__("minColor",t("Dd"));
pd.prototype.__defineSetter__("minColor",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid min. color."));this.Dd=a});pd.prototype.__defineGetter__("maxColor",t("Cd"));pd.prototype.__defineSetter__("maxColor",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid max. color."));this.Cd=a});F("X.scalars",pd);function V(a){L.call(this);this.f="object";this.Eb=r;this.O=s;x(a)&&this.qb(a);this.p=this.r=r;this.c=q;Ba(this,new od);Ba(this,new U)}G(V,L);
V.prototype.qb=function(a){this.aa=a.aa;this.ab=a.ab.slice();this.h=new T(a.h);this.j=new T(a.j);this.ma=new T(a.ma);this.w=a.w;this.ob=a.ob;a.e&&(this.e=new Mc((new String(a.e.Sa)).toString()));this.J=a.J;this.children().length=0;var b=a.Eb;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this._newChild=this._child=b[d],eval("this['_newChild'] = new X."+this._child.f+"(this['_child']);"),this.children().push(this._newChild);this.va=a.va;this.gc=a.gc;this.Hb=a.Hb;a.Db&&(this.Db=(new String(a.Db)).toString());
this.fc=a.fc;this.c=q};function qd(a){for(var b=a.h.count,c=[],d=0,d=0;d<b;d+=3){var e=a.h.get(d),f=a.h.get(d+1),g=a.h.get(d+2),h=a.j.get(d),j=a.j.get(d+1),n=a.j.get(d+2),k=a.ab;0<a.ma.length&&(k=a.ma.get(d));var m=[];m.push(new Lc(e,h));m.push(new Lc(f,j));m.push(new Lc(g,n));c.push(new Pc(m,k))}return Rc(c)}
function rd(a,b){(!x(b)||!(b instanceof M))&&i(Error("Invalid CSG object."));a.h.clear();a.j.clear();a.ma.clear();var c=new Kc,d=[];yb(b.o,function(a){for(var b=[],g=a.Dc,b=yb(a.Ea,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.Yf=yb(c.unique(),function(a){return[a.$.x(),a.$.y(),a.$.b()]});a.Xf=yb(c.unique(),function(a){return[a.F.x(),a.F.y(),a.F.b()]});a.Wf=yb(c.unique(),function(a){return!a.color?r:[a.color[0],a.color[1],a.color[2]]});yb(d,function(a){var b=
a[0],c=a[1],a=a[2],d=this.Yf,j=this.Xf,n=this.Wf;this.h.add(d[b][0],d[b][1],d[b][2]);this.h.add(d[c][0],d[c][1],d[c][2]);this.h.add(d[a][0],d[a][1],d[a][2]);this.j.add(j[b][0],j[b][1],j[b][2]);this.j.add(j[c][0],j[c][1],j[c][2]);this.j.add(j[a][0],j[a][1],j[a][2]);n[b]&&this.ma.add(n[b][0],n[b][1],n[b][2]);n[c]&&this.ma.add(n[c][0],n[c][1],n[c][2]);n[a]&&this.ma.add(n[a][0],n[a][1],n[a][2])}.bind(a));a.aa=nd}V.prototype.__defineGetter__("colortable",function(){this.r||(this.r=new Nc);return this.r});
v=V.prototype;v.Ad=function(a){(!x(a)||!(a instanceof M)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=qd(b));a=new V;rd(a,qd(this).Ad(b));return a};v.Ca=function(a){(!x(a)||!(a instanceof M)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=qd(b));a=new V;rd(a,qd(this).Ca(b));return a};v.hd=function(a){(!x(a)||!(a instanceof M)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=qd(b));a=new V;rd(a,qd(this).hd(b));return a};
v.inverse=function(a){(!x(a)||!(a instanceof M)&&!(a instanceof V))&&i(Error("Invalid object."));var b=a;a instanceof V&&(b=qd(b));a=new V;rd(a,qd(this).inverse(b));return a};v.ra=function(){var a=new sd;a.X=this;this.dispatchEvent(a)};v.children=function(){this.Eb||(this.Eb=[]);return this.Eb};v.gd=function(){return!this.Eb||this.O?s:0<this.Eb.length};v.lh=t("p");v.sh=function(a){if(x(a)){if(z(a)){var b=a,a=new pd;a.e=new Mc(b)}a instanceof pd||i(Error("Invalid scalars."));this.p=a}else this.p=r};
function td(a,b){(!x(a)||!x(b)||!(a instanceof V)||!(b instanceof V))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.J?-1:1==b.J?1:x(a.H)&&x(b.H)&&a.H>b.H?-1:1}F("X.object",V);F("X.object.prototype.scalars",V.prototype.lh);F("X.object.prototype.setScalars",V.prototype.sh);F("X.object.prototype.intersect",V.prototype.hd);F("X.object.prototype.inverse",V.prototype.inverse);F("X.object.prototype.subtract",V.prototype.Ca);F("X.object.prototype.union",V.prototype.Ad);
F("X.object.prototype.children",V.prototype.children);F("X.object.prototype.modified",V.prototype.ra);function W(a){jc.call(this,a);this.f="event"}G(W,jc);var ud=Dc("pan"),vd=Dc("rotate"),wd=Dc("zoom"),xd=Dc("scroll"),yd=Dc("render"),zd=Dc("resetview"),zc=Dc("modified"),Ad=Dc("progress"),Bd=Dc("hover"),Cd=Dc("hover_end");function Dd(){W.call(this,ud);this.H=new $c(0,0)}G(Dd,W);function Ed(){W.call(this,vd);this.H=new $c(0,0)}G(Ed,W);function Fd(){W.call(this,wd);this.Oa=this.eb=s}G(Fd,W);function Gd(){W.call(this,xd);this.Y=s}G(Gd,W);function Jd(){W.call(this,yd)}G(Jd,W);
function Kd(){W.call(this,Bd);this.Uc=this.Tc=0}G(Kd,W);function Ld(){W.call(this,Cd)}G(Ld,W);function Md(){W.call(this,zd)}G(Md,W);function sd(){W.call(this,zc);this.X=new V}G(sd,W);function Nd(){W.call(this,Ad);this.He=0}G(Nd,W);function Od(a){this.k=a;this.hf=J(this.k,Ya?"DOMMouseScroll":"mousewheel",this)}G(Od,Jc);
Od.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.ya;if("mousewheel"==a.type){c=1;if(I||Za&&(Oa||nb("532.0")))c=40;d=Za&&Na&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ia(a.wheelDeltaX)?(b=Za&&Na&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Za&&Na&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ia(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;E(this.kf)&&Math.min(Math.max(b,-this.kf),this.kf);E(this.lf)&&(c=Math.min(Math.max(c,
-this.lf),this.lf));b=new Pd(d,a,0,c);try{this.dispatchEvent(b)}finally{b.pa()}};Od.prototype.A=function(){Od.i.A.call(this);vc(this.hf);delete this.hf};function Pd(a,b,c,d){b&&this.V(b,o);this.type="mousewheel";this.detail=a;this.Ob=d}G(Pd,lc);I||Za&&nb("525");var Qd;function Rd(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Gb(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=wb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var Sd=!I||pb(9);!Ya&&!I||I&&pb(9)||Ya&&nb("1.9.1");I&&nb("9");function Td(a){return a?new Ud(Vd(a)):Qd||(Qd=new Ud)}function Wd(a){return z(a)?document.getElementById(a):a}function Xd(a,b){qb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Yd?a.setAttribute(Yd[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var Yd={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function Zd(a,b,c){return $d(document,arguments)}
function $d(a,b){var c=b[0],d=b[1];if(!Sd&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Ca(d.name),'"');if(d.type){c.push(' type="',Ca(d.type),'"');var e={};ub(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(z(d)?c.className=d:ja(d)?Rd.apply(r,[c].concat(d)):Xd(c,d));2<b.length&&ae(a,c,b);return c}
function ae(a,b,c){function d(c){c&&b.appendChild(z(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];la(f)&&!(na(f)&&0<f.nodeType)?xb(be(f)?Fb(f):f,d):d(f)}}function ce(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function de(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function ee(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Vd(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function be(a){if(a&&"number"==typeof a.length){if(na(a))return"function"==typeof a.item||"string"==typeof a.item;if(ma(a))return"function"==typeof a.item}return s}function Ud(a){this.B=a||da.document||document}v=Ud.prototype;
v.ad=Td;v.g=function(a){return z(a)?this.B.getElementById(a):a};v.Nb=function(a,b,c){return $d(this.B,arguments)};v.createElement=function(a){return this.B.createElement(a)};v.createTextNode=function(a){return this.B.createTextNode(a)};function fe(a){return"CSS1Compat"==a.B.compatMode}function ge(a){var b=a.B,a=!Za&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Yc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}v.appendChild=function(a,b){a.appendChild(b)};
v.contains=ee;function he(a){(!x(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));L.call(this);this.f="interactor";this.element=a;this.de=this.pf=this.of=this.qf=this.nf=this.rf=r;this.ce=q;this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=s;this.Zd=new $c(0,0);this.config={MOUSEWHEEL_ENABLED:q,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:s}}G(he,L);v=he.prototype;
v.V=function(){this.config.MOUSEWHEEL_ENABLED?(this.de=new Od(this.element),this.rf=J(this.de,"mousewheel",this.yc.bind(this))):(vc(this.rf),this.de=r);this.config.MOUSECLICKS_ENABLED?(this.nf=J(this.element,"mousedown",this.Ng.bind(this)),this.qf=J(this.element,"mouseup",this.Sg.bind(this))):(vc(this.nf),vc(this.qf));this.element.oncontextmenu=this.config.CONTEXTMENU_ENABLED?r:function(){return s};window.onkeydown=this.config.KEYBOARD_ENABLED?this.vf.bind(this):r;vc(this.of);vc(this.pf);this.of=
J(this.element,"mousemove",this.Pg.bind(this));this.pf=J(this.element,"mouseout",this.Qg.bind(this))};v.Ng=function(a){0==a.button?this.leftButtonDown=q:1==a.button?this.middleButtonDown=q:2==a.button&&(this.rightButtonDown=q);eval("this.onMouseDown(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");ie(this);a.preventDefault()};v.Mg=aa();
v.Sg=function(a){0==a.button?this.leftButtonDown=s:1==a.button?this.middleButtonDown=s:2==a.button&&(this.rightButtonDown=s);eval("this.onMouseUp(this['leftButtonDown'],this['middleButtonDown'],this['rightButtonDown'])");ie(this);a.preventDefault()};v.Rg=aa();v.Qg=function(a){this.ce=s;this.config.KEYBOARD_ENABLED&&(window.onkeydown=r);this.rightButtonDown=this.middleButtonDown=this.leftButtonDown=s;ie(this);this.Zd=new $c(0,0);a.preventDefault()};v.Og=aa();
v.Pg=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.ce=q;this.config.KEYBOARD_ENABLED&&window.onkeydown==r&&(window.onkeydown=this.vf.bind(this));a.preventDefault();var b=a.shiftKey,c=new $c(a.offsetX,a.offsetY),a=this.Zd.Ca(c);this.Zd=c.d();this.config.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.middleButtonDown||this.leftButtonDown||this.rightButtonDown)&&ie(this),this.Ud=setTimeout(function(){ie(this);var a=new Kd;a.Tc=c.x;a.Uc=c.y;this.dispatchEvent(a);
this.Ud=r}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.wb()&&(this.leftButtonDown&&!b?(b=new Ed,b.H=a,b.vi=0,this.dispatchEvent(b)):this.middleButtonDown||this.leftButtonDown&&b?(b=new Dd,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.H=a,this.dispatchEvent(b)):this.rightButtonDown&&(b=new Fd,b.eb=0<a.y,b.Oa=s,this.dispatchEvent(b)))};function ie(a){a.Ud&&clearTimeout(a.Ud);a.dispatchEvent(new Ld)}v.Tg=aa();
v.yc=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");ie(this);a.preventDefault()};v.Kg=aa();
v.vf=function(a){if(this.ce){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");ie(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Md,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Dd:b?a=new Fd:(a=new Ed,this instanceof je&&(a=new Gd)),a&&(c=new $c(0,0),37==f?(c.x=5,a.Y=s,b&&(a.Y=q,a.eb=q,a.Oa=s)):39==f?(c.x=-5,a.Y=q,b&&(a.eb=s,a.Oa=s)):38==f?(c.y=5,a.Y=q,b&&(a.eb=q,a.Oa=q)):40==f&&(c.y=-5,a.Y=s,b&&(a.eb=s,
a.Oa=q)),a.H=c,this.dispatchEvent(a)))}};F("X.interactor",he);F("X.interactor.prototype.init",he.prototype.V);F("X.interactor.prototype.onMouseDown",he.prototype.Mg);F("X.interactor.prototype.onMouseUp",he.prototype.Rg);F("X.interactor.prototype.onMouseMove",he.prototype.Og);F("X.interactor.prototype.onMouseWheel",he.prototype.Tg);F("X.interactor.prototype.onKey",he.prototype.Kg);function je(a){he.call(this,a);this.f="interactor2D"}G(je,he);je.prototype.yc=function(a){je.i.yc.call(this,a);var b=new Gd;x(a.Ob)||(a.Ob=0);b.Y=0>a.Ob;this.dispatchEvent(b)};function ke(a){V.call(this);this.f="slice";this.n=[0,0,0];this.Fb=[0,0,1];this.Y=[0,1,0];this.Gb=this.Kb=10;this.ob=[0,1,0,0,1,1,1,1,1,0,0,0];this.t=this.Ia=r;this.ua=q;this.Cb=[1,1,1];this.O=q;x(a)&&this.qb(a)}G(ke,V);ke.prototype.qb=function(a){this.n=a.n.slice();this.Fb=a.Fb.slice();this.Y=a.Y.slice();this.Kb=a.Kb;this.Gb=a.Gb;this.Ia=a.Ia;this.t=a.t;this.ua=a.ua;this.Cb=a.Cb;this.O=a.O;ke.i.qb.call(this,a)};
ke.prototype.Jf=function(a,b,c,d,e,f,g){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center."));(!x(b)||!(b instanceof Array)||3!=b.length)&&i(Error("Invalid front direction."));(!x(c)||!(c instanceof Array)||3!=c.length)&&i(Error("Invalid up direction."));E(d)||i(Error("Invalid width."));E(e)||i(Error("Invalid height."));var h=s;x(f)&&(h=f);f=[1,1,1];x(g)&&(f=g);this.n=a;this.Fb=b;this.Y=c;this.Kb=d;this.Gb=e;this.ua=h;this.Cb=f;this.wa()};
ke.prototype.wa=function(){this.h.clear();var a=new O(this.Fb[0],this.Fb[1],this.Fb[2]),b=new O(this.Y[0],this.Y[1],this.Y[2]),c=Xc(b,a),d=new O(this.n[0],this.n[1],this.n[2]),e=new O(1,1,1);1==a.x?(e=new O(this.n[0],this.Gb/2,this.Kb/2),this.ob=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new O(this.Kb/2,this.n[1],this.Gb/2),this.ob=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new O(this.Kb/2,this.Gb/2,this.n[2]));var f=Uc(c.d().M(),b.d().M()),f=new O(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Uc(c.d().M(),b),g=new O(g.x*
e.x,g.y*e.y,g.b*e.b);g.add(d);var h=Uc(c,b.d().M()),h=new O(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var j=h,b=Uc(c,b),b=new O(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.h.add(f.x,f.y,f.b);this.h.add(g.x,g.y,g.b);this.h.add(h.x,h.y,h.b);this.h.add(j.x,j.y,j.b);this.h.add(b.x,b.y,b.b);this.h.add(d.x,d.y,d.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.j.add(a.x,a.y,a.b);this.ua&&(a=new V,a.h.add(f.x,f.y,f.b),a.h.add(g.x,g.y,
g.b),a.h.add(g.x,g.y,g.b),a.h.add(b.x,b.y,b.b),a.h.add(b.x,b.y,b.b),a.h.add(h.x,h.y,h.b),a.h.add(h.x,h.y,h.b),a.h.add(f.x,f.y,f.b),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.j.add(0,0,0),a.ab=[this.Cb[0],this.Cb[1],this.Cb[2]],a.aa="LINES",a.Hb=2,this.children().push(a))};F("X.slice",ke);F("X.slice.prototype.setup",ke.prototype.Jf);function Z(a){V.call(this);this.f="volume";this.n=[0,0,0];this.R=[10,10,10];this.K=[1,1,1];this.cc=this._indexZ=this.bc=this._indexY=this.ac=this._indexX=0;this.lb=new V;this.mb=new V;this.nb=new V;this._lowerThreshold=0;this._upperThreshold=1E3;this.Ga=[0,1E3];this.Sc=this._volumeRendering=s;this.Wa=0;this.t=r;this.ua=q;x(a)&&this.qb(a)}G(Z,V);v=Z.prototype;
v.qb=function(a){this.n=a.n.slice();this.R=a.R.slice();this.K=a.K.slice();this._indexX=a._indexX;this.ac=a.ac;this._indexY=a._indexY;this.bc=a.bc;this._indexZ=a._indexZ;this.cc=a.cc;this.lb=new V(a.lb);this.mb=new V(a.mb);this.nb=new V(a.nb);this._lowerThreshold=a._lowerThreshold;this._upperThreshold=a._upperThreshold;this.Ga=a.Ga.slice();this._volumeRendering=a._volumeRendering;this.Sc=a.Sc;this.Wa=a.Wa;this.t=a.t;this.ua=a.ua;Z.i.qb.call(this,a)};
v.wa=function(){this.children().length=0;this.children().push(this.lb);this.children().push(this.mb);this.children().push(this.nb);for(var a=0,a=0;3>a;a++){for(var b=(this.R[a]-1)/2,c=b,d=0,d=0;d<this.R[a];d++){var e=-b*this.K[a]+d*this.K[a],e=[[this.n[0]+e,this.n[1],this.n[2]],[this.n[0],this.n[1]+e,this.n[2]],[this.n[0],this.n[1],this.n[2]+e]],f=this.children()[a].children(),g=0,h=0,j=[1,1,1],n=this.ua;0==a?(g=this.R[2]*this.K[2]-this.K[2],h=this.R[1]*this.K[1]-this.K[1],j=[1,1,0]):1==a?(g=this.R[0]*
this.K[0]-this.K[0],h=this.R[2]*this.K[2]-this.K[2],j=[1,0,0]):2==a&&(g=this.R[0]*this.K[0]-this.K[0],h=this.R[1]*this.K[1]-this.K[1],j=[0,1,0]);x(this.Ia)&&(n=s);var k=new ke;k.Jf(e[a],[[1,0,0],[0,1,0],[0,0,1]][a],[[0,1,0],[0,0,-1],[0,1,0]][a],g,h,n,j);k.Ia=this;k.O=s;k.Na=d==Math.floor(c);k.O=q;f.push(k)}0==a?this.ac=this._indexX=c:1==a?this.bc=this._indexY=c:2==a&&(this.cc=this._indexZ=c)}this.c=q};
v.ra=function(){if(0<this.children().length){if(this._volumeRendering!=this.Sc){if(this._volumeRendering){var a=this.children()[0].children()[parseInt(this._indexX,10)];a.O=s;a.Na=s;a.O=q;a=this.children()[1].children()[parseInt(this._indexY,10)];a.O=s;a.Na=s;a.O=q;a=this.children()[2].children()[parseInt(this._indexZ,10)];a.O=s;a.Na=s;a.O=q}else this.children()[this.Wa].Na=s;this.c=q;this.Sc=this._volumeRendering}if(this._volumeRendering)le(this,this.Wa);else for(a=a=0;3>a;a++){var b=this.children()[a],
c=0,d=0;0==a?(c=this._indexX,d=this.ac,this.ac=this._indexX):1==a?(c=this._indexY,d=this.bc,this.bc=this._indexY):2==a&&(c=this._indexZ,d=this.cc,this.cc=this._indexZ);d=b.children()[parseInt(d,10)];d.O=s;d.Na=s;d.O=q;b=b.children()[parseInt(c,10)];b.O=s;b.Na=q;b.O=q;b.J=1}}Z.i.ra.call(this)};v.kg=t("R");v.kh=t("Ga");v.xe=function(a,b){(!x(a)||!E(a)||!x(b)||!E(b)||a>b||a<this.Ga[0]||b>this.Ga[1])&&i(Error("Invalid threshold range."));this._lowerThreshold=a;this._upperThreshold=b};v.vh=ca("_volumeRendering");
Z.prototype.__defineSetter__("visible",ca("va"));Z.prototype.oh=function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center."));this.n=a};function le(a,b){if(a._volumeRendering&&(a.c||b!=a.Wa)){var c=a.children()[a.Wa];c.Na=s;c=a.children()[b];c.Na=q;a.Wa=b;a.c=s}}Z.prototype.__defineGetter__("labelmap",function(){this.t||(this.t=new me(this));return this.t});Z.prototype.gg=t("ua");Z.prototype.nh=ca("ua");F("X.volume",Z);F("X.volume.prototype.dimensions",Z.prototype.kg);
F("X.volume.prototype.scalarRange",Z.prototype.kh);F("X.volume.prototype.setCenter",Z.prototype.oh);F("X.volume.prototype.setVolumeRendering",Z.prototype.vh);F("X.volume.prototype.threshold",Z.prototype.xe);F("X.volume.prototype.modified",Z.prototype.ra);F("X.volume.prototype.borders",Z.prototype.gg);F("X.volume.prototype.setBorders",Z.prototype.nh);function ne(){L.call(this);this.f="parser"}G(ne,L);v=ne.prototype;v.parse=function(){i(Error("The function parse() should be overloaded."))};v.zc=function(a,b){var c=this.m(a,b+2),d=this.m(a,b+3),e=(d<<1&255|c>>7)-127,c=(c&127)<<16|this.m(a,b+1)<<8|this.m(a,b);return 0==c&&-127==e?0:(1-2*(d>>7))*(1+c*Math.pow(2,-23))*Math.pow(2,e)};
function oe(a,b,c){var d=a.m(b,c),e=a.m(b,c+1),f=(d<<1&255|e>>7)-127,a=(e&127)<<16|a.m(b,c+2)<<8|a.m(b,c+3);return 0==a&&-127==f?0:(1-2*(d>>7))*(1+a*Math.pow(2,-23))*Math.pow(2,f)}function pe(a,b,c,d){var e=[],f=0,g=Infinity,h;for(h=0;h<d;h++){var j=a.zc(b,c+4*h);e[h]=j;f=Math.max(f,j);g=Math.min(g,j)}return[e,f,g]}v.ne=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=oe(this,a,b+4*g);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};
function qe(a,b,c){return(a.m(b,c+3)<<24)+(a.m(b,c+2)<<16)+(a.m(b,c+1)<<8)+a.m(b,c)}function re(a,b,c){return(a.m(b,c)<<24)+(a.m(b,c+1)<<16)+(a.m(b,c+2)<<8)+a.m(b,c+3)}v.Df=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=re(this,a,b+4*g);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};v.rd=function(a,b){return(this.m(a,b+1)<<8)+this.m(a,b)};
v.Cf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=(this.m(a,b+2*g)<<8)+this.m(a,b+2*g+1);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};v.$g=function(a,b){var c=this.m(a,b);return 127<c?c-256:c};v.m=function(a,b){return a.charCodeAt(b)&255};v.Bf=function(a,b,c){var d=[],e=0,f=Infinity,g;for(g=0;g<c;g++){var h=this.m(a,b+g);d[g]=h;e=Math.max(e,h);f=Math.min(f,h)}return[d,e,f]};
function se(a,b,c,d){for(var e=c[2],f=c[1],c=c[0],g=a.t!=r,h=f*c,j=Array(e),n=0;n<e;n++){j[n]=Array(f);for(var k=0;k<f;k++)j[n][k]=Array(c)}for(var m=0,n=n=0;n<e;n++){for(var k=b.slice(n*h,(n+1)*h),l=new Uint8Array(4*h),p=0,u=0,w=0,p=0;p<f;p++)for(u=0;u<c;u++){var m=k[w],A=0,C=0,D=0,y=0;a.r?((y=a.r.W.get(Math.floor(m)))||(y=a.r.W.get(a.r.W.ba()-1)),A=255*y[1],C=255*y[2],D=255*y[3],y=255*y[4]):(A=C=D=255*(m/d),y=255);var B=4*w;l[B]=A;l[++B]=C;l[++B]=D;l[++B]=y;j[n][p][u]=m;w++}m=new md;m.Va=l;m.Pc=
c;m.Oc=f;k=a.nb.children()[n];k.w=m;g&&(k.t=a.t.nb.children()[n].w)}for(p=0;p<f;p++){l=new Uint8Array(4*e*c);for(n=w=0;n<e;n++)for(u=0;u<c;u++)m=j[n][p][u],a.r?((y=a.r.W.get(Math.floor(m)))||(y=a.r.W.get(a.r.W.ba()-1)),A=255*y[1],C=255*y[2],D=255*y[3],y=255*y[4]):(A=C=D=255*(m/d),y=255),B=4*w,l[B]=A,l[++B]=C,l[++B]=D,l[++B]=y,w++;m=new md;m.Va=l;m.Pc=c;m.Oc=e;k=a.mb.children()[p];k.w=m;g&&(k.t=a.t.mb.children()[p].w)}for(u=0;u<c;u++){l=new Uint8Array(4*e*f);for(n=w=0;n<e;n++)for(p=0;p<f;p++)m=j[n][p][u],
a.r?((y=a.r.W.get(Math.floor(m)))||(y=a.r.W.get(a.r.W.ba()-1)),A=255*y[1],C=255*y[2],D=255*y[3],y=255*y[4]):(A=C=D=255*(m/d),y=255),B=4*w,l[B]=A,l[++B]=C,l[++B]=D,l[++B]=y,w++;m=new md;m.Va=l;m.Pc=f;m.Oc=e;k=a.lb.children()[u];k.w=m;g&&(k.t=a.t.lb.children()[u].w)}};function te(){ne.call(this);this.f="parserSTL"}G(te,ne);te.prototype.parse=function(a,b){for(var c=b.split("\n"),d=c.length,e=a.h,f=a.j,g=0,h=d%8;h--;)this.G(e,f,c[g]),g++;for(h=0.125*d^0;h--;)this.G(e,f,c[g]),g++,this.G(e,f,c[g]),g++,this.G(e,f,c[g]),g++,this.G(e,f,c[g]),g++,this.G(e,f,c[g]),g++,this.G(e,f,c[g]),g++,this.G(e,f,c[g]),g++,this.G(e,f,c[g]),g++;c=new sd;c.X=a;this.dispatchEvent(c)};
te.prototype.G=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),d=c.split(" ");if("vertex"==d[0]){var c=parseFloat(d[1]),e=parseFloat(d[2]),d=parseFloat(d[3]);a.add(c,e,d)}else"facet"==d[0]&&(c=parseFloat(d[2]),e=parseFloat(d[3]),d=parseFloat(d[4]),b.add(c,e,d),b.add(c,e,d),b.add(c,e,d))};F("X.parserSTL",te);F("X.parserSTL.prototype.parse",te.prototype.parse);function ue(){ne.call(this);this.f="parserVTK"}G(ue,ne);
ue.prototype.parse=function(a,b){var c=a.h,d=a.j,e=b.split("\n"),f=e.length,g=new T,h=new T;this.S=[];this.na=nd;this.Ed=this.Ta=this.Pa=this.Ua=s;for(var j=0,n=f%8;n--;)this.G(g,h,e[j]),j++;for(n=0.125*f^0;n--;)this.G(g,h,e[j]),j++,this.G(g,h,e[j]),j++,this.G(g,h,e[j]),j++,this.G(g,h,e[j]),j++,this.G(g,h,e[j]),j++,this.G(g,h,e[j]),j++,this.G(g,h,e[j]),j++,this.G(g,h,e[j]),j++;if(this.na==nd){e=h.length;j=f=this.S.length;do{var n=this.S[f-j],k=n.length,m;for(m=0;m<k;m++){var l=parseInt(n[m],10),p=
g.get(l);c.add(p[0],p[1],p[2]);l<e?(l=h.get(l),d.add(l[0],l[1],l[2])):(l=new O(p[0],p[1],p[2]),l.normalize(),d.add(l.x,l.y,l.b))}j--}while(0<j)}else if("TRIANGLE_STRIPS"==this.na){e=h.length;j=f=this.S.length;do{n=this.S[f-j];k=n.length;for(m=0;m<k;m++)l=parseInt(n[m],10),p=g.get(l),c.add(p[0],p[1],p[2]),(0==m||m==k-1)&&c.add(p[0],p[1],p[2]),l<e?(l=h.get(l),d.add(l[0],l[1],l[2]),(0==m||m==k-1)&&d.add(l[0],l[1],l[2])):(l=new O(p[0],p[1],p[2]),l.normalize(),d.add(l.x,l.y,l.b),(0==m||m==k-1)&&d.add(l.x,
l.y,l.b));j--}while(0<j)}else if("LINES"==this.na){e=h.length;j=f=this.S.length;do{n=this.S[f-j];k=n.length;for(m=0;m<k-1;m++){var u=parseInt(n[m],10),l=parseInt(n[m+1],10),w=g.get(u),p=g.get(l);c.add(w[0],w[1],w[2]);c.add(p[0],p[1],p[2]);u<e-1?(p=h.get(u),l=h.get(l),d.add(p[0],p[1],p[2]),d.add(l[0],l[1],l[2])):(l=new O(w[0],w[1],w[2]),l.normalize(),d.add(l.x,l.y,l.b),l=new O(p[0],p[1],p[2]),l.normalize(),d.add(l.x,l.y,l.b))}j--}while(0<j)}else if("POINTS"==this.na){e=h.length;j=f=this.S.length;do{n=
this.S[f-j];k=n.length;for(m=0;m<k;m++)l=parseInt(n[m],10),p=g.get(l),c.add(p[0],p[1],p[2]),l<e?(l=h.get(l),d.add(l[0],l[1],l[2])):(l=new O(p[0],p[1],p[2]),l.normalize(),d.add(l.x,l.y,l.b));j--}while(0<j)}else if("POLYGONS"==this.na){e=h.length;j=f=this.S.length;do{n=this.S[f-j];k=n.length;for(m=0;m<k;m++)l=parseInt(n[m],10),p=g.get(l),c.add(p[0],p[1],p[2]),l<e?(l=h.get(l),d.add(l[0],l[1],l[2])):(l=new O(p[0],p[1],p[2]),l.normalize(),d.add(l.x,l.y,l.b));j--}while(0<j)}a.aa=this.na;c=new sd;c.X=a;
this.dispatchEvent(c)};
ue.prototype.G=function(a,b,c){var c=c.replace(/^\s+|\s+$/g,""),c=c.split(" "),d=c.length,e=c[0];if("POINTS"==e)this.Ua=q,this.Ta=this.Pa=s;else if("VERTICES"==e)this.Pa=q,this.Ta=this.Ua=s,a=parseInt(c[1],10),3<=a?this.na=nd:1==a?this.na="POINTS":i(Error("VTK file not supported!")),this.S=[];else if("TRIANGLE_STRIPS"==e)this.Pa=q,this.Ta=this.Ua=s,this.na="TRIANGLE_STRIPS",this.S=[];else if("LINES"==e)this.Pa=q,this.Ta=this.Ua=s,this.na="LINES",this.S=[];else if("POLYGONS"==e)this.Pa=q,this.Ta=this.Ua=
s,this.na="POLYGONS",this.S=[];else if("POINT_DATA"==e)this.Ta=q,this.Pa=this.Ua=s;else if(this.Ua)if(1==d||isNaN(parseFloat(e)))this.Ua=s;else{if(3<=d){var e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.add(e,f,g)}6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.add(e,f,g));9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),a.add(d,e,c))}else this.Pa?1==d||isNaN(parseFloat(e))?this.Pa=s:this.S.push(c.slice(1)):this.Ta&&("NORMALS"==e?this.Ed=q:1==d||isNaN(parseFloat(e))?
this.Ed=this.Ta=s:this.Ed&&(3<=d&&(e=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),b.add(e,f,g)),6<=d&&(e=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),b.add(e,f,g)),9<=d&&(d=parseFloat(c[6]),e=parseFloat(c[7]),c=parseFloat(c[8]),b.add(d,e,c))))};F("X.parserVTK",ue);F("X.parserVTK.prototype.parse",ue.prototype.parse);function ve(){ne.call(this);this.f="parserFSM"}G(ve,ne);
ve.prototype.parse=function(a,b){var c=a.h,d=a.j,e=a.Ee,f=new T,g;g=3;var h=0,j;do j=this.m(b,g++),h++;while(200>h&&10!=j);g++;var n=re(this,b,g);g+=4;h=re(this,b,g);g+=4;j=[];for(var k=0,k=0;k<n;k++){var m=oe(this,b,g);g+=4;var l=oe(this,b,g);g+=4;var p=oe(this,b,g);g+=4;j[k]=0;f.add(m,l,p)}n=[];k=[];for(m=0;m<h;m++){var u=re(this,b,g);g+=4;p=re(this,b,g);g+=4;l=re(this,b,g);g+=4;j[u]+=1;j[p]+=1;j[l]+=1;n.push([u,p,l]);k.push(new O(0,0,0))}for(m=0;m<h;m++){var u=n[m][0],p=n[m][1],l=n[m][2],w=f.get(u);
g=f.get(p);var A=f.get(l),w=new O(w[0],w[1],w[2]),A=new O(A[0],A[1],A[2]);g=(new O(g[0],g[1],g[2])).d().Ca(w);w=A.d().Ca(w);g=Xc(g,w).normalize();k[u]=k[u].add(g);k[p]=k[p].add(g);k[l]=k[l].add(g)}for(m=0;m<h;m++)u=n[m][0],p=n[m][1],l=n[m][2],w=f.get(u),g=f.get(p),A=f.get(l),e.push(u),e.push(p),e.push(l),c.add(w[0],w[1],w[2]),c.add(g[0],g[1],g[2]),c.add(A[0],A[1],A[2]),u=k[u].scale(1/j[u]).normalize(),p=k[p].scale(1/j[p]).normalize(),l=k[l].scale(1/j[l]).normalize(),d.add(u.x,u.y,u.b),d.add(p.x,p.y,
p.b),d.add(l.x,l.y,l.b);a.aa=nd;c=new sd;c.X=a;this.dispatchEvent(c)};F("X.parserFSM",ve);F("X.parserFSM.prototype.parse",ve.prototype.parse);function we(a){function b(){zb+=8;return sc<P.length?P.charCodeAt(sc++)&255:-1}function c(){var a;zb++;a=Aa&1;Aa>>=1;0==Aa&&(Aa=b(),a=Aa&1,Aa=Aa>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=ba[b]>>8-a);return b}function e(a){R++;D[y++]=a;p.push(String.fromCharCode(a));32768==y&&(y=0)}function f(){this.Za=this.Ya=0;this.jd=r;this.ff=-1}function g(){for(;;){if(N[H]>=Ta)return-1;if(ra[N[H]]==H)return N[H]++;N[H]++}}function h(){var a=kb[lb],b;u&&document.write("<br>len:"+H+" treepos:"+
lb);if(17==H)return-1;lb++;H++;b=g();u&&document.write("<br>IsPat "+b);if(0<=b)a.Ya=b,u&&document.write("<br>b0 "+a.Ya);else if(a.Ya=32768,u&&document.write("<br>b0 "+a.Ya),h())return-1;b=g();if(0<=b)a.Za=b,u&&document.write("<br>b1 "+a.Za),a.jd=r;else if(a.Za=32768,u&&document.write("<br>b1 "+a.Za),a.jd=kb[lb],a.ff=lb,h())return-1;H--;return 0}function j(a,b,c){u&&document.write("currentTree "+a+" numval "+b+" lengths "+c+" show 0");kb=a;lb=0;ra=c;Ta=b;for(a=0;17>a;a++)N[a]=0;H=0;if(h())return u&&
window.console.log("invalid huffman tree\n"),-1;if(u){document.write("<br>Tree: "+kb.length);for(a=0;32>a;a++)document.write("Places["+a+"].b0="+kb[a].Ya+"<br>"),document.write("Places["+a+"].b1="+kb[a].Za+"<br>")}return 0}function n(a){for(var b,d,e=0,f=a[e];;)if(b=c(),u&&document.write("b="+b),b){if(!(f.Za&32768))return u&&document.write("ret1"),f.Za;f=f.jd;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.Ya&32768))return u&&document.write("ret2"),f.Ya;e++;f=a[e]}}function k(){var a,
g,h,l;do{a=c();g=d(2);switch(g){case 0:u&&window.console.log("Stored\n");break;case 1:u&&window.console.log("Fixed Huffman codes\n");break;case 2:u&&window.console.log("Dynamic Huffman codes\n");break;case 3:u&&window.console.log("Reserved block type!!\n");break;default:u&&window.console.log("Unexpected value %d!\n",g)}if(0==g){var m;Aa=1;m=b();m|=b()<<8;g=b();g|=b()<<8;for((m^~g)&65535&&document.write("BlockLen checksum mismatch\n");m--;)g=b(),e(g)}else if(1==g)for(var k;;)if(k=ba[d(7)]>>1,23<k?
(k=k<<1|c(),199<k?(k-=128,k=k<<1|c()):(k-=48,143<k&&(k+=136))):k+=256,256>k)e(k);else if(256==k)break;else{k-=257;l=d(ga[k])+ha[k];k=ba[d(5)]>>3;8<Y[k]?(m=d(8),m|=d(Y[k]-8)<<8):m=d(Y[k]);m+=ka[k];for(k=0;k<l;k++)g=D[y-m&32767],e(g)}else if(2==g){var p=Array(320);g=257+d(5);m=1+d(5);h=4+d(4);for(k=0;19>k;k++)p[k]=0;for(k=0;k<h;k++)p[sa[k]]=d(3);l=ua.length;for(h=0;h<l;h++)ua[h]=new f;if(j(ua,19,p)){y=0;return}if(u){document.write("<br>distanceTree");for(k=0;k<ua.length;k++)document.write("<br>"+ua[k].Ya+
" "+ua[k].Za+" "+ua[k].jd+" "+ua[k].ff)}l=g+m;h=0;var w=-1;for(u&&document.write("<br>n="+l+" bits: "+zb+"<br>");h<l;)if(w++,k=n(ua),u&&document.write("<br>"+w+" i:"+h+" decode: "+k+"    bits "+zb+"<br>"),16>k)p[h++]=k;else if(16==k){var A;k=3+d(2);if(h+k>l){y=0;return}for(A=h?p[h-1]:0;k--;)p[h++]=A}else{k=17==k?3+d(3):11+d(7);if(h+k>l){y=0;return}for(;k--;)p[h++]=0}l=Ab.length;for(h=0;h<l;h++)Ab[h]=new f;if(j(Ab,g,p)){y=0;return}l=Ab.length;for(h=0;h<l;h++)ua[h]=new f;k=[];l=p.length;for(h=g;h<l;h++)k[h-
g]=p[h];if(j(ua,m,k)){y=0;return}for(u&&document.write("<br>literalTree");;)if(k=n(Ab),256<=k){k-=256;if(0==k)break;k--;l=d(ga[k])+ha[k];k=n(ua);8<Y[k]?(m=d(8),m|=d(Y[k]-8)<<8):m=d(Y[k]);for(m+=ka[k];l--;)g=D[y-m&32767],e(g)}else e(k)}}while(!a);y=0;Aa=1}function m(){u&&window.console.log("NEXTFILE");p=[];var a=[];B=s;a[0]=b();a[1]=b();u&&window.console.log("type: "+a[0]+" "+a[1]);120==a[0]&&218==a[1]&&(u&&window.console.log("GEONExT-GZIP"),k(),u&&window.console.log(p.join("")),C[A]=Array(2),C[A][0]=
p.join(""),C[A][1]="geonext.gxt",A++);31==a[0]&&139==a[1]&&(u&&window.console.log("GZIP"),l(),u&&window.console.log(p.join("")),C[A]=Array(2),C[A][0]=p.join(""),C[A][1]="file",A++);if(80==a[0]&&75==a[1]&&(B=q,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();u&&window.console.log("ZIP-Version: "+a[1]+" "+a[0]/10+"."+a[0]%10);w=b();w|=b()<<8;u&&window.console.log("gpflags: "+w);a=b();a|=b()<<8;u&&window.console.log("method: "+a);b();b();b();b();var c=b(),c=c|b()<<8,c=c|b()<<16,c=c|b()<<24,d=b(),
d=d|b()<<8,d=d|b()<<16,d=d|b()<<24,e=b(),e=e|b()<<8,e=e|b()<<16,e=e|b()<<24;u&&window.console.log("local CRC: "+c+"\nlocal Size: "+e+"\nlocal CompSize: "+d);c=b();c|=b()<<8;d=b();d|=b()<<8;u&&window.console.log("filelen "+c);e=0;for(Va=[];c--;){var f=b();"/"==f|":"==f?e=0:e<Vc-1&&(Va[e++]=String.fromCharCode(f))}u&&window.console.log("nameBuf: "+Va);Wc||(Wc=Va);for(e=0;e<d;)b(),e++;R=0;8==a&&(k(),u&&window.console.log(p.join("")),C[A]=Array(2),C[A][0]=p.join(""),C[A][1]=Va.join(""),A++);l()}}function l(){var a=
[],c;w&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b(),u&&window.console.log("CRC:"));B&&m();a[0]=b();if(8!=a[0])u&&window.console.log("Unknown compression method!");else{w=b();u&&w&-32&&window.console.log("Unknown flags set!");b();b();b();b();b();b();if(w&4){a[0]=b();a[2]=b();H=a[0]+256*a[1];u&&window.console.log("Extra field size: "+H);for(a=0;a<H;a++)b()}if(w&8){a=0;for(Va=[];c=b();){if("7"==c||":"==c)a=0;a<Vc-1&&(Va[a++]=
c)}u&&window.console.log("original file name: "+Va)}if(w&16)for(;b(););w&2&&(b(),b());k();b();b();b();b();b();b();b();b();B&&m()}}var p=[],u=s,w,A=0,C=[],D=Array(32768),y=0,B=s,R,ba=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,
90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,
231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],ha=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ga=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],ka=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],sa=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=a,
sc=0,Aa=1,zb=0,Vc=256,Va=[],Wc,Ab=Array(288),ua=Array(32),lb=0,kb=r,H=0,N=Array(17);N[0]=0;var ra,Ta;we.prototype.Tf=function(){u&&window.console.log(P);m();return C}};function xe(){ne.call(this);this.f="parserNRRD"}G(xe,ne);
xe.prototype.parse=function(a,b){var c=0,d=b.match(/^([\s\S]*?)\r?\n\r?\n/),c=d[0].length,e,f,g,h,j,n,d=d[1].split(/\r?\n/);for(j=0,n=d.length;j<n;j++)if(e=d[j],e.match(/NRRD\d+/))this.zg=q;else if(!e.match(/^#/)&&(h=e.match(/(.*):(.*)/)))f=h[1].trim(),e=h[2].trim(),(g=this.mg[f])?g.call(this,e):this[f]=e;this.zg||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.la&&(this.la=[new O(1,0,0),
new O(0,1,0),new O(0,0,1)],this.ve)){d=[];for(h=0;2>=h;h++)d.push(!isNaN(this.ve[h])?this.la[h].scale(this.ve[h]):o)}h=0;h="gzip"==this.encoding||"gz"==this.encoding?(new we(b.substr(c))).Tf()[0][0]:b.substr(c);c=this.Ab[0]*this.Ab[1]*this.Ab[2];d=Array(c);j=-Infinity;n=Infinity;for(e=0;e<c;e++)f=this.qd(h,0+e*this.pd),d[e]=f,j=Math.max(j,f),n=Math.min(n,f);a.R=[this.Ab[0],this.Ab[1],this.Ab[2]];a.K=[(new O(this.la[0][0],this.la[0][1],this.la[0][2])).wb(),(new O(this.la[1][0],this.la[1][1],this.la[1][2])).wb(),
(new O(this.la[2][0],this.la[2][1],this.la[2][2])).wb()];a.Ga=[n,j];a.xe(n,j);a.wa();se(a,d,this.Ab,j);c=new sd;c.X=a;this.dispatchEvent(c)};
xe.prototype.mg={type:function(a){switch(a){case "unsigned char":case "uint8":this.qd=this.m;this.pd=1;break;case "signed char":case "int8":this.qd=this.$g;this.pd=1;break;case "short":case "signed short":case "unsigned short":case "short int":case "int16":this.qd=this.rd;this.pd=2;break;case "int":case "int32":break;case "float":this.qd=this.zc;this.pd=4;break;default:i(Error("Only short/int/int8/float data is allowed. Found "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=
a},dimension:function(a){return parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.Ab=e},"space directions":function(a){var b,c,d;c=a.match(/\(.*?\)/g);return this.la=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);
var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.ve=e}};F("X.parserNRRD",xe);F("X.parserNRRD.prototype.parse",xe.prototype.parse);function ye(a){x(a)||i(Error("Invalid data."));L.call(this);this.f="parserHelper";this.Ce=a;this.Kc=0;this.yh=this.cb=1;this.Ah=2;this.Lf=this.zh=4}G(ye,L);ye.prototype.xb=aa();ye.prototype.data=t("Ce");function $(a,b){x(b)||(b=1);var c=a.xb(a.Ce,a.Kc,b)[0];a.Kc+=a.cb*b;return 1==b?c[0]:c};function ze(){ne.call(this);this.f="parserMGZ"}G(ze,ne);
ze.prototype.parse=function(a,b,c){var d=0,e=d=c?(new we(b.substr(0))).Tf()[0][0]:b.substr(0),f=d=c=0,g=0,h=0,j=[[0,0,0,0],[0,0,0,0],[0,0,0,0]],b=[],n=[],h=r,k,h={value:0,name:"uchar",size:1,$c:this.Bf.bind(this)},m={value:1,name:"int",size:4,$c:this.Df.bind(this)},l={value:3,name:"float",size:4,$c:this.ne.bind(this)},p={value:4,name:"short",size:2,$c:this.Cf.bind(this)},n=256,e=new ye(e),c=this.Df.bind(this),d=e.zh;e.xb=c;e.cb=d;$(e);c=$(e);d=$(e);f=$(e);$(e);g=$(e);switch(g){case 0:k=h;break;case 1:k=
m;break;case 3:k=l;break;case 4:k=p}$(e);h=this.Cf.bind(this);m=e.Ah;e.xb=h;e.cb=m;h=$(e);n-=2;0<h&&(h=this.ne.bind(this),m=e.Lf,e.xb=h,e.cb=m,n-=60,b[0]=$(e),b[1]=$(e),b[2]=$(e),j[0][0]=$(e),j[1][0]=$(e),j[2][0]=$(e),j[0][1]=$(e),j[1][1]=$(e),j[2][1]=$(e),j[0][2]=$(e),j[1][2]=$(e),j[2][2]=$(e),j[0][3]=$(e),j[1][3]=$(e),j[2][3]=$(e));j=this.Bf.bind(this);h=e.yh;e.xb=j;e.cb=h;$(e,n);j=k.size;e.xb=k.$c;e.cb=j;n=$(e,c*d*f);e.Kc+16<e.data().length&&(k=this.ne.bind(this),j=e.Lf,e.xb=k,e.cb=j,$(e),$(e),
$(e),$(e));k=n;e={Gg:0,Lh:0,jg:0,fh:1,Ch:0,min:0,Hg:0,max:0,Eg:0};j=k.length;e.size=j;l=0;l=1;h=0;for(m=j;0<=m;m--)h+=k[m],l*=k[m],e.min>=k[m]&&(e.min=k[m],e.Hg=m),e.max<=k[m]&&(e.max=k[m],e.Eg=m);e.fh=l;e.Ch=h;for(l=e.Gg=h/j,m=j,h=0;m--;h+=Math.pow(k[m]-l,2));h=(e.jg=Math.sqrt(e.Lh=h/j),e);c=[c,d,f];a.R=c;a.K=b;b=h.min;d=h.max;a.Ga=[b,d];a.xe(b,d);a.wa();se(a,n,c,d);b=new sd;b.X=a;this.dispatchEvent(b)};F("X.parserMGZ",ze);F("X.parserMGZ.prototype.parse",ze.prototype.parse);function Ae(){ne.call(this);this.f="parserCRV"}G(Ae,ne);
Ae.prototype.parse=function(a,b){var c=a.Ee;0==c.length&&i(Error("No _pointIndices defined on the X.object."));var d=0,e=(this.m(b,d)<<16)+(this.m(b,d+1)<<8)+this.m(b,d+2)&16777215,d=d+3;if(16777215!=e)alert("Can't load curvature file, invalid magic number.");else{var e=re(this,b,d),d=d+4+4+4,f=0,g=0,h=0,j=0,n=0,k=0,m=0,l=0,p=0,u=0,w=0,A=Array(e),C=Array(2),D=Array(2),y;for(y=0;y<e;y++){var B=oe(this,b,d),d=d+4;0==y&&(C[0]=D[0]=B);0<=B?(f++,j+=B):(g++,h+=B);p+=B;w++;D[0]=Math.max(B,D[0]);C[0]=Math.min(B,
C[0]);A[y]=B}0!=f&&(n=j/f);0!=g&&(k=h/g);0!=w&&(u=p/w);for(d=p=h=j=0;d<e;d++)B=A[d],w=0,0<=B?(w=Math.pow(B-n,2),j+=w):(w=Math.pow(B-k,2),h+=w),w=Math.pow(B-u,2),p+=w;1<f&&(m=Math.sqrt(j/(f-1)));1<g&&(l=Math.sqrt(h/(g-1)));C[1]=k-2.5*l;D[1]=n+2.5*m;f=c.length;g=[];for(d=0;d<f;d++)h=c[d],h>e&&i(Error("Could not find scalar for vertex.")),h=A[h],g.push(h),g.push(h),g.push(h);a.p.Jb=C[1];a.p.Ib=D[1];a.p.ec=C[1];a.p.ic=D[1];a.p.s=A;a.p.Nc=g;a.p.c=q;c=new sd;c.X=a;this.dispatchEvent(c)}};
F("X.parserCRV",Ae);F("X.parserCRV.prototype.parse",Ae.prototype.parse);function Be(){ne.call(this);this.f="parserTRK"}G(Be,ne);
Be.prototype.parse=function(a,b){var c=a.h,d=a.j,e=a.ma,f=0,g=f+6,h=0,j=Infinity,n;for(n=0;3>n;n++)var k=this.rd(b,g+2*n),h=Math.max(h,k),j=Math.min(j,k);var m=pe(this,b,f+12,3)[0];pe(this,b,f+24,3);var l=this.rd(b,f+36),p=this.rd(b,f+238);pe(this,b,f+440,16);pe(this,b,f+956,6);g=qe(this,b,f+988);f=qe(this,b,f+996);h=[];j=[];n=Infinity;var k=-Infinity,u=r,w=r,A=r,C=r,D=r,y=r,B;for(B=0;B<g;B++){for(var R=qe(this,b,f),ba=new T,ha=0,f=f+4,ga=0;ga<R;ga++){var ka=this.zc(b,f),f=f+4,Y=this.zc(b,f),f=f+
4,sa=this.zc(b,f),f=f+4,P=r;0<l&&(pe(this,b,f,l),f+=4*l);ka/=m[0];Y/=m[1];sa/=m[2];ba.add(ka,Y,sa);0<ga&&(P=ba.get(ga-1),ha+=Math.sqrt(Math.pow(ka-P[0],2)+Math.pow(Y-P[1],2)+Math.pow(sa-P[2],2)))}0<p&&(f+=4*p);ga=ba.ib;R=ba.fb;ka=ba.jb;Y=ba.gb;sa=ba.kb;P=ba.hb;if(!u||ga<u)u=ga;if(!w||R>w)w=R;if(!A||ka<A)A=ka;if(!C||Y>C)C=Y;if(!D||sa<D)D=sa;if(!y||P>y)y=P;h.push(ba);j.push(ha)}f=(u+w)/2;A=(A+C)/2;y=(D+y)/2;D=[];for(B=0;B<g;B++){C=h[B];m=C.count;ha=j[B];n=Math.min(n,ha);k=Math.max(k,ha);for(ga=0;ga<
m-1;ga++)p=C.get(ga),l=C.get(ga+1),c.add(p[0],p[1],p[2]),c.add(l[0],l[1],l[2]),u=p[0]-f,w=p[1]-A,ba=p[2]-y,R=Math.sqrt(u*u+w*w+ba*ba),ka=l[0]-f,Y=l[1]-A,sa=l[2]-y,P=Math.sqrt(ka*ka+Y*Y+sa*sa),d.add(u/R,w/R,ba/R),d.add(ka/P,Y/P,sa/P),l=[Math.abs(l[0]-p[0]),Math.abs(l[1]-p[1]),Math.abs(l[2]-p[2])],p=Math.sqrt(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]),l[0]/=p,l[1]/=p,l[2]/=p,e.add(l[0],l[1],l[2]),e.add(l[0],l[1],l[2]),D.push(ha),D.push(ha),D.push(ha),D.push(ha),D.push(ha),D.push(ha)}a.aa="LINES";P=new pd;P.Jb=
n;P.Ib=k;P.ec=n;P.ic=k;P.Nc=D;P.Ge=s;P.c=q;a.p=P;c=new sd;c.X=a;this.dispatchEvent(c)};F("X.parserTRK",Be);F("X.parserTRK.prototype.parse",Be.prototype.parse);function Ce(){ne.call(this);this.f="parserLUT"}G(Ce,ne);Ce.prototype.parse=function(a,b,c){var b=b.split("\n"),d=b.length,e;for(e=0;e<d;++e){var f=b[e],f=f.replace(/^\s+|\s+$/g,"");"#"!=f[0]&&(f=f.split(" "),f=f.filter(function(a){return""!=a}),6==f.length&&(f[2]=parseInt(f[2],10)/255,f[3]=parseInt(f[3],10)/255,f[4]=parseInt(f[4],10)/255,f[5]=parseInt(f[5],10)/255,c.add(parseInt(f[0],10),f[1],f[2],f[3],f[4],f[5],10)))}c=new sd;c.X=a;this.dispatchEvent(c)};F("X.parserLUT",Ce);
F("X.parserLUT.prototype.parse",Ce.prototype.parse);function De(){L.call(this);this.f="loader";this.dc=r;this.hc=0}G(De,L);function Ee(a){x(a.dc)||(a.dc=new Ob);return a.dc}v=De.prototype;v.Dg=function(a){Fe(this,1.7);setTimeout(function(){a.w.c=q;a.w.e.c=s;a.ra();Ee(this).set(a.w.I,q)}.bind(this),100)};
function Ge(a,b){x(b.r)||i(Error("Internal error during file loading."));var c=b.r.e.Sa,d=new XMLHttpRequest;J(d,"abort",a.Qb.bind(a,d,b));J(d,"error",a.Qb.bind(a,d,b));J(d,"load",a.Ag.bind(a,d,b));d.open("GET",c,q);d.overrideMimeType("text/plain; charset=x-user-defined");d.setRequestHeader("Content-Type","text/plain");d.send(r);Ee(a).set(b.r.I,s)}
function He(a,b){x(b.e)||i(Error("Internal error during file loading."));var c=Ee(a);if(!Qb(c.u,b.I)){b.h.clear();b.j.clear();var c=b.e.Sa,d=c.split(".").pop(),d=d.toUpperCase();d==Ie||d==Je||d==Ke||d==Le||d==Me||d==Ne||d==Oe||i(Error("The "+d+" file format is not supported."));d=new XMLHttpRequest;J(d,"abort",a.Qb.bind(a,d,b));J(d,"error",a.Qb.bind(a,d,b));J(d,"load",a.Bg.bind(a,d,b));d.open("GET",c,q);d.overrideMimeType("text/plain; charset=x-user-defined");d.setRequestHeader("Content-Type","text/plain");
d.send(r);Ee(a).set(b.I,s)}}function Fe(a,b){a.hc+=b/Ee(a).ba()/3;1<a.hc&&(a.hc=1);var c=new Nd;c.He=a.hc;a.dispatchEvent(c)}v.Qb=function(){i(Error("Could not get the file."))};v.Ag=function(a,b){setTimeout(function(){var c=new Ce;tc(c,zc,this.Zg.bind(this));c.parse(b,a.response,b.r)}.bind(this),100)};
v.Cg=function(a,b){setTimeout(function(){if("crv"==b.p.e.Sa.split(".").pop().toLowerCase()){var c=new Ae;tc(c,zc,this.ah.bind(this));c.parse(b,a.response)}else i(Error("Only .CRV files supported."))}.bind(this),100)};
v.Bg=function(a,b){Fe(this,1);setTimeout(function(){var c=b.e.Sa.split(".").pop().toLowerCase();if("stl"==c)c=new te,tc(c,zc,this.Tb.bind(this)),c.parse(b,a.response);else if("vtk"==c)c=new ue,tc(c,zc,this.Tb.bind(this)),c.parse(b,a.response);else if("trk"==c)c=new Be,tc(c,zc,this.Tb.bind(this)),c.parse(b,a.response);else if("fsm"==c)c=new ve,tc(c,zc,this.Tb.bind(this)),c.parse(b,a.response);else if("nrrd"==c)c=new xe,tc(c,zc,this.Tb.bind(this)),c.parse(b,a.response);else if("mgh"==c||"mgz"==c){var d=
new ze;tc(d,zc,this.Tb.bind(this));d.parse(b,a.response,"mgz"==c)}}.bind(this),100)};v.Tb=function(a){Fe(this,1);setTimeout(function(){var b=a.X;b.e.c=s;b.ra();Ee(this).set(b.I,q)}.bind(this),100)};v.ah=function(a){setTimeout(function(){var b=a.X;b.p.e.c=s;b.ra();Ee(this).set(b.p.I,q)}.bind(this),100)};v.Zg=function(a){setTimeout(function(){var b=a.X;b.r.e.c=s;b.ra();Ee(this).set(b.r.I,q)}.bind(this),100)};var Je="STL",Le="VTK",Ie="TRK",Ke="FSM",Me="NRRD",Ne="MGH",Oe="MGZ";var Pe=da.window;function Qe(a,b,c){ma(a)?c&&(a=wa(a,c)):a&&"function"==typeof a.handleEvent?a=wa(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Pe.setTimeout(a,b||0)};function me(a){Z.call(this);this.f="labelmap";this.Ia=a}G(me,Z);me.prototype.ra=function(){var a=new sd;a.X=this;this.dispatchEvent(a);this.Ia.ra()};F("X.labelmap",me);function Re(a,b){(!E(a)||!E(b))&&i(Error("A camera needs valid width and height values."));L.call(this);this.f="camera";this.position=new O(0,0,100);this.focus=new O(0,0,0);this.up=new O(0,1,0);this.view=this.md(this.position,this.focus);this.ub=new Float32Array(this.view.L())}G(Re,L);v=Re.prototype;v.he=function(a){(!x(a)||!(a instanceof he))&&i(Error("Could not observe the interactor."));J(a,ud,this.Ug.bind(this));J(a,wd,this.Yg.bind(this))};
v.Yg=function(a){a instanceof Fd||i(Error("Received no valid zoom event."));a.eb?this.Uf(a.Oa):this.Vf(a.Oa)};v.Ug=function(a){a instanceof Dd||i(Error("Received no valid pan event."));this.zf(a.H)};v.uh=function(a){(!x(a)||!(a instanceof S))&&i(Error("Invalid view matrix."));this.view=a;this.ub=new Float32Array(this.view.L())};v.wd=function(a,b,c){(!E(a)||!E(b)||!E(c))&&i(Error("The position was invalid."));this.position=new O(a,b,c);this.reset()};
v.ph=function(a,b,c){(!E(a)||!E(b)||!E(c))&&i(Error("The focus was invalid."));this.focus=new O(a,b,c);this.reset()};v.th=function(a,b,c){(!E(a)||!E(b)||!E(c))&&i(Error("The up-vector was invalid."));this.up=new O(a,b,c);this.reset()};v.reset=function(){this.view=this.md(this.position,this.focus);this.ub=new Float32Array(this.view.L())};
v.zf=function(a){a instanceof $c||i(Error("Invalid distance vector for pan operation."));a=new O(-a.x,a.y,0);a=jd(4).translate(a);this.view=new S(a.multiply(this.view));this.ub=new Float32Array(this.view.L());this.dispatchEvent(new Jd)};v.Uf=function(a){var b=20;x(a)&&!a&&(b=1);a=new O(0,0,b);a=jd(4).translate(a);this.view=new S(a.multiply(this.view));this.ub=new Float32Array(this.view.L());this.dispatchEvent(new Jd)};
v.Vf=function(a){var b=30;x(a)&&!a&&(b=1);a=new O(0,0,-b);a=jd(4).translate(a);this.view=new S(a.multiply(this.view));this.ub=new Float32Array(this.view.L());this.dispatchEvent(new Jd)};v.md=function(a,b){(!(a instanceof O)||!(b instanceof O))&&i(Error("3D vectors required for calculating the view."));return jd(4)};F("X.camera",Re);F("X.camera.prototype.setView",Re.prototype.uh);F("X.camera.prototype.setPosition",Re.prototype.wd);F("X.camera.prototype.setFocus",Re.prototype.ph);
F("X.camera.prototype.setUp",Re.prototype.th);F("X.camera.prototype.pan",Re.prototype.zf);F("X.camera.prototype.zoomIn",Re.prototype.Uf);F("X.camera.prototype.zoomOut",Re.prototype.Vf);function Se(a){he.call(this,a);this.f="interactor3D"}G(Se,he);Se.prototype.yc=function(a){Se.i.yc.call(this,a);var b=new Fd;x(a.Ob)||(a.Ob=0);b.eb=0>a.Ob;b.Oa=q;this.dispatchEvent(b)};function Te(a){L.call(this);this.f="array";this.s=[];this.Be=a}G(Te,L);Te.prototype.add=function(a){this.s.push(a);return q};Te.prototype.clear=function(){this.s.length=0};function Ue(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Ue(a,b,d);for(Ue(a,d,c);b<d;++b)if(0<a.Be(a.s[b],a.s[d])){var e=a.s[b];a.s[b]=a.s[d];for(var f=a,g=d,h=c;g+1<h&&0>f.Be(f.s[g+1],e);){var j=f,n=g+1,k=j.s[g];j.s[g]=j.s[n];j.s[n]=k;++g}f.s[g]=e}}}Te.prototype.sort=function(){Ue(this,0,this.s.length)};function Ve(a,b){Re.call(this,a,b);this.f="camera2D"}G(Ve,Re);function We(a,b){Re.call(this,a,b);this.f="camera3D";this.ng=45;var c=Float32Array,d;d=a/b;var e=1*Math.tan(this.ng*Math.PI/360),f=-e;d=new S([[2/(e*d-f*d),0,(e*d+f*d)/(e*d-f*d),0],[0,2/(e-f),(e+f)/(e-f),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]]);this.bh=new c(d.L())}G(We,Re);We.prototype.he=function(a){We.i.he.call(this,a);J(a,vd,this.Wg.bind(this))};We.prototype.Wg=function(a){a instanceof Ed||i(Error("Received no valid rotate event."));this.rotate(a.H)};
We.prototype.rotate=function(a){a instanceof Array&&2==a.length?a=new $c(a[0],a[1]):a instanceof $c||i(Error("Invalid distance vector for rotate operation."));var b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=jd(4),d=new O(parseFloat(this.view.D(0,0)),parseFloat(this.view.D(0,1)),parseFloat(this.view.D(0,2))),b=c.rotate(b,new O(parseFloat(this.view.D(1,0)),parseFloat(this.view.D(1,1)),parseFloat(this.view.D(1,2)))),a=c.rotate(a,d);this.view=new S(this.view.multiply(a.multiply(b)));this.ub=new Float32Array(this.view.L());
this.dispatchEvent(new Jd)};We.prototype.md=function(a,b){We.i.md.call(this,a,b);var c=jd(4),d=new O(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.up.d();e.kc(d)&&(e.b+=1.0E-6);var f=Xc(e,d),e=Xc(d,f),f=f.normalize(),e=e.normalize();Q(c,0,0,f.x);Q(c,0,1,f.y);Q(c,0,2,f.b);Q(c,0,3,0);Q(c,1,0,e.x);Q(c,1,1,e.y);Q(c,1,2,e.b);Q(c,1,3,0);Q(c,2,0,d.x);Q(c,2,1,d.y);Q(c,2,2,d.b);Q(c,2,3,0);Q(c,3,0,0);Q(c,3,1,0);Q(c,3,2,0);Q(c,3,3,1);d=a.d();return c.translate(d.M())};F("X.camera3D",We);
F("X.camera3D.prototype.rotate",We.prototype.rotate);function Xe(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Xe.prototype.d=function(){return new Xe(this.top,this.right,this.bottom,this.left)};Xe.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};Xe.prototype.contains=function(a){return!this||!a?s:a instanceof Xe?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function Ye(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}v=Ye.prototype;v.d=function(){return new Ye(this.left,this.top,this.width,this.height)};v.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};
v.df=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,q}return s};v.contains=function(a){return a instanceof Ye?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
v.ca=function(){return new ad(this.width,this.height)};function Ze(a,b){var c=Vd(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,r))?c[b]||c.getPropertyValue(b):""}function $e(a,b){return a.currentStyle?a.currentStyle[b]:r}function af(a,b){return Ze(a,b)||$e(a,b)||a.style&&a.style[b]}function bf(a){a=a?9==a.nodeType?a:Vd(a):document;return I&&!pb(9)&&!fe(Td(a))?a.body:a.documentElement}
function cf(a){var b=a.getBoundingClientRect();I&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function df(a){if(I&&!pb(8))return a.offsetParent;for(var b=Vd(a),c=af(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=af(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return r}
function ef(a){for(var b=new Xe(0,Infinity,Infinity,0),c=Td(a),d=c.B.body,e=c.B.documentElement,f=!Za&&"CSS1Compat"==c.B.compatMode?c.B.documentElement:c.B.body;a=df(a);)if((!I||0!=a.clientWidth)&&(!Za||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=af(a,"overflow")){var g=ff(a),h;h=a;if(Ya&&!nb("1.9")){var j=parseFloat(Ze(h,"borderLeftWidth"));if(gf(h))var n=h.offsetWidth-h.clientWidth-j-parseFloat(Ze(h,"borderRightWidth")),j=j+n;h=new Yc(j,parseFloat(Ze(h,"borderTopWidth")))}else h=new Yc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.B.parentWindow||c.B.defaultView||window;e=c.document;Za&&!nb("500")&&!$a?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new ad(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new ad(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:r}
function ff(a){var b,c=Vd(a),d=af(a,"position"),e=Ya&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Yc(0,0),g=bf(c);if(a==g)return f;if(a.getBoundingClientRect)b=cf(a),a=ge(Td(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Za&&"fixed"==af(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Xa||Za&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=df(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Xa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function hf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function jf(a){if("none"!=af(a,"display"))return kf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=kf(a);b.display=c;b.position=e;b.visibility=d;return a}function kf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Za&&!b&&!c;return(!ia(b)||d)&&a.getBoundingClientRect?(a=cf(a),new ad(a.right-a.left,a.bottom-a.top)):new ad(b,c)}function lf(a,b){a.style.display=b?"":"none"}function gf(a){return"rtl"==af(a,"direction")}
function mf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var nf={thin:2,medium:4,thick:6};function of(a,b){if("none"==$e(a,b+"Style"))return 0;var c=$e(a,b+"Width");return c in nf?nf[c]:mf(a,c)};function pf(a){this.qa=a;this.q=[]}G(pf,Vb);var qf=[];function rf(a,b,c,d,e){ja(c)||(qf[0]=c,c=qf);for(var f=0;f<c.length;f++)a.q.push(J(b,c[f],d||a,e||s,a.qa||a))}pf.prototype.sd=function(){xb(this.q,vc);this.q.length=0};pf.prototype.A=function(){pf.i.A.call(this);this.sd()};pf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function sf(){}(function(a){a.Ve=function(){return a.xg||(a.xg=new a)}})(sf);sf.prototype.ee=0;sf.Ve();function tf(a){this.xa=a||Td()}G(tf,Jc);v=tf.prototype;v.vg=sf.Ve();v.bf=r;v.vb=s;v.k=r;v.Sb=r;v.Mb=r;v.jc=r;v.Oh=s;v.g=t("k");v.qe=function(a){this.Sb&&this.Sb!=a&&i(Error("Method not supported"));tf.i.qe.call(this,a)};v.ad=t("xa");v.Nb=function(){this.k=this.xa.createElement("div")};v.Wb=function(a){this.ka(a)};v.ka=function(a,b){this.vb&&i(Error("Component already rendered"));this.k||this.Nb();a?a.insertBefore(this.k,b||r):this.xa.B.body.appendChild(this.k);(!this.Sb||this.Sb.vb)&&this.Zc()};
v.Zc=function(){this.vb=q;uf(this,function(a){!a.vb&&a.g()&&a.Zc()})};v.mc=function(){uf(this,function(a){a.vb&&a.mc()});this.ed&&this.ed.sd();this.vb=s};v.A=function(){tf.i.A.call(this);this.vb&&this.mc();this.ed&&(this.ed.pa(),delete this.ed);uf(this,function(a){a.pa()});!this.Oh&&this.k&&ce(this.k);this.Sb=this.k=this.jc=this.Mb=r};v.gd=function(){return!!this.Mb&&0!=this.Mb.length};function uf(a,b){a.Mb&&xb(a.Mb,b,o)}
v.removeChild=function(a,b){if(a){var c=z(a)?a:a.bf||(a.bf=":"+(a.vg.ee++).toString(36)),a=this.jc&&c?(c in this.jc?this.jc[c]:o)||r:r;if(c&&a){var d=this.jc;c in d&&delete d[c];Db(this.Mb,a);b&&(a.mc(),a.k&&ce(a.k));c=a;c==r&&i(Error("Unable to set parent component"));c.Sb=r;tf.i.qe.call(c,r)}}a||i(Error("Child is not in parent component"));return a};function vf(){}G(vf,Jc);v=vf.prototype;v.ze=0;v.xc=0;v.be=100;v.Te=0;v.we=1;v.yg=s;v.Ig=s;v.xd=function(a){a=wf(this,a);this.ze!=a&&(this.ze=a+this.Te>this.be?this.be-this.Te:a<this.xc?this.xc:a,!this.yg&&!this.Ig&&this.dispatchEvent("change"))};v.dd=function(){return wf(this,this.ze)};v.cd=function(){return wf(this,this.xc)};v.bd=function(){return wf(this,this.be)};function wf(a,b){return a.we==r?b:a.xc+Math.round((b-a.xc)/a.we)*a.we};function xf(a){this.xa=a||Td();this.Ub=new vf;J(this.Ub,"change",this.sg,s,this)}G(xf,tf);var yf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};v=xf.prototype;v.Nb=function(){this.ta=this.ad().Nb("div","progress-bar-thumb");var a=yf[this.yf];this.k=this.ad().Nb("div",a,this.ta);zf(this);this.g().setAttribute("aria-valuemin",this.cd());this.g().setAttribute("aria-valuemax",this.bd())};
v.Zc=function(){xf.i.Zc.call(this);I&&7>db&&J(this.g(),"resize",this.Bd,s,this);this.Bd();var a=this.g();a.setAttribute("role","progressbar");a.yi="progressbar";this.g().setAttribute("aria-live","polite")};v.mc=function(){xf.i.mc.call(this);Af(this)};function Af(a){I&&7>db&&uc(a.g(),"resize",a.Bd,s,a)}v.dd=function(){return this.Ub.dd()};v.xd=function(a){this.Ub.xd(a);this.g()&&zf(this)};function zf(a){var b=a.dd();a.g().setAttribute("aria-valuenow",b)}v.cd=function(){return this.Ub.cd()};v.bd=function(){return this.Ub.bd()};
v.yf="horizontal";v.sg=function(){this.Bd();this.dispatchEvent("change")};v.Bd=function(){if(this.ta){var a=this.cd(),b=this.bd(),a=(this.dd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.yf?I&&7>db?(this.ta.style.top=0,this.ta.style.height="100%",b=this.ta.offsetHeight,a=Math.round(a*b),this.ta.style.top=b-a+"px",this.ta.style.height=a+"px"):(this.ta.style.top=100-b+"%",this.ta.style.height=b+"%"):this.ta.style.width=b+"%"}};v.A=function(){Af(this);xf.i.A.call(this);this.ta=r;this.Ub.pa()};function Bf(a,b){x(a)||i(Error("No valid parent element."));x(b)||i(Error("Invalid initial value."));xf.call(this);this.f="progressbar";this.ia=a;this.Lc=this.Ha=r;this.bb=[];this.bb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.xd(b);this.Wd()}G(Bf,xf);
Bf.prototype.Wd=function(){if("static"==this.ia.style.position||""==this.ia.style.position)this.ia.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Zd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.bb[0]),d=document.createTextNode(this.bb[1]),e=document.createTextNode(this.bb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.Ha=b;this.Wb(this.ia);a=this.g();a.style.position="absolute";a.style.top=(this.ia.clientHeight-
5)/2;a.style.left=(this.ia.clientWidth-100)/2};function Cf(a){var b=a.g().style.top,c=a.g().style.left;ce(a.g());var d=new Bf(a.ia,100),e=d.g();e.style.position="absolute";e.style.top=b;e.style.left=c;(e.firstElementChild!=o?e.firstElementChild:de(e.firstChild)).classList.add("progress-bar-thumb-done");a.Lc=d}Bf.prototype.Xd=function(){this.Ha&&ce(this.Ha);this.g()&&ce(this.g());this.Lc&&ce(this.Lc.g());this.Lc=this.Ha=r};function Df(a){x(a)||i(Error("An ID to a valid container (<div>..) is required."));a=Wd(a);(!(na(a)&&1==a.nodeType)||0==a.clientWidth||0==a.clientHeight)&&i(Error("Could not find the given container or it has an undefined size."));L.call(this);this.f="renderer";this.container=a;this.width=this.container.clientWidth;this.height=this.container.clientHeight;this.interactor=this.camera=this.canvas=r;this.Ka=new Te(td);this.$a=[];this.N=r;this.initialLoadingCompleted=this.kd=s;this.a=this.za=r;this.config=
{PROGRESSBAR_ENABLED:q};window.console.log("XTK Release 4 -- 04/12/12 -- http://www.goXTK.com")}G(Df,L);v=Df.prototype;v.Vg=function(a){this.za&&this.za.xd(100*a.He)};v.Lg=function(a){x(a)&&a instanceof sd&&this.Da(a.X)};v.ke=function(a){(!x(a)||!(a instanceof Kd))&&i(Error("Invalid hover event."))};v.le=function(a){(!x(a)||!(a instanceof Gd))&&i(Error("Invalid scroll event."))};v.Ac=function(){this.camera.reset();this.ka(s,s)};
function Ef(a){a.config.PROGRESSBAR_ENABLED&&a.za&&!a.Fe&&(Cf(a.za),a.Fe=Qe(function(){this.Fe=r;this.za&&(this.za.Xd(),this.za=r);this.Wb()}.bind(a),700))}
v.V=function(a){var b=Zd("canvas");b.width=this.width;b.height=this.height;this.container.appendChild(b);try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.container.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";i(Error(e))}this.N=new De;J(this.N,
Ad,this.Vg.bind(this));this.canvas=b;this.a=c;b=new Se(this.canvas);"2d"==a&&(b=new je(this.canvas));b.V();J(b,zd,this.Ac.bind(this));J(b,Bd,this.ke.bind(this));J(b,xd,this.le.bind(this));this.interactor=b;b=new We(this.width,this.height);"2d"==a&&(b=new Ve(this.width,this.height));b.he(this.interactor);J(b,yd,this.ka.bind(this,s,s));this.camera=b};v.add=function(a){this.$a.push(a);this.Da(a)};
v.Da=function(a){(!this.canvas||!this.a)&&i(Error("The renderer was not initialized properly."));x(a)||(window.console.log(a),i(Error("Illegal object.")));yc(a)||J(a,zc,this.Lg.bind(this))};v.get=function(a){x(a)||i(Error("Invalid object id."));for(var b=this.Ka.s,c=b.length,d=0,d=0;d<c;d++)if(b[d].I==a)return b[d];return r};
v.Wb=function(){(!this.canvas||!this.a)&&i(Error("The renderer was not initialized properly."));x(this.If)||(!x(this.N.dc)||!this.N.dc.Md(s)?this.za?(Ef(this),eval("this.onShowtime()"),this._initialLoadingCompleted=q):this.ka(s,q):(this.config.PROGRESSBAR_ENABLED&&!this.za&&(this.za=new Bf(this.container,3)),this.If=Qe(function(){this.If=r;this.Wb()}.bind(this),100)))};v.xf=aa();v.ka=aa();
v.Yc=function(){this.Ka.clear();delete this.Ka;this.$a.length=0;delete this.$a;delete this.N;this.N=r;delete this.camera;this.camera=r;delete this.interactor;this.interactor=r;delete this.a;this.a=r;ce(this.canvas);delete this.canvas;this.canvas=r};function Ff(a){function b(a,b,d){b=2*b*Math.PI;b=j.Ma(Math.cos(b)).yb(n.Ma(Math.sin(b)));a=c.yb(e.Ma(a)).yb(b.Ma(f));d=b.Ma(1-Math.abs(d)).yb(g.Ma(d));return new Lc(a,d)}this.o=[];for(var a=a||{},c=new K(a.start||[0,-1,0]),d=new K(a.end||[0,1,0]),e=d.Rb(c),f=a.Aa||1,a=a.Bb||16,g=e.Yb(),h=0.5<Math.abs(g.y()),j=(new K(h,!h,0)).Xc(g).Yb(),n=j.Xc(g).Yb(),h=new Lc(c,g.nd()),d=new Lc(d,g.Yb()),k=[],m=0;m<a;m++){var l=m/a,p=(m+1)/a;k.push(new Pc([h,b(0,l,-1),b(0,p,-1)]));k.push(new Pc([b(0,p,0),b(0,l,0),
b(1,l,0),b(1,p,0)]));k.push(new Pc([d,b(1,p,1),b(1,l,1)]))}return Rc(k)}G(Ff,M);F("CSG.cylinder",Ff);function Gf(a,b,c){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid start position."));(!x(b)||!(b instanceof Array)||3!=b.length)&&i(Error("Invalid end position."));E(c)||i(Error("Invalid radius."));V.call(this);this.f="cylinder";this.eg=a;this.$f=b;this.Fd=c;this.Gd=32;this.wa()}G(Gf,V);Gf.prototype.wa=function(){rd(this,new Ff({start:this.eg,end:this.$f,Aa:this.Fd,Bb:this.Gd}))};F("X.cylinder",Gf);function Hf(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new K(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Lc(c.yb(e.Ma(d)),e))}this.o=[];for(var a=a||{},c=new K(a.pb||[0,0,0]),d=a.Aa||1,e=a.Bb||16,a=a.Bh||8,f=[],g,h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new Pc(g));return Rc(f)}G(Hf,M);F("CSG.sphere",Hf);function If(a,b){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center."));E(b)||i(Error("Invalid radius."));V.call(this);this.f="sphere";this.n=a;this.Fd=b;this.Gd=32;this.dg=16;this.wa()}G(If,V);If.prototype.wa=function(){rd(this,new Hf({pb:this.n,Aa:this.Fd,Bb:this.Gd,Bh:this.dg}))};F("X.sphere",If);function Jf(){L.call(this);this.f="shaders";this.Rc="";this.Rc="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.Mc="";this.Mc="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool useTextureThreshold;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (useTextureThreshold) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
G(Jf,L);
var Kf={ni:"vertexPosition",mi:"vertexNormal",li:"vertexColor",pi:"vertexTexturePos",oi:"vertexScalar"},Lf={qi:"view",Vh:"perspective",Ph:"center",Uh:"objectTransform",gi:"useObjectColor",Sh:"objectColor",ii:"useScalars",ci:"scalarsReplaceMode",$h:"scalarsMin",Xh:"scalarsMax",ai:"scalarsMinColor",Yh:"scalarsMaxColor",bi:"scalarsMinThreshold",Zh:"scalarsMaxThreshold",Wh:"pointSize",Th:"objectOpacity",Rh:"normal",hi:"usePicking",ji:"useTexture",ki:"useTextureThreshold",fi:"useLabelMapTexture",Qh:"labelmapOpacity",
di:"textureSampler",ei:"textureSampler2",ri:"volumeLowerThreshold",ui:"volumeUpperThreshold",ti:"volumeScalarMin",si:"volumeScalarMax"};
function Mf(a){var b=Object.keys(Lf);Object.keys(Kf).every(function(a){a=eval("X.shaders.attributes."+a);return-1!=this.Rc.search(a)||-1!=this.Mc.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=eval("X.shaders.uniforms."+a);return-1!=this.Rc.search(a)||-1!=this.Mc.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))}F("X.shaders.attributes",Kf);F("X.shaders.uniforms",Lf);function Nf(a,b,c){x(a)||i(Error("Invalid GL Buffer."));x(b)||i(Error("Invalid number of items."));x(c)||i(Error("Invalid item size."));L.call(this);this.f="buffer";this.T=a;this.Qa=b;this.Ra=c}G(Nf,L);function Of(a,b,c,d,e,f,g,h){var j,n=c.offsetParent;if(n){var k="HTML"==n.tagName||"BODY"==n.tagName;if(!k||"static"!=af(n,"position"))j=ff(n),k||(j=Zc(j,new Yc(n.scrollLeft,n.scrollTop)))}n=ff(a);k=jf(a);n=new Ye(n.x,n.y,k.width,k.height);(k=ef(a))&&n.df(new Ye(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=Td(a),m=Td(c);if(k.B!=m.B){var l=k.B.body,m=m.B.parentWindow||m.B.defaultView,p=new Yc(0,0),u=Vd(l)?Vd(l).parentWindow||Vd(l).defaultView:window,w=l;do{var A;if(u==m)A=ff(w);else{var C=w;
A=new Yc;if(1==C.nodeType)if(C.getBoundingClientRect)C=cf(C),A.x=C.left,A.y=C.top;else{var D=ge(Td(C)),C=ff(C);A.x=C.x-D.x;A.y=C.y-D.y}else{var D=ma(C.rg),y=C;C.targetTouches?y=C.targetTouches[0]:D&&C.ya.targetTouches&&(y=C.ya.targetTouches[0]);A.x=y.clientX;A.y=y.clientY}}p.x+=A.x;p.y+=A.y}while(u&&u!=m&&(w=u.frameElement)&&(u=u.parent));l=Zc(p,ff(l));I&&!fe(k)&&(l=Zc(l,ge(k)));n.left+=l.x;n.top+=l.y}a=(b&4&&gf(a)?b^2:b)&-5;b=new Yc(a&2?n.left+n.width:n.left,a&1?n.top+n.height:n.top);j&&(b=Zc(b,
j));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var B;if(g&&(B=ef(c))&&j)B.top-=j.y,B.right-=j.x,B.bottom-=j.y,B.left-=j.x;return Pf(b,c,d,f,B,g,h)}
function Pf(a,b,c,d,e,f,g){var a=a.d(),h=0,j=(c&4&&gf(b)?c^2:c)&-5,c=jf(b),g=g?g.d():c.d();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Ya&&(Na||cb)&&nb("1.9");f instanceof Yc?(a=f.x,f=f.y):(a=f,f=o);b.style.left=hf(a,e);b.style.top=hf(f,e);bd(c,g)||(a=fe(Td(Vd(b))),
I&&(!a||!nb("8"))?(c=b.style,a?(I?(a=mf(b,$e(b,"paddingLeft")),e=mf(b,$e(b,"paddingRight")),f=mf(b,$e(b,"paddingTop")),d=mf(b,$e(b,"paddingBottom")),a=new Xe(f,e,d,a)):(a=Ze(b,"paddingLeft"),e=Ze(b,"paddingRight"),f=Ze(b,"paddingTop"),d=Ze(b,"paddingBottom"),a=new Xe(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),I?(e=of(b,"borderLeft"),f=of(b,"borderRight"),d=of(b,"borderTop"),b=of(b,"borderBottom"),b=new Xe(d,f,b,e)):(e=Ze(b,"borderLeftWidth"),f=Ze(b,"borderRightWidth"),d=Ze(b,"borderTopWidth"),
b=Ze(b,"borderBottomWidth"),b=new Xe(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Ya?b.MozBoxSizing="border-box":Za?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Qf(){}Qf.prototype.Ba=aa();function Rf(a,b){this.element=a;this.Me=b}G(Rf,Qf);Rf.prototype.Ba=function(a,b,c){Of(this.element,this.Me,a,b,o,c)};function Sf(a,b){this.qa=new pf(this);this.pe(a||r);b&&(this.Xb=b)}G(Sf,Jc);v=Sf.prototype;v.k=r;v.fg=q;v.Ie=r;v.da=s;v.xh=s;v.$d=-1;v.ug=s;v.lg=q;v.Xb="toggle_display";v.g=t("k");v.pe=function(a){this.da&&i(Error("Can not change this state of the popup while showing."));this.k=a};
function Tf(a,b){a.Ec&&a.Ec.stop();a.pc&&a.pc.stop();if(b){if(!a.da&&a.ie()){a.k||i(Error("Caller must call setElement before trying to show the popup"));a.Ba();var c=Vd(a.k);a.ug&&rf(a.qa,c,"keydown",a.Jg,q);if(a.fg)if(rf(a.qa,c,"mousedown",a.uf,q),I){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}rf(a.qa,c,"mousedown",a.uf,q);rf(a.qa,c,"deactivate",a.tf)}else rf(a.qa,c,"blur",a.tf);"toggle_display"==
a.Xb?(a.k.style.visibility="visible",lf(a.k,q)):"move_offscreen"==a.Xb&&a.Ba();a.da=q;a.Ec?(tc(a.Ec,"end",a.wf,s,a),a.Ec.play()):a.wf()}}else Uf(a)}v.Ba=ea;function Uf(a,b){if(!a.da||!a.dispatchEvent({type:"beforehide",target:b}))return s;a.qa&&a.qa.sd();a.pc?(tc(a.pc,"end",xa(a.Le,b),s,a),a.pc.play()):a.Le(b);return q}v.Le=function(a){"toggle_display"==this.Xb?this.xh?Qe(this.af,0,this):this.af():"move_offscreen"==this.Xb&&(this.k.style.left="-200px",this.k.style.top="-200px");this.da=s;this.je(a)};
v.af=function(){this.k.style.visibility="hidden";lf(this.k,s)};v.ie=function(){return this.dispatchEvent("beforeshow")};v.wf=function(){this.$d=ya();this.dispatchEvent("show")};v.je=function(a){ya();this.dispatchEvent({type:"hide",target:a})};v.uf=function(a){a=a.target;!ee(this.k,a)&&(!this.Ie||ee(this.Ie,a))&&!(150>ya()-this.$d)&&Uf(this,a)};v.Jg=function(a){27==a.keyCode&&Uf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
v.tf=function(a){if(this.lg){var b=Vd(this.k);if(I||Xa){if(a=b.activeElement,!a||ee(this.k,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>ya()-this.$d||Uf(this)}};v.A=function(){Sf.i.A.call(this);this.qa.pa();Xb(this.Ec);Xb(this.pc);delete this.k;delete this.qa};function Vf(a,b){this.Nd=a instanceof Yc?a:new Yc(a,b)}G(Vf,Qf);Vf.prototype.Ba=function(a,b,c,d){Of(bf(a),0,a,b,this.Nd,c,r,d)};function Wf(a,b){this.dh=4;this.oe=b||o;Sf.call(this,a)}G(Wf,Sf);Wf.prototype.wd=function(a){this.oe=a||o;this.da&&this.Ba()};Wf.prototype.Ba=function(){if(this.oe){var a=!this.da&&"move_offscreen"!=this.Xb,b=this.g();a&&(b.style.visibility="hidden",lf(b,q));this.oe.Ba(b,this.dh,this.wi);a&&lf(b,s)}};function Xf(a,b,c){this.xa=c||(a?Td(Wd(a)):Td());Wf.call(this,this.xa.Nb("div",{style:"position:absolute;display:none;"}));this.Od=new Yc(1,1);this.sb=new Sb;a&&Yf(this,a);if(b!=r)if(a=this.g(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Vd(a).createTextNode(b))}}G(Xf,Wf);var Zf=[];v=Xf.prototype;v.Z=r;v.className="goog-tooltip";
v.Kf=500;v.tg=0;v.ad=t("xa");function Yf(a,b){b=Wd(b);a.sb.add(b);J(b,"mouseover",a.Ye,s,a);J(b,"mouseout",a.fd,s,a);J(b,"mousemove",a.Xe,s,a);J(b,"focus",a.We,s,a);J(b,"blur",a.fd,s,a)}v.detach=function(a){if(a)a=Wd(a),$f(this,a),this.sb.remove(a);else{for(var b=this.sb.tb(),c=0;a=b[c];c++)$f(this,a);this.sb.clear()}};function $f(a,b){uc(b,"mouseover",a.Ye,s,a);uc(b,"mouseout",a.fd,s,a);uc(b,"mousemove",a.Xe,s,a);uc(b,"focus",a.We,s,a);uc(b,"blur",a.fd,s,a)}
v.pe=function(a){var b=this.g();b&&ce(b);Xf.i.pe.call(this,a);a&&(b=this.xa.B.body,b.insertBefore(a,b.lastChild))};v.ie=function(){if(!Sf.prototype.ie.call(this))return s;if(this.anchor)for(var a,b=0;a=Zf[b];b++)ee(a.g(),this.anchor)||Tf(a,s);0<=wb(Zf,this)||Zf.push(this);a=this.g();a.className=this.className;ag(this);J(a,"mouseover",this.$e,s,this);J(a,"mouseout",this.Ze,s,this);bg(this);return q};
v.je=function(){Db(Zf,this);for(var a=this.g(),b,c=0;b=Zf[c];c++)b.anchor&&ee(a,b.anchor)&&Tf(b,s);this.Af&&cg(this.Af);uc(a,"mouseover",this.$e,s,this);uc(a,"mouseout",this.Ze,s,this);this.anchor=o;if(0==(this.La?this.da?4:1:this.Pb?3:this.da?2:0))this.vd=s;Sf.prototype.je.call(this)};v.mf=function(a,b){this.anchor==a&&this.sb.contains(this.anchor)&&(this.vd||!this.xi?(Tf(this,s),this.da||(this.anchor=a,this.wd(b||dg(this,0)),Tf(this,q))):this.anchor=o);this.La=o};
v.Fg=function(a){this.Pb=o;a==this.anchor&&(this.Z==r||this.Z!=this.g()&&!this.sb.contains(this.Z))&&(!this.Je||!this.Je.Z)&&Tf(this,s)};function eg(a,b){var c=ge(a.xa);a.Od.x=b.clientX+c.x;a.Od.y=b.clientY+c.y}v.Ye=function(a){var b=fg(this,a.target);this.Z=b;ag(this);b!=this.anchor&&(this.anchor=b,this.La||(this.La=Qe(wa(this.mf,this,b,o),this.Kf)),gg(this),eg(this,a))};function fg(a,b){try{for(;b&&!a.sb.contains(b);)b=b.parentNode;return b}catch(c){return r}}
v.Xe=function(a){eg(this,a);this.vd=q};v.We=function(a){this.Z=a=fg(this,a.target);this.vd=q;if(this.anchor!=a){this.anchor=a;var b=dg(this,1);ag(this);this.La||(this.La=Qe(wa(this.mf,this,a,b),this.Kf));gg(this)}};function dg(a,b){if(0==b){var c=a.Od.d();return new hg(c)}return new ig(a.Z)}function gg(a){if(a.anchor)for(var b,c=0;b=Zf[c];c++)ee(b.g(),a.anchor)&&(b.Je=a,a.Af=b)}
v.fd=function(a){var b=fg(this,a.target),c=fg(this,a.relatedTarget);b!=c&&(b==this.Z&&(this.Z=r),bg(this),this.vd=s,this.da&&(!a.relatedTarget||!ee(this.g(),a.relatedTarget))?cg(this):this.anchor=o)};v.$e=function(){var a=this.g();this.Z!=a&&(ag(this),this.Z=a)};v.Ze=function(a){var b=this.g();if(this.Z==b&&(!a.relatedTarget||!ee(b,a.relatedTarget)))this.Z=r,cg(this)};function bg(a){a.La&&(Pe.clearTimeout(a.La),a.La=o)}
function cg(a){if(2==(a.La?a.da?4:1:a.Pb?3:a.da?2:0))a.Pb=Qe(wa(a.Fg,a,a.anchor),a.tg)}function ag(a){a.Pb&&(Pe.clearTimeout(a.Pb),a.Pb=o)}v.A=function(){Tf(this,s);bg(this);this.detach();this.g()&&ce(this.g());this.Z=r;delete this.xa;Xf.i.A.call(this)};function hg(a,b){Vf.call(this,a,b)}G(hg,Vf);hg.prototype.Ba=function(a,b,c){b=bf(a);b=ef(b);c=c?new Xe(c.top+10,c.right,c.bottom,c.left+10):new Xe(10,0,0,10);Pf(this.Nd,a,4,c,b,9)&496&&Pf(this.Nd,a,4,c,b,5)};function ig(a){Rf.call(this,a,3)}G(ig,Rf);
ig.prototype.Ba=function(a,b,c){var d=new Yc(10,0);Of(this.element,this.Me,a,b,d,c,9)&496&&Of(this.element,2,a,1,d,c,5)};function jg(a,b,c,d){x(a)||i(Error("No valid parent element."));(!E(b)||!E(c))&&i(Error("Invalid coordinates."));(!x(d)||!(d instanceof he))&&i(Error("Invalid interactor."));Xf.call(this);this.f="caption";this.ia=a;this.Tc=b;this.Uc=c;this.Ha=r;this.bb=[];this.bb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];tc(d,Cd,this.Xd.bind(this));this.Wd()}G(jg,Xf);
jg.prototype.Wd=function(){if("static"==this.ia.style.position||""==this.ia.style.position)this.ia.style.position="relative";var a=document.getElementsByTagName("head")[0],b=Zd("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.bb[0]);a.appendChild(b);b.appendChild(c);this.Ha=b;this.wd(new Vf(this.Tc,this.Uc));Tf(this,q);Yf(this,this.ia);this.g().classList.add("x-tooltip")};jg.prototype.Xd=function(){Tf(this,s);this.Ha&&ce(this.Ha);this.g()&&ce(this.g());this.Ha=r};function kg(a){Df.call(this,a);this.f="renderer3D";this.tc=this.wc=this.sc=this.vc=this.rc=this.uc=this.re=this.se=r;this.pb=[0,0,0];this.Ff=r;this.Jd=new Ob;this.Gc=new Ob;this.Ic=new Ob;this.ge=new Ob;this.Vc=new Ob;this.ud=new Ob;this.yd=new Ob;this.zd=new Ob;this.config={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:s}}G(kg,Df);v=kg.prototype;v.gh=function(){this.tc=this.wc=this.sc=this.vc=this.rc=this.uc=r;this.pb=[0,0,0]};
v.ke=function(a){kg.i.ke.call(this,a);var b=a.Tc,a=a.Uc,c=this.get(this.Ef(b,a));if(c&&(c=c.Db))(new jg(this.container,this.container.offsetLeft+b+10,this.container.offsetTop+a+10,this.interactor)).g().innerHTML=c};
v.V=function(){kg.i.V.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.width,this.height),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.config.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();
this.a.bindTexture(this.a.TEXTURE_2D,c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.width,this.height,0,this.a.RGB,this.a.UNSIGNED_BYTE,r);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.width,this.height);this.a.bindRenderbuffer(this.a.RENDERBUFFER,r);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,
this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.Ff=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}lg(this)};
function lg(a){var b=new Jf;(!x(a.canvas)||!x(a.a)||!x(a.camera))&&i(Error("Renderer was not initialized properly."));(!x(b)||!(b instanceof Jf))&&i(Error("Could not add shaders."));Mf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.Mc);a.a.shaderSource(d,b.Rc);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,
a.a.COMPILE_STATUS)||i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.re=e;Object.keys(Kf).forEach(function(a){a=eval("X.shaders.attributes."+a);this.Jd.set(a,this.a.getAttribLocation(this.re,a));
this.a.enableVertexAttribArray(this.Jd.get(a))}.bind(a));Object.keys(Lf).forEach(function(a){a=eval("X.shaders.uniforms."+a);this.Gc.set(a,this.a.getUniformLocation(this.re,a))}.bind(a));a.se=b}
v.Da=function(a){kg.i.Da.call(this,a);var b=s;this.get(a.I)&&(b=q);var c=a.I,d=a.h,e=a.j,f=a.ma,g=a.w,h=a.e,j=a.Qc,n=a.r,k=a.t,m=a.p;if(x(k)&&x(k.e)&&k.e.c)this.Da(k);else if(x(k)&&k.c&&this.Da(k),x(n)&&x(n.e)&&n.e.c)Ge(this.N,a);else if(x(g)&&x(g.e)&&g.e.c)b=this.N,x(a.Ai())||i(Error("Internal error during texture loading.")),c=new Image,c.src=a.w.e.Sa,a.w.De=c,tc(c,"load",b.Dg.bind(b,a)),Ee(b).set(a.w.I,s),Fe(b,0.3);else if(x(h)&&h.c)He(this.N,a);else if(x(m)&&x(m.e)&&m.e.c)b=this.N,x(a.p)||i(Error("Internal error during file loading.")),
c=a.p.e.Sa,m=new XMLHttpRequest,J(m,"abort",b.Qb.bind(b,m,a)),J(m,"error",b.Qb.bind(b,m,a)),J(m,"load",b.Cg.bind(b,m,a)),m.open("GET",c,q),m.overrideMimeType("text/plain; charset=x-user-defined"),m.setRequestHeader("Content-Type","text/plain"),m.send(r),Ee(b).set(a.p.I,s);else{if(a.c&&0<a.children().length){h=a.children();n=h.length;for(k=k=0;k<n;k++)this.Da(h[k])}if(0==d.count)a.c=s;else{for(h=0;this.kd;)h++,window.console.log("Possible thread lock avoided: "+h);this.kd=q;n=a instanceof ke&&a.Ia instanceof
me;b&&x(g)&&g.c&&(h=this.yd.get(c),x(h)&&this.a.isBuffer(h.T)&&this.a.deleteBuffer(h.T));h=r;x(g)&&(!b||g.c?(h=a.ob,x(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=s,g.Va&&(k=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),k=this.a.createTexture(),k.wg=g.De,this.zd.set(g.I,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.Va?(this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,g.Pc,g.Oc,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.Va),this.a.texParameteri(this.a.TEXTURE_2D,
this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.wg),n?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,
this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,r),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Nf(k,h.length,2),g.c=s):h=this.yd.get(c));Fe(this.N,0.1);if(n)this.kd=s,Fe(this.N,0.9);else{if(d.c||j.c){n=j.l;g=n.sa(new O(d.ib,d.jb,d.kb));n=n.sa(new O(d.fb,d.gb,d.hb));if(this.uc===r||g.x<this.uc)this.uc=g.x;if(this.rc===r||n.x>this.rc)this.rc=n.x;if(this.vc===r||g.y<
this.vc)this.vc=g.y;if(this.sc===r||n.y>this.sc)this.sc=n.y;if(this.wc===r||g.b<this.wc)this.wc=g.b;if(this.tc===r||n.b>this.tc)this.tc=n.b;this.pb=[(this.uc+this.rc)/2,(this.vc+this.sc)/2,(this.wc+this.tc)/2];j.c=s}b&&d.c&&(j=this.Ic.get(c),x(j)&&this.a.isBuffer(j.T)&&this.a.deleteBuffer(j.T));j=r;!b||d.c?(j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(d.U),this.a.STATIC_DRAW),j=new Nf(j,d.count,3),d.c=s):j=this.Ic.get(c);Fe(this.N,
0.3);b&&e.c&&(g=this.Ic.get(c),x(g)&&this.a.isBuffer(g.T)&&this.a.deleteBuffer(g.T));g=r;!b||e.c?(g=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(e.U),this.a.STATIC_DRAW),g=new Nf(g,e.count,3),e.c=s):g=this.ge.get(c);Fe(this.N,0.3);b&&f.c&&(e=this.Vc.get(c),x(e)&&this.a.isBuffer(e.T)&&this.a.deleteBuffer(e.T));e=r;0<f.length&&(!b||f.c?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),
this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(f.U),this.a.STATIC_DRAW),e=new Nf(e,f.count,3),f.c=s):e=this.Vc.get(c));Fe(this.N,0.2);b&&m&&m.c&&(f=this.ud.get(c),x(f)&&this.a.isBuffer(f.T)&&this.a.deleteBuffer(f.T));f=r;m&&(f=m.Nc,!b||m.c?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(f),this.a.STATIC_DRAW),
f=new Nf(d,f.length,3),m.c=s):f=this.ud.get(c));Fe(this.N,0.1);b||this.Ka.add(a);this.Ic.set(c,j);this.ge.set(c,g);this.Vc.set(c,e);this.yd.set(c,h);this.ud.set(c,f);this.kd=a.c=s}}}};function mg(a,b){var c=b.h.Jc,c=a.camera.view.sa(b.Qc.l.sa(new O(c[0],c[1],c[2]))),c=Tc(a.camera.position,c);return Math.round(1E3*c)/1E3}
v.Ef=function(a,b){if(this.config.PICKING_ENABLED){this.ka(q,s);var c=new Uint8Array(4);this.a.readPixels(a,this.height-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
v.ka=function(a,b){kg.i.ka.call(this,a,b);var c=this.Ka.s,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.Ff):this.a.bindFramebuffer(this.a.FRAMEBUFFER,r);this.a.viewport(0,0,this.width,this.height);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.camera.bh,f=this.camera.ub;this.a.uniformMatrix4fv(this.Gc.get("perspective"),s,e);this.a.uniformMatrix4fv(this.Gc.get("view"),s,f);e=this.pb;this.a.uniform3f(this.Gc.get("center"),parseFloat(e[0]),parseFloat(e[1]),
parseFloat(e[2]));f=this.$a.length;for(e=0;e<f;++e){var g=this.$a[e];if(g instanceof Z){var h=new O(1,0,0),h=this.camera.view.sa(h),j=Tc(this.camera.position,h),h=new O(-1,0,0),h=this.camera.view.sa(h),n=Tc(this.camera.position,h),h=new O(0,1,0),h=this.camera.view.sa(h),k=Tc(this.camera.position,h),h=new O(0,-1,0),h=this.camera.view.sa(h),m=Tc(this.camera.position,h),h=new O(0,0,1),h=this.camera.view.sa(h),l=Tc(this.camera.position,h),h=new O(0,0,-1),h=this.camera.view.sa(h),h=Tc(this.camera.position,
h),p=Math.max(j,k,l,n,m,h);p==j||p==n?le(g,0):p==k||p==m?le(g,1):(p==l||p==h)&&le(g,2)}}if(this.config.ORDERING_ENABLED){j=s;f=this.$a;g=f.length-1;do if(e=f[g],e instanceof Z&&e._volumeRendering){n=e.Wa;j=e.lb.children();1==n?j=e.mb.children():2==n&&(j=e.nb.children());n=j.length;k=j[0];k.H=mg(this,k);k.J=e.J;m=j[n-1];m.H=mg(this,m);m.J=e.J;m=Math.round(1E3*((m.H-k.H)/n))/1E3;for(l=l=1;l<n-1;l++)h=Math.round(1E3*(k.H+l*m))/1E3,j[l].H=h,j[l].J=e.J;j=q}while(g--);f=this.Ka.s;g=f.length-1;do if(e=f[g],
e.va&&!(1==e.J||e instanceof ke))e.H=mg(this,e),j=q;while(g--);j&&this.Ka.sort()}if(f=!a&&x(b)&&b&&this.config.STATISTICS_ENABLED)var u=0,w=0,A=0,C=0;var e=this.Jd,g=e.get("vertexPosition"),j=e.get("vertexNormal"),n=e.get("vertexColor"),k=e.get("vertexTexturePos"),m=e.get("vertexScalar"),e=this.Gc,l=e.get("usePicking"),h=e.get("useObjectColor"),p=e.get("objectColor"),D=e.get("useScalars"),y=e.get("scalarsReplaceMode"),B=e.get("scalarsMin"),R=e.get("scalarsMax"),ba=e.get("scalarsMinColor"),ha=e.get("scalarsMaxColor"),
ga=e.get("scalarsMinThreshold"),ka=e.get("scalarsMaxThreshold"),Y=e.get("objectOpacity"),sa=e.get("labelmapOpacity"),P=e.get("useTexture"),sc=e.get("useTextureThreshold"),Aa=e.get("useLabelMapTexture"),zb=e.get("textureSampler"),Vc=e.get("textureSampler2"),Va=e.get("volumeLowerThreshold"),Wc=e.get("volumeUpperThreshold"),Ab=e.get("volumeScalarMin"),ua=e.get("volumeScalarMax"),lb=e.get("objectTransform"),kb=e.get("pointSize"),e=d;do{var H=c[d-e];if(H){var N=r;H instanceof ke&&H.Ia&&(N=H.Ia);if(H.va&&
(!N||N.va)){var ra=H.I,Ta=H.fc,za=this.Ic.get(ra),Sa=this.ge.get(ra),Hd=this.Vc.get(ra),Ua=this.ud.get(ra),Id=this.yd.get(ra);this.a.bindBuffer(this.a.ARRAY_BUFFER,za.T);this.a.vertexAttribPointer(g,za.Ra,this.a.FLOAT,s,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,Sa.T);this.a.vertexAttribPointer(j,Sa.Ra,this.a.FLOAT,s,0,0);a?this.a.uniform1i(l,q):this.a.uniform1i(l,s);Hd&&!a&&!Ta?(this.a.uniform1i(h,s),this.a.bindBuffer(this.a.ARRAY_BUFFER,Hd.T),this.a.vertexAttribPointer(n,Hd.Ra,this.a.FLOAT,s,0,
0)):(Sa=1,Ta&&!a&&(Sa=0),this.a.uniform1i(h,Sa),Sa=H.ab,a&&(Sa=[Math.floor(ra%65025%255)/255,Math.floor(ra%65025/255)/255,Math.floor(ra/65025)/255]),this.a.uniform3f(p,parseFloat(Sa[0]),parseFloat(Sa[1]),parseFloat(Sa[2])),this.a.vertexAttribPointer(n,za.Ra,this.a.FLOAT,s,0,0));Ua&&!a&&!Ta?(this.a.uniform1i(D,q),this.a.uniform1i(y,H.p.Ge),ra=H.p.Dd,Ta=H.p.Cd,this.a.uniform3f(ba,parseFloat(ra[0]),parseFloat(ra[1]),parseFloat(ra[2])),this.a.uniform3f(ha,parseFloat(Ta[0]),parseFloat(Ta[1]),parseFloat(Ta[2])),
this.a.uniform1f(ga,parseFloat(H.p.ec)),this.a.uniform1f(ka,parseFloat(H.p.ic)),this.a.uniform1f(B,parseFloat(H.p.Jb)),this.a.uniform1f(R,parseFloat(H.p.Ib)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ua.T),this.a.vertexAttribPointer(m,Ua.Ra,this.a.FLOAT,s,0,0)):(this.a.uniform1i(D,s),this.a.vertexAttribPointer(m,za.Ra,this.a.FLOAT,s,0,0));this.a.uniform1f(Y,parseFloat(H.J));H.w&&Id&&!a?(this.a.uniform1i(P,q),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.zd.get(H.w.I)),
this.a.uniform1i(zb,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,Id.T),this.a.vertexAttribPointer(k,Id.Ra,this.a.FLOAT,s,0,0),this.a.uniform1i(sc,s)):(this.a.uniform1i(P,s),this.a.vertexAttribPointer(k,za.Ra,this.a.FLOAT,s,0,0));N&&(this.a.uniform1i(sc,q),this.a.uniform1f(Va,N._lowerThreshold),this.a.uniform1f(Wc,N._upperThreshold),Ua=N.Ga,this.a.uniform1f(Ab,Ua[0]),this.a.uniform1f(ua,Ua[1]),Ua=N.t,this.a.uniform1i(Aa,s),N._volumeRendering?this.a.uniform1f(Y,parseFloat(N.J)):Ua&&Ua.va&&(N=H.t.I,this.a.uniform1i(Aa,
q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.zd.get(N)),this.a.uniform1i(Vc,1),this.a.uniform1f(sa,Ua.J)));this.a.uniformMatrix4fv(lb,s,H.Qc.Fa);N=1;"POINTS"==H.aa&&(N=H.gc);this.a.uniform1f(kb,N);N=-1;H.aa==nd?(N=this.a.TRIANGLES,f&&(w+=za.Qa/3)):"LINES"==H.aa?(this.a.lineWidth(H.Hb),N=this.a.LINES,f&&(A+=za.Qa/2)):"POINTS"==H.aa?(N=this.a.POINTS,f&&(C+=za.Qa)):"TRIANGLE_STRIPS"==H.aa?(N=this.a.TRIANGLE_STRIP,f&&(w+=za.Qa/3)):"POLYGONS"==H.aa&&(N=0==za.Qa%3?
this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(w+=za.Qa/3));f&&(u+=za.Qa);this.a.drawArrays(N,0,za.Qa)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+u+" | ")+("Triangles: "+Math.round(w)+" | "),c=c+("Lines: "+A+" | ")+("Points: "+C+" | ")+("Textures: "+this.zd.ba()),window.console.log(c))}};v.Yc=function(){this.se=r;delete this.se;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);kg.i.Yc.call(this)};F("X.renderer3D",kg);F("X.renderer3D.prototype.init",kg.prototype.V);
F("X.renderer3D.prototype.add",kg.prototype.add);F("X.renderer3D.prototype.onShowtime",kg.prototype.xf);F("X.renderer3D.prototype.get",kg.prototype.get);F("X.renderer3D.prototype.render",kg.prototype.Wb);F("X.renderer3D.prototype.destroy",kg.prototype.Yc);F("X.renderer3D.prototype.resetBoundingBox",kg.prototype.gh);F("X.renderer3D.prototype.resetViewAndRender",kg.prototype.Ac);F("X.renderer3D.prototype.pick",kg.prototype.Ef);function ng(a){this.o=[];var a=a||{},b=new K(a.pb||[0,0,0]),c=!a.Aa?[1,1,1]:a.Aa.length?a.Aa:[a.Aa,a.Aa,a.Aa];return Rc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Pc(a[0].map(function(e){e=new K(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Lc(e,new K(a[1]))}))}))}G(ng,M);F("CSG.cube",ng);function og(a,b,c,d){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center."));(!E(b)||!E(c)||!E(d))&&i(Error("Invalid radii."));V.call(this);this.f="cube";this.n=a;this.ag=b;this.bg=c;this.cg=d;this.ob=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];this.wa()}G(og,V);og.prototype.wa=function(){rd(this,new ng({pb:this.n,Aa:[this.ag,this.bg,this.cg]}))};F("X.cube",og);function pg(a,b){Df.call(this,a);this.f="renderer2D";this.orientation=b;this.gf=this.Yd=this.Ue=this.Sd=r;this.te=this.ue=0}G(pg,Df);v=pg.prototype;v.Xg=aa();v.le=function(a){pg.i.le.call(this,a);var b=this.$a[0];if(b){var c=this.orientation,d=0;"Y"==c?d=1:"Z"==c&&(d=2);a.Y?b["_index"+c]<b.R[d]-1&&(b["_index"+c]+=1):0<b["_index"+c]&&(b["_index"+c]-=1);b.ra();eval("this.onScroll(event);");this.ka(s,s)}};
v.V=function(){pg.i.V.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.width,this.height);this.Sd=Zd("canvas");this.Yd=Zd("canvas")};v.Ac=function(){pg.i.Ac.call(this);qg(this);this.ka(s,s)};
v.Da=function(a){pg.i.Da.call(this,a);var b=s;this.get(a.I)&&(b=q);var c=a.e,d=a.t,e=a.r;if(x(d)&&x(d.e)&&d.e.c)this.Da(d);else if(x(e)&&x(e.e)&&e.e.c)Ge(this.N,a);else if(x(c)&&c.c)He(this.N,a);else{d=c=0;e=a.R;"X"==this.orientation?(this.Bb=a.lb.children(),c=e[2],d=e[1]):"Y"==this.orientation?(this.Bb=a.mb.children(),c=e[0],d=e[2]):"Z"==this.orientation&&(this.Bb=a.nb.children(),c=e[0],d=e[1]);"X"==this.orientation&&(e=d,d=c,c=e);this.ue=c;this.te=d;e=this.Sd;e.width=c;e.height=d;var f=this.Yd;
f.width=c;f.height=d;this.Ue=e.getContext("2d");this.gf=f.getContext("2d");b||(this.Ka.add(a),qg(this))}};function qg(a){var b=Math.min(a.width/a.ue,a.height/a.te);Q(a.camera.view,2,3,10*b-10)}
v.ka=function(a,b){pg.i.ka.call(this,a,b);if(0!=this.Ka.s.length){var c=this.width,d=this.height,e=this.camera.view;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.D(0,3),g=-1*e.D(1,3),h=Math.max(1+e.D(2,3)/10,0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.$a[0],j=this.Bb[parseInt(e["_index"+this.orientation],10)],n=j.w.Va,j=j.t,k=r;j&&(k=j.Va);var m=this.ue,l=this.te,c=1/(2*h)*(c-m*h)+f,d=1/(2*h)*(d-l*h)+g,g=this.Ue,f=this.gf,h=g.getImageData(0,0,m,l),m=f.getImageData(0,
0,m,l),l=h.data,p=m.data,u=l.length,w=e.Ga[1],A=e._lowerThreshold,C=e._upperThreshold,D=0;do{var y=[0,0,0,0],B=[0,0,0,0],R=n[D]/255*w;R>=A&&R<=C&&(y=[n[D],n[D+1],n[D+2],n[D+3]],j&&(B=[k[D],k[D+1],k[D+2],k[D+3]]));R=u-1-D;l[R-3]=y[0];l[R-2]=y[1];l[R-1]=y[2];l[R]=y[3];p[R-3]=B[0];p[R-2]=B[1];p[R-1]=B[2];p[R]=B[3];D+=4}while(D<u);g.putImageData(h,0,0);f.putImageData(m,0,0);this.a.globalAlpha=1;this.a.drawImage(this.Sd,c,d);j&&e.t.va&&(this.a.globalAlpha=e.t.J,this.a.drawImage(this.Yd,c,d))}};
F("X.renderer2D",pg);F("X.renderer2D.prototype.init",pg.prototype.V);F("X.renderer2D.prototype.add",pg.prototype.add);F("X.renderer2D.prototype.onShowtime",pg.prototype.xf);F("X.renderer2D.prototype.onScroll",pg.prototype.Xg);F("X.renderer2D.prototype.get",pg.prototype.get);F("X.renderer2D.prototype.resetViewAndRender",pg.prototype.Ac);F("X.renderer2D.prototype.render",pg.prototype.Wb);F("X.renderer2D.prototype.destroy",pg.prototype.Yc);
